/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var X=Object.defineProperty;var Ue=Object.getOwnPropertyDescriptor;var qe=Object.getOwnPropertyNames;var Ke=Object.prototype.hasOwnProperty;var b=(a,n)=>()=>(a&&(n=a(a=0)),n);var ve=(a,n)=>{for(var t in n)X(a,t,{get:n[t],enumerable:!0})},_e=(a,n,t,e)=>{if(n&&typeof n=="object"||typeof n=="function")for(let s of qe(n))!Ke.call(a,s)&&s!==t&&X(a,s,{get:()=>n[s],enumerable:!(e=Ue(n,s))||e.enumerable});return a};var Ze=a=>_e(X({},"__esModule",{value:!0}),a);function P(a){return a.replace(/```[\s\S]*?```/g,"").replace(/~~~[\s\S]*?~~~/g,"").replace(/`[^`\n]+`/g,"").replace(/<[^>]*>/g,"").replace(/^---\n[\s\S]*?\n---\n/,"").replace(/::\w+\{[^}]*\}/g,"")}function ee(a){return a.replace(/```[\s\S]*?```/g,"").replace(/~~~[\s\S]*?~~~/g,"").replace(/`[^`\n]+`/g,"").replace(/<[^>]*>/g,"").replace(/^---\n[\s\S]*?\n---\n/,"").replace(/::\w+\{[^}]*\}/g,"")}var D=b(()=>{"use strict"});function x(a,n){let t=a.split(`
`);for(let e=0;e<t.length;e++){let s=t[e];if(s&&s.includes(n))return e+1}return 1}function E(a,n,t=2){let e=a.split(`
`),s=Math.max(0,n-1-t),i=Math.min(e.length,n-1+t+1);return e.slice(s,i).join(`
`)}var M=b(()=>{"use strict"});async function te(a,n,t){let e=[];if(!t.checkAltText)return[];let s=P(a),i=s.match(/!\[([^\]]*)\]\([^)]+\)/g);if(i){let o=i.filter(r=>{var h;let u=(h=r.match(/!\[([^\]]*)\]/))==null?void 0:h[1];return!u||u.trim()===""});o.length>0&&o.forEach((r,u)=>{let h=r.match(/!\[[^\]]*\]\(([^)]+)\)/),g=h?h[1]:r,f=x(a,r);e.push({passed:!1,message:`Image missing alt text: ${g}`,suggestion:"Add descriptive alt text for accessibility",severity:"error",position:{line:f,searchText:r,context:E(a,f)}})})}let l=s.match(/!\[\[([^\]]+)\]\]/g);if(l){let o=l.filter(r=>!r.includes("|"));o.length>0&&o.forEach((r,u)=>{let h=r.match(/!\[\[([^\]]+)\]\]/),g=h?h[1]:r,f=x(a,r);e.push({passed:!1,message:`Wikilink image missing alt text: ${g}`,suggestion:"Add alt text using ![[image.png|alt text]] syntax or consider using standard markdown image syntax",severity:"error",position:{line:f,searchText:r,context:E(a,f)}})})}let c=s.match(/<img[^>]*>/g);if(c){let o=c.filter(r=>{let u=r.match(/alt\s*=\s*["']([^"']*)["']/);return!u||!u[1]||u[1].trim()===""});o.length>0&&o.forEach((r,u)=>{let h=r.match(/src\s*=\s*["']([^"']*)["']/),g=h?h[1]:"HTML img tag",f=x(a,r);e.push({passed:!1,message:`HTML image missing alt attribute: ${g}`,suggestion:"Add alt attribute to HTML img tag",severity:"error",position:{line:f,searchText:r,context:E(a,f)}})})}return e.length===0&&(i&&i.length>0||c&&c.length>0||l&&l.length>0?e.push({passed:!0,message:"All images have alt text",severity:"info"}):e.push({passed:!0,message:"No images in this post",severity:"info"})),e}var Te=b(()=>{"use strict";D();M()});async function se(a,n,t){let e=[];if(!t.checkNakedLinks)return[];let i=ee(a).match(/(?<!\]\()(?<!https?:\/\/[^\s\)]*\/)https?:\/\/[^\s\)]+/g);return i&&i.forEach((l,c)=>{if(l.includes("web.archive.org/web/")||l.includes("archive.today/")||l.includes("archive.is/")||l.includes("web.archive.org/save/"))return;let o=x(a,l);e.push({passed:!1,message:`Naked link found: ${l}`,suggestion:"Convert to markdown link format: [link text](url)",severity:"warning",position:{line:o,searchText:l,context:E(a,o)}})}),e.length===0&&e.push({passed:!0,message:"No naked links found",severity:"info"}),e}async function ne(a,n,t,e){let s=[];if(!t.checkBrokenLinks)return[];let l=a.replace(/```[\s\S]*?```/g,"").replace(/~~~[\s\S]*?~~~/g,"").replace(/`[^`\n]+`/g,"").replace(/^---\n[\s\S]*?\n---\n/,"").replace(/::\w+\{[^}]*\}/g,"").match(/\[\[([^\]]+)\]\]/g);if(l){let c=[];for(let o of l){let r=o.match(/\[\[([^\]]+)\]\]/);if(!r||!r[1])continue;let u=r[1],[h,g]=u.split("|");e&&(e.vault.getAbstractFileByPath(h+".md")||c.push({link:o,path:h,displayText:g||h}))}c.length>0&&c.forEach(({link:o,path:r,displayText:u})=>{let h=x(a,o);s.push({passed:!1,message:`Broken internal link: ${u}`,suggestion:`Check if the file "${r}.md" exists or update the link`,severity:"error",position:{line:h,searchText:o,context:E(a,h)}})})}return s.length===0&&s.push({passed:!0,message:"No broken internal links found",severity:"info"}),s}async function ie(a,n,t,e){let s=[];if(!t.checkPotentiallyBrokenLinks)return[];let l=a.replace(/```[\s\S]*?```/g,"").replace(/~~~[\s\S]*?~~~/g,"").replace(/`[^`\n]+`/g,"").replace(/^---\n[\s\S]*?\n---\n/,"").replace(/::\w+\{[^}]*\}/g,"").match(/\[\[([^\]]+)\]\]/g);if(l){let c=[];for(let o of l){let r=o.match(/\[\[([^\]]+)\]\]/);if(!r||!r[1])continue;let u=r[1],[h,g]=u.split("|");if(e&&h&&!e.vault.getAbstractFileByPath(h+".md")){let k=e.vault.getMarkdownFiles().filter(p=>p.path.toLowerCase().includes(h.toLowerCase())||p.basename.toLowerCase().includes(h.toLowerCase()));k.length>0&&c.push({link:o,path:h,displayText:g||h,suggestions:k.map(p=>p.path)})}}c.length>0&&c.forEach(({link:o,path:r,displayText:u,suggestions:h})=>{let g=x(a,o);s.push({passed:!1,message:`Potentially broken link: ${u}`,suggestion:`Consider these similar files: ${h.slice(0,3).join(", ")}`,severity:"warning",position:{line:g,searchText:o,context:E(a,g)}})})}return s.length===0&&s.push({passed:!0,message:"No potentially broken links found",severity:"info"}),s}var Le=b(()=>{"use strict";D();M()});async function re(a,n,t){let e=[];if(!t.checkExternalLinks)return[];let s=a.replace(/```[\s\S]*?```/g,"").replace(/~~~[\s\S]*?~~~/g,"").replace(/`[^`\n]+`/g,"").replace(/^---\n[\s\S]*?\n---\n/,"").replace(/::\w+\{[^}]*\}/g,""),i=[],l=s.match(/\[([^\]]+)\]\((https?:\/\/[^)]+)\)/g);l&&l.forEach(r=>{let u=r.match(/\[([^\]]+)\]\((https?:\/\/[^)]+)\)/);u&&u[2]&&i.push(u[2])});let c=s.match(/(?<!\]\()(?<!https?:\/\/[^\s\)]*\/)https?:\/\/[^\s\)]+/g);c&&c.forEach(r=>{!r.includes("web.archive.org/web/")&&!r.includes("archive.today/")&&!r.includes("archive.is/")&&!r.includes("web.archive.org/save/")&&i.push(r)});let o=[...new Set(i)];return o.length>0?o.forEach((r,u)=>{let h=x(a,r);e.push({passed:!0,message:`External link: ${r}`,suggestion:"To find if any of these are broken, use the 'Check external links for 404s' button to trigger it.",severity:"notice",position:{line:h,searchText:r,context:E(a,h)}})}):e.push({passed:!0,message:"No external links found",severity:"info"}),e}async function ae(a,n,t){let e=[];if(!t.enableExternalLinkVaultCheck)return[];let s=a.replace(/```[\s\S]*?```/g,"").replace(/~~~[\s\S]*?~~~/g,"").replace(/`[^`\n]+`/g,"").replace(/^---\n[\s\S]*?\n---\n/,"").replace(/::\w+\{[^}]*\}/g,""),i=[],l=s.match(/\[([^\]]+)\]\((https?:\/\/[^)]+)\)/g);l&&l.forEach(r=>{let u=r.match(/\[([^\]]+)\]\((https?:\/\/[^)]+)\)/);u&&u[2]&&i.push(u[2])});let c=s.match(/(?<!\]\()(?<!https?:\/\/[^\s\)]*\/)https?:\/\/[^\s\)]+/g);c&&c.forEach(r=>{!r.includes("web.archive.org/web/")&&!r.includes("archive.today/")&&!r.includes("archive.is/")&&!r.includes("web.archive.org/save/")&&i.push(r)});let o=[...new Set(i)];if(o.length===0)return e.push({passed:!0,message:"No external links found",severity:"info"}),e;for(let r of o){let u=null;try{let h=new AbortController;u=setTimeout(()=>h.abort(),1e4);let g=await fetch(r,{method:"GET",headers:{Range:"bytes=0-0"},mode:"no-cors",signal:h.signal});u&&clearTimeout(u)}catch(h){u&&clearTimeout(u);let g=a.split(`
`),f=1;for(let p=0;p<g.length;p++){let y=g[p];if(y&&r&&y.includes(r)){f=p+1;break}}let d="",k="";h instanceof Error&&h.name==="AbortError"?(d=`External link timeout: ${r}`,k="This link took too long to respond. The server might be slow or the link might be broken."):h instanceof Error&&(h.message.includes("Failed to fetch")||h.message.includes("net::ERR_"))?(d=`External link unreachable: ${r}`,k="This link could not be reached. Check if the URL is correct or if the server is down."):(d=`External link error: ${r}`,k="This link could not be verified. Please check the URL manually."),e.push({passed:!1,message:d,suggestion:k,severity:"error",position:{line:f,searchText:r,context:E(a,f)}})}}return e.length===0&&o.length>0&&e.push({passed:!0,message:`Found ${o.length} external link(s), all appear to resolve and are working`,severity:"info"}),e}var Pe=b(()=>{"use strict";M()});function oe(a){let n=a.toLowerCase().replace(/[^a-z]/g,"");if(n.length===0)return 0;let t=0,e=!1;for(let s=0;s<n.length;s++){let i=n[s];if(i){let l=/[aeiouy]/.test(i);l&&!e&&t++,e=l}}return n.endsWith("e")&&t>1&&t--,Math.max(1,t)}function le(a){return a<=6?"Very easy to read":a<=9?"Easy to read":a<=12?"Moderately easy to read":a<=15?"Moderately difficult to read":a<=18?"Difficult to read":"Very difficult to read"}var ce=b(()=>{"use strict"});async function ue(a,n,t){let e=[];if(!t.checkContentLength)return[];let s=a.replace(/^---\n[\s\S]*?\n---\n/,"");s=s.replace(/```[\s\S]*?```/g,""),s=s.replace(/~~~[\s\S]*?~~~/g,"");let i=s.split(/\s+/).filter(l=>l.length>0).length;return i<t.minContentLength?e.push({passed:!1,message:`Content too short: ${i} words`,suggestion:`Aim for at least ${t.minContentLength} words for better SEO`,severity:"warning"}):e.push({passed:!0,message:`Good content length: ${i} words`,severity:"info"}),e}async function he(a,n,t){let e=[];if(!t.checkReadingLevel)return[];let s=P(a),i=s.split(/[.!?]+/).filter(g=>g.trim().length>0),l=s.split(/\s+/).filter(g=>g.length>0);if(i.length===0||l.length===0)return e.push({passed:!0,message:"No readable content found for reading level analysis",severity:"info"}),e;let c=l.reduce((g,f)=>g+oe(f),0),o=l.length/i.length,r=c/l.length,u=.39*o+11.8*r-15.59,h=le(u);return u>12?e.push({passed:!1,message:`Reading level too high: ${u.toFixed(1)} (${h})`,suggestion:"Consider simplifying sentence structure and using shorter words",severity:"warning"}):e.push({passed:!0,message:`Good reading level: ${u.toFixed(1)} (${h})`,severity:"info"}),e}async function ge(a,n,t){let e=[];if(!t.checkDuplicateContent)return[];let i=P(a).split(/\n\s*\n/).filter(c=>c.trim().length>20),l=[];for(let c=0;c<i.length;c++)for(let o=c+1;o<i.length;o++){let r=i[c],u=i[o];if(r&&u){let h=Xe(r,u);h>t.duplicateThreshold&&l.push({paragraph1:c+1,paragraph2:o+1,similarity:h})}}return l.length>0?l.forEach(({paragraph1:c,paragraph2:o,similarity:r})=>{e.push({passed:!1,message:`Duplicate content detected between paragraphs ${c} and ${o}`,suggestion:`Similarity: ${r.toFixed(1)}% - consider rewriting one of these paragraphs`,severity:"warning"})}):e.push({passed:!0,message:"No duplicate content detected",severity:"info"}),e}function Xe(a,n){let t=a.toLowerCase().split(/\s+/),e=n.toLowerCase().split(/\s+/),s=new Set(t),i=new Set(e),l=new Set([...s].filter(o=>i.has(o))),c=new Set([...s,...i]);return l.size/c.size*100}var Oe=b(()=>{"use strict";D();ce()});async function pe(a,n,t){let e=[];if(!t.descriptionProperty)return[];let s=a.match(/^---\n([\s\S]*?)\n---/);if(!s)return e.push({passed:!1,message:"No frontmatter found",suggestion:"Add frontmatter with description property",severity:"warning"}),e;let i=s[1];if(!i)return e.push({passed:!1,message:"No frontmatter content found",suggestion:"Add frontmatter with description property",severity:"warning"}),e;let l=i.match(new RegExp(`^${t.descriptionProperty}:\\s*(.+)$`,"m"));if(!l||!l[1])return e.push({passed:!1,message:`No ${t.descriptionProperty} found in frontmatter`,suggestion:`Add ${t.descriptionProperty} to frontmatter`,severity:"warning"}),e;let o=l[1].trim().length;return o<120?e.push({passed:!1,message:`Description too short: ${o} characters`,suggestion:"Aim for 120-160 characters",severity:"warning"}):o>160?e.push({passed:!1,message:`Description too long: ${o} characters`,suggestion:"Aim for 120-160 characters",severity:"warning"}):e.push({passed:!0,message:`Good description length: ${o} characters`,severity:"info"}),e}async function de(a,n,t){let e=[];if(!t.checkTitleLength)return[];let s="";if(t.titleProperty){let l=a.match(/^---\n([\s\S]*?)\n---/);if(l&&l[1]){let o=l[1].match(new RegExp(`^${t.titleProperty}:\\s*(.+)$`,"m"));o&&o[1]&&(s=o[1].trim())}}if(!s&&t.useFilenameAsTitle&&(s=n.basename),!s){let l=a.match(/^#\s+(.+)$/m);l&&l[1]&&(s=l[1].trim())}if(!s)return e.push({passed:!1,message:"No title found",suggestion:"Add a title in frontmatter or as H1 heading",severity:"warning"}),e;let i=s.length;return i<30?e.push({passed:!1,message:`Title too short: ${i} characters`,suggestion:"Aim for 30-60 characters",severity:"warning"}):i>60?e.push({passed:!1,message:`Title too long: ${i} characters`,suggestion:"Aim for 30-60 characters",severity:"warning"}):e.push({passed:!0,message:`Good title length: ${i} characters`,severity:"info"}),e}async function fe(a,n,t){let e=[];if(!t.keywordProperty)return[];let s=a.match(/^---\n([\s\S]*?)\n---/);if(!s)return e.push({passed:!1,message:"No frontmatter found",suggestion:"Add frontmatter with keyword property",severity:"warning"}),e;let i=s[1];if(!i)return e.push({passed:!1,message:"No frontmatter content found",suggestion:"Add frontmatter with keyword property",severity:"warning"}),e;let l=i.match(new RegExp(`^${t.keywordProperty}:\\s*(.+)$`,"m"));if(!l||!l[1])return e.push({passed:!1,message:`No ${t.keywordProperty} found in frontmatter`,suggestion:`Add ${t.keywordProperty} to frontmatter`,severity:"warning"}),e;let c=l[1].trim(),o=P(a),r=new RegExp(`\\b${c.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\b`,"gi"),u=o.match(r),h=u?u.length:0,f=o.split(/\s+/).filter(k=>k.length>0).length;if(f===0)return e.push({passed:!1,message:"No content found for keyword analysis",severity:"warning"}),e;let d=h/f*100;return d<t.keywordDensityMin?e.push({passed:!1,message:`Keyword density too low: ${d.toFixed(1)}%`,suggestion:`Aim for at least ${t.keywordDensityMin}% density`,severity:"warning"}):d>t.keywordDensityMax?e.push({passed:!1,message:`Keyword density too high: ${d.toFixed(1)}%`,suggestion:`Aim for no more than ${t.keywordDensityMax}% density`,severity:"warning"}):e.push({passed:!0,message:`Good keyword density: ${d.toFixed(1)}%`,severity:"info"}),e}async function me(a,n,t){var d,k;let e=[];if(!t.keywordProperty||!t.titleProperty)return[];let s=a.match(/^---\n([\s\S]*?)\n---/);if(!s)return e;let i=s[1];if(!i)return e;let l=i.match(new RegExp(`^${t.keywordProperty}:\\s*(.+)$`,"m")),c=i.match(new RegExp(`^${t.titleProperty}:\\s*(.+)$`,"m")),o=(d=l==null?void 0:l[1])==null?void 0:d.trim(),r=(k=c==null?void 0:c[1])==null?void 0:k.trim();if(!r||!o)return e;let u=r.toLowerCase();return o.toLowerCase().split(/\s+/).filter(p=>p.length>0).every(p=>u.includes(p))?e.push({passed:!0,message:`Target keyword "${o}" found in title`,severity:"info"}):e.push({passed:!1,message:`Target keyword "${o}" not found in title`,suggestion:"Include your target keyword in the title for better SEO",severity:"warning"}),e}var Re=b(()=>{"use strict";D()});async function ke(a,n,t){let e=[];if(!t.checkHeadingOrder)return[];let s=a.split(`
`),i=null,l=!1,c=!1,o=0;for(let r=0;r<s.length;r++){let u=s[r];if(!u)continue;let h=u.match(/^(#{1,6})\s+(.+)/);if(h&&h[1]&&h[2]){l=!0;let g=h[1].length,f=h[2].trim(),d=r+1;if(g===1&&(c=!0),i===null){i=g,o=d;continue}g>i+1&&e.push({passed:!1,message:`"${f}" (H${g}) skips heading level(s) after H${i}`,suggestion:"Use heading levels in order (H1 \u2192 H2 \u2192 H3, etc.)",severity:"warning",position:{line:d,searchText:u,context:E(a,d)}}),g===1&&i>1&&e.push({passed:!1,message:`"${f}" (H1) appears after H${i}`,suggestion:"H1 should be the first heading or not used at all",severity:"warning",position:{line:d,searchText:u,context:E(a,d)}}),i=g}}return l&&!t.skipH1Check&&!c&&e.unshift({passed:!1,message:"No H1 heading found",suggestion:"Add an H1 heading at the beginning of your content",severity:"warning"}),l?e.length===0&&e.push({passed:!0,message:"Heading structure is correct",severity:"info"}):e.push({passed:!0,message:"No heading structure issues found",severity:"info"}),e}var Fe=b(()=>{"use strict";M()});async function ye(a,n,t){let e=[];if(!t.checkImageNaming)return[];let s=P(a),i=a.split(`
`),l=s.match(/!\[[^\]]*\]\(([^)]+)\)/g);return l&&l.forEach((c,o)=>{var u;let r=(u=c.match(/!\[[^\]]*\]\(([^)]+)\)/))==null?void 0:u[1];if(r){let h=r.split("/").pop()||"",g=x(a,c);h.includes(" ")||h.includes("%20")?e.push({passed:!1,message:`Image ${o+1} has spaces in file name: ${h}`,suggestion:"Use kebab-case or underscores instead of spaces",severity:"warning",position:{line:g,searchText:c,context:E(a,g)}}):h.match(/^[a-f0-9]{8,}$/)||h.match(/^[a-f0-9]{8,}_[A-Z0-9]+\./)||h.match(/^[a-f0-9]{8,}_MD5\./)||h.match(/^[a-f0-9]{20,}\./)?e.push({passed:!1,message:`Image ${o+1} has random file name: ${h}`,suggestion:"Use descriptive file names",severity:"warning",position:{line:g,searchText:c,context:E(a,g)}}):h.toLowerCase().includes("pasted")||h.toLowerCase().includes("untitled")||h.toLowerCase().includes("photo")||h.match(/^screenshot\d*\.(png|jpg|jpeg|gif|webp)$/i)||h.toLowerCase().includes("screenshot")&&h.match(/^screenshot[a-f0-9]{6,}\.(png|jpg|jpeg|gif|webp)$/i)?e.push({passed:!1,message:`Image ${o+1} has a potentially generic file name: ${h}`,suggestion:"Use descriptive file names",severity:"warning",position:{line:g,searchText:c,context:E(a,g)}}):(h.length<5||h.length>50)&&e.push({passed:!1,message:`Image ${o+1} exceeds suggested file name length: ${h}`,suggestion:"Use descriptive file names between 5-50 characters",severity:"warning",position:{line:g,searchText:c,context:E(a,g)}})}}),e.length===0&&e.push({passed:!0,message:"All images have good file names",severity:"info"}),e}var Ne=b(()=>{"use strict";D();M()});async function Ae(a,n,t){return[]}async function Ie(a,n,t){return[]}async function De(a,n,t){return[]}function Me(a,n,t){if(t.useNoteTitles&&t.titleProperty.trim()){let e=n.match(/^---\r?\n([\s\S]*?)\r?\n---/);if(e||(e=n.match(/^---\n([\s\S]*?)\n---/)),e||(e=n.match(/^---\s*\n([\s\S]*?)\n\s*---/)),e&&e[1]){let i=e[1].split(`
`);for(let l of i){if(!l)continue;let c=l.trim();if(c.startsWith(t.titleProperty+":")){let o=c.indexOf(":");if(o!==-1){let r=c.substring(o+1).trim();if((r.startsWith('"')&&r.endsWith('"')||r.startsWith("'")&&r.endsWith("'"))&&(r=r.slice(1,-1)),r)return r}}}}}return a.basename}var $e=b(()=>{"use strict";Te();Le();Pe();Oe();Re();Fe();Ne();D();M();ce()});var O={};ve(O,{clearAllCache:()=>ot,clearCache:()=>it,clearCacheForFile:()=>at,getCacheStats:()=>rt,runSEOCheck:()=>Qe});async function Qe(a,n){let t=[];for(let e of n)try{let s=st(e,a);if(s){t.push(s);continue}let i=await a.app.vault.read(e),l=await et(a,e,i);nt(e,l,a),t.push(l)}catch(s){console.error(`Error checking file ${e.path}:`,s)}return t}async function et(a,n,t){let e={titleLength:await de(t,n,a.settings),metaDescription:await pe(t,n,a.settings),keywordInTitle:await me(t,n,a.settings),keywordInSlug:await Ie(t,n,a.settings),slugFormat:await De(t,n,a.settings),keywordDensity:await fe(t,n,a.settings),headingOrder:await ke(t,n,a.settings),contentLength:await ue(t,n,a.settings),duplicateContent:await ge(t,n,a.settings),altText:await te(t,n,a.settings),imageFileNames:await ye(t,n,a.settings),brokenLinks:await ne(t,n,a.settings,a.app),nakedLinks:await se(t,n,a.settings),readingLevel:await he(t,n,a.settings),potentiallyBrokenLinks:await ie(t,n,a.settings,a.app),potentiallyBrokenEmbeds:await Ae(t,n,a.settings),externalBrokenLinks:a.settings.enableExternalLinkVaultCheck?await ae(t,n,a.settings):a.settings.checkExternalLinks?await re(t,n,a.settings):[]},s=Object.values(e).flat(),i=s.filter(r=>r.severity==="error").length,l=s.filter(r=>r.severity==="warning").length,c=s.filter(r=>r.severity==="notice").length,o;if(s.length===0)o=100;else{let r=0,u=0;s.forEach(p=>{if(p.severity==="notice")return;let y=1,w=0;p.message.includes("Broken link")&&!p.passed||p.message.includes("title")&&!p.passed?(y=10,w=0):p.message.includes("alt text")&&!p.passed||p.message.includes("meta description")&&!p.passed?(y=5,w=0):p.message.includes("content length")&&!p.passed||p.message.includes("reading level")&&!p.passed?(y=3,w=0):p.severity==="warning"&&!p.passed?(y=1,w=0):p.passed&&(w=100),r+=w*y,u+=y});let h=u>0?r/u:100,g=0,f=s.filter(p=>p.severity==="error"&&!p.passed&&p.message.includes("Broken link")).length;g+=Math.min(f*2,10);let d=s.filter(p=>p.severity==="error"&&!p.passed&&p.message.includes("alt text")).length;g+=Math.min(d*1,5);let k=s.filter(p=>p.severity==="warning"&&!p.passed).length;g+=Math.min(k*.5,5),g=Math.min(g,20),o=Math.max(40,Math.min(100,h-g))}return{file:n.path,displayName:Me(n,t,a.settings),checks:e,overallScore:o,issuesCount:i,warningsCount:l,noticesCount:c}}async function tt(a,n){try{let t=await n.vault.read(a),e=await n.vault.adapter.stat(a.path);return`${t.length}-${e.mtime}`}catch(t){return`${Date.now()}`}}function He(a){let n={keywordProperty:a.keywordProperty||"",keywordDensityMin:a.keywordDensityMin,keywordDensityMax:a.keywordDensityMax,descriptionProperty:a.descriptionProperty||"",titleProperty:a.titleProperty||"",useFilenameAsTitle:a.useFilenameAsTitle,checkContentLength:a.checkContentLength,minContentLength:a.minContentLength,checkDuplicateContent:a.checkDuplicateContent,scanDirectories:a.scanDirectories||""};return JSON.stringify(n)}function st(a,n){let t=$.get(a.path);if(!t)return null;let s=Date.now()-t.timestamp>Ye,i=He(n.settings),l=t.settingsHash!==i;return s||l?($.delete(a.path),null):t.result}async function nt(a,n,t){let e=await tt(a,t.app),s=He(t.settings);$.set(a.path,{result:n,timestamp:Date.now(),fileHash:e,settingsHash:s})}function it(){$.clear()}function rt(){return{size:$.size}}function at(a){$.delete(a)}function ot(){$.clear()}var $,Ye,R=b(()=>{"use strict";$e();$=new Map,Ye=24*60*60*1e3});var lt={};ve(lt,{default:()=>J});module.exports=Ze(lt);var ze=require("obsidian");var Y={scanDirectories:"",keywordProperty:"",descriptionProperty:"",titleProperty:"",useFilenameAsTitle:!1,slugProperty:"",useFilenameAsSlug:!1,parentFolderSlugFilename:"",checkTitleLength:!0,checkHeadingOrder:!0,checkAltText:!0,checkImageNaming:!0,checkBrokenLinks:!0,checkExternalLinks:!0,enableExternalLinkButton:!0,enableExternalLinkVaultCheck:!1,checkNakedLinks:!0,checkContentLength:!0,checkDuplicateContent:!1,checkReadingLevel:!0,checkPotentiallyBrokenLinks:!0,checkPotentiallyBrokenEmbeds:!0,useNoteTitles:!1,skipH1Check:!1,publishMode:!1,defaultSort:"issues-desc",minContentLength:300,keywordDensityMin:1,keywordDensityMax:2,duplicateThreshold:80,cachedGlobalResults:[],lastScanTimestamp:0};var Je=require("obsidian");function Se(a){a.addCommand({id:"seo-open-current",name:"Open current note audit",callback:async()=>{a.openCurrentPanel(),setTimeout(async()=>{let n=a.app.workspace.getLeavesOfType("seo-current-panel")[0];if(n&&n.view){let t=n.view.containerEl.querySelector(".seo-top-btn");t&&t.click()}},200)}}),a.addCommand({id:"seo-open-global",name:"Open vault audit",callback:async()=>{let t=a.app.workspace.getLeavesOfType("seo-global-panel").length===0;a.openGlobalPanel(),setTimeout(async()=>{let e=a.app.workspace.getLeavesOfType("seo-global-panel");if(e.length===0){a.openGlobalPanel();return}let s=e[0];if(s!=null&&s.view){let i=s.view;t?(a.app.workspace.revealLeaf(s),a.app.workspace.setActiveLeaf(s)):(await i.actions.refreshGlobalResults(),i.render())}},300)}})}var m=require("obsidian"),W=class extends m.PluginSettingTab{constructor(t,e){super(t,e);this.plugin=e}display(){let{containerEl:t}=this;t.empty(),t.createEl("h2",{text:"Global"}),new m.Setting(t).setName("Scan directories").setDesc("Comma-separated list of directory names to scan. Leave blank to scan all directories.").addText(o=>o.setPlaceholder("e.g., blog, posts, public").setValue(this.plugin.settings.scanDirectories).onChange(async r=>{this.plugin.settings.scanDirectories=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Use note titles instead of file names").setDesc("Display note titles from frontmatter instead of file names in the issues list and current note audit").addToggle(o=>o.setValue(this.plugin.settings.useNoteTitles).onChange(async r=>{this.plugin.settings.useNoteTitles=r,await this.plugin.saveSettings()})),t.createEl("h2",{text:"Property Names"}),new m.Setting(t).setName("Keyword property").setDesc("Property name for target keyword (e.g., targetKeyword, seo, keyword)").addText(o=>o.setPlaceholder("targetKeyword").setValue(this.plugin.settings.keywordProperty).onChange(async r=>{this.plugin.settings.keywordProperty=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Description property").setDesc("Property name for meta description").addText(o=>o.setPlaceholder("description").setValue(this.plugin.settings.descriptionProperty).onChange(async r=>{this.plugin.settings.descriptionProperty=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Title property").setDesc("Property name for title (leave blank to skip title checks)").addText(o=>o.setPlaceholder("title").setValue(this.plugin.settings.titleProperty).onChange(async r=>{this.plugin.settings.titleProperty=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Use file name as title").setDesc("Use file name as title instead of a property").addToggle(o=>o.setValue(this.plugin.settings.useFilenameAsTitle).onChange(async r=>{this.plugin.settings.useFilenameAsTitle=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Slug property").setDesc("Property name for slug (leave blank to skip slug checks)").addText(o=>o.setPlaceholder("slug").setValue(this.plugin.settings.slugProperty).onChange(async r=>{this.plugin.settings.slugProperty=r,await this.plugin.saveSettings()}));let e=new m.Setting(t).setName("Use file/folder name as slug").setDesc("Use file/folder name as slug instead of a property").addToggle(o=>o.setValue(this.plugin.settings.useFilenameAsSlug).onChange(async r=>{this.plugin.settings.useFilenameAsSlug=r,await this.plugin.saveSettings(),this.display()}));this.plugin.settings.useFilenameAsSlug&&new m.Setting(t).setName("Use parent folder name instead when specified file name is used").setDesc("If a markdown file matches this file name, use the parent folder name as the slug instead").addText(o=>o.setPlaceholder("index").setValue(this.plugin.settings.parentFolderSlugFilename).onChange(async r=>{this.plugin.settings.parentFolderSlugFilename=r,await this.plugin.saveSettings()})),t.createEl("h2",{text:"Audit Options"}),new m.Setting(t).setName("Check title length").setDesc("Enable title length checking").addToggle(o=>o.setValue(this.plugin.settings.checkTitleLength).onChange(async r=>{this.plugin.settings.checkTitleLength=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Check heading order").setDesc("Enable heading hierarchy checking").addToggle(o=>o.setValue(this.plugin.settings.checkHeadingOrder).onChange(async r=>{this.plugin.settings.checkHeadingOrder=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Check content length").setDesc("Enable content length checking").addToggle(o=>o.setValue(this.plugin.settings.checkContentLength).onChange(async r=>{this.plugin.settings.checkContentLength=r,await this.plugin.saveSettings()}));let i=new m.Setting(t).setName("Check duplicate content").setDesc("Enable duplicate content detection").addToggle(o=>o.setValue(this.plugin.settings.checkDuplicateContent).onChange(async r=>{this.plugin.settings.checkDuplicateContent=r,await this.plugin.saveSettings()})).descEl.createEl("div",{text:"\u26A0\uFE0F WARNING: This feature can be very resource-intensive with large vaults and many notes. Disable for faster audits.",cls:"setting-item-description"});i.style.color="#ff6b6b",i.style.fontWeight="bold",i.style.marginTop="4px",new m.Setting(t).setName("Check alt text").setDesc("Enable alt text checking for images").addToggle(o=>o.setValue(this.plugin.settings.checkAltText).onChange(async r=>{this.plugin.settings.checkAltText=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Check image file names").setDesc("Enable image file name checking").addToggle(o=>o.setValue(this.plugin.settings.checkImageNaming).onChange(async r=>{this.plugin.settings.checkImageNaming=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Check broken internal links").setDesc("Enable broken internal link detection").addToggle(o=>o.setValue(this.plugin.settings.checkBrokenLinks).onChange(async r=>{this.plugin.settings.checkBrokenLinks=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Check external links").setDesc("Return a list of external links").addToggle(o=>o.setValue(this.plugin.settings.checkExternalLinks).onChange(async r=>{this.plugin.settings.checkExternalLinks=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Enable broken external link check button").setDesc('Show "Check external links for 404s" button in current note panel').addToggle(o=>o.setValue(this.plugin.settings.enableExternalLinkButton).onChange(async r=>{this.plugin.settings.enableExternalLinkButton=r,await this.plugin.saveSettings(),this.plugin.sidePanel&&this.plugin.sidePanel.refresh()})),new m.Setting(t).setName("Check naked links").setDesc("Enable naked URL detection").addToggle(o=>o.setValue(this.plugin.settings.checkNakedLinks).onChange(async r=>{this.plugin.settings.checkNakedLinks=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Check reading level").setDesc("Enable reading level analysis").addToggle(o=>o.setValue(this.plugin.settings.checkReadingLevel).onChange(async r=>{this.plugin.settings.checkReadingLevel=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Check potentially broken links").setDesc("Check for potentially broken internal links that may not work on web publishing").addToggle(o=>o.setValue(this.plugin.settings.checkPotentiallyBrokenLinks).onChange(async r=>{this.plugin.settings.checkPotentiallyBrokenLinks=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Check potentially broken embeds").setDesc("Check for potentially broken markdown or wikilink-based embedded media that may not work on web publishing").addToggle(o=>o.setValue(this.plugin.settings.checkPotentiallyBrokenEmbeds).onChange(async r=>{this.plugin.settings.checkPotentiallyBrokenEmbeds=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Flexible relative link check").setDesc("Uses flexible validation for relative paths like /page that can be resolved by a static site generator, but may be considered broken by typical Obsidian validation").addToggle(o=>o.setValue(this.plugin.settings.publishMode).onChange(async r=>{this.plugin.settings.publishMode=r,await this.plugin.saveSettings()})),new m.Setting(t).setName("Skip H1 check").setDesc("For when your notes don't start with an H1, or H1 is hardcoded from the title for your published note. If enabled, won't require an H1, but will still flag H1s that appear after other heading levels.").addToggle(o=>o.setValue(this.plugin.settings.skipH1Check).onChange(async r=>{this.plugin.settings.skipH1Check=r,await this.plugin.saveSettings()}));let c=new m.Setting(t).setName("Automatically include broken external link checks in audits (not recommended)").setDesc("Include broken external link checking in vault-wide and current note audits").addToggle(o=>o.setValue(this.plugin.settings.enableExternalLinkVaultCheck).onChange(async r=>{this.plugin.settings.enableExternalLinkVaultCheck=r,await this.plugin.saveSettings(),this.plugin.sidePanel&&this.plugin.sidePanel.refresh()})).descEl.createEl("div",{text:'\u26A0\uFE0F WARNING: This will make vault audits extremely slow. Use the "Check external links" button instead for individual notes.',cls:"setting-item-description"});c.style.color="#ff6b6b",c.style.fontWeight="bold",c.style.marginTop="4px",t.createEl("h2",{text:"Thresholds"}),new m.Setting(t).setName("Minimum content length").setDesc("Minimum word count for content length check").addText(o=>o.setPlaceholder("300").setValue(this.plugin.settings.minContentLength.toString()).onChange(async r=>{let u=parseInt(r);isNaN(u)||(this.plugin.settings.minContentLength=u,await this.plugin.saveSettings())})),new m.Setting(t).setName("Keyword density minimum").setDesc("Minimum keyword density percentage").addText(o=>o.setPlaceholder("1").setValue(this.plugin.settings.keywordDensityMin.toString()).onChange(async r=>{let u=parseFloat(r);isNaN(u)||(this.plugin.settings.keywordDensityMin=u,await this.plugin.saveSettings())})),new m.Setting(t).setName("Keyword density maximum").setDesc("Maximum keyword density percentage").addText(o=>o.setPlaceholder("2").setValue(this.plugin.settings.keywordDensityMax.toString()).onChange(async r=>{let u=parseFloat(r);isNaN(u)||(this.plugin.settings.keywordDensityMax=u,await this.plugin.saveSettings())})),new m.Setting(t).setName("Duplicate content threshold").setDesc("Similarity percentage threshold for duplicate content detection").addText(o=>o.setPlaceholder("80").setValue(this.plugin.settings.duplicateThreshold.toString()).onChange(async r=>{let u=parseInt(r);isNaN(u)||(this.plugin.settings.duplicateThreshold=u,await this.plugin.saveSettings())}))}};var U=require("obsidian");var F="seo-current-panel",I="seo-global-panel";function xe(a){let n=a.split("/");return n.length<=2?a:n.slice(-2).join("/")}function Q(a,n){let t="Vault folders: ";if(!a||a.trim()==="")t+="all";else{let e=a.split(",").map(s=>s.trim()).filter(s=>s.length>0);t+=e.join(", ")}return n!==void 0&&(t+=`; ${n} files analyzed`),t}function be(a,n){let t=[...a];switch(n){case"warnings-desc":t.sort((e,s)=>s.warningsCount!==e.warningsCount?s.warningsCount-e.warningsCount:s.issuesCount!==e.issuesCount?s.issuesCount-e.issuesCount:s.noticesCount!==e.noticesCount?s.noticesCount-e.noticesCount:e.file.localeCompare(s.file));break;case"warnings-asc":t.sort((e,s)=>e.warningsCount!==s.warningsCount?e.warningsCount-s.warningsCount:e.issuesCount!==s.issuesCount?e.issuesCount-s.issuesCount:e.noticesCount!==s.noticesCount?e.noticesCount-s.noticesCount:e.file.localeCompare(s.file));break;case"issues-desc":t.sort((e,s)=>s.issuesCount!==e.issuesCount?s.issuesCount-e.issuesCount:s.warningsCount!==e.warningsCount?s.warningsCount-e.warningsCount:s.noticesCount!==e.noticesCount?s.noticesCount-e.noticesCount:e.file.localeCompare(s.file));break;case"issues-asc":t.sort((e,s)=>e.issuesCount!==s.issuesCount?e.issuesCount-s.issuesCount:e.warningsCount!==s.warningsCount?e.warningsCount-s.warningsCount:e.noticesCount!==s.noticesCount?e.noticesCount-s.noticesCount:e.file.localeCompare(s.file));break;case"notices-desc":t.sort((e,s)=>s.noticesCount!==e.noticesCount?s.noticesCount-e.noticesCount:s.issuesCount!==e.issuesCount?s.issuesCount-e.issuesCount:s.warningsCount!==e.warningsCount?s.warningsCount-e.warningsCount:e.file.localeCompare(s.file));break;case"notices-asc":t.sort((e,s)=>e.noticesCount!==s.noticesCount?e.noticesCount-s.noticesCount:e.issuesCount!==s.issuesCount?e.issuesCount-s.issuesCount:e.warningsCount!==s.warningsCount?e.warningsCount-s.warningsCount:e.file.localeCompare(s.file));break;case"filename-asc":t.sort((e,s)=>{let i=e.file.localeCompare(s.file);return i!==0?i:s.issuesCount!==e.issuesCount?s.issuesCount-e.issuesCount:s.warningsCount!==e.warningsCount?s.warningsCount-e.warningsCount:s.noticesCount-e.noticesCount});break;case"filename-desc":t.sort((e,s)=>{let i=s.file.localeCompare(e.file);return i!==0?i:s.issuesCount!==e.issuesCount?s.issuesCount-e.issuesCount:s.warningsCount!==e.warningsCount?s.warningsCount-e.warningsCount:s.noticesCount-e.noticesCount});break}return t}var v=require("obsidian");var z=class{constructor(n,t,e){this.app=n;this.plugin=t;this.panelType=e}async runInitialScan(){try{let n=await this.plugin.getFilesToCheck();if(n.length===0)return[];n.length>20&&new v.Notice(`Running SEO audit on ${n.length} files... This may take a moment.`);let{runSEOCheck:t}=await Promise.resolve().then(()=>(R(),O)),e=await t(this.plugin,n);return this.plugin.settings.cachedGlobalResults=e,this.plugin.settings.lastScanTimestamp=Date.now(),await this.plugin.saveSettings(),new v.Notice(`SEO audit complete with ${e.length} files.`),e}catch(n){return console.error("Error running initial scan:",n),new v.Notice("Error analyzing files. Check console for details."),[]}}async checkCurrentNote(){let n=this.app.workspace.getActiveFile();if(!n||!n.path.endsWith(".md"))return new v.Notice("Please open a markdown file first."),null;try{let{clearCacheForFile:t}=await Promise.resolve().then(()=>(R(),O));t(n.path);let{runSEOCheck:e}=await Promise.resolve().then(()=>(R(),O)),s=await e(this.plugin,[n]);return s.length>0?(new v.Notice("SEO audit complete."),s[0]||null):null}catch(t){return console.error("Error checking current note:",t),new v.Notice("Error analyzing current note. Check console for details."),null}}async checkExternalLinks(){let n=this.app.workspace.getActiveFile();if(!n||!n.path.endsWith(".md"))return new v.Notice("Please open a markdown file first."),null;try{let t=this.plugin.settings.enableExternalLinkVaultCheck,e=this.plugin.settings.checkExternalLinks;this.plugin.settings.enableExternalLinkVaultCheck=!0,this.plugin.settings.checkExternalLinks=!1;let{clearCacheForFile:s}=await Promise.resolve().then(()=>(R(),O));s(n.path);let{runSEOCheck:i}=await Promise.resolve().then(()=>(R(),O)),l=await i(this.plugin,[n]);return this.plugin.settings.enableExternalLinkVaultCheck=t,this.plugin.settings.checkExternalLinks=e,l.length>0?(new v.Notice("External links check complete."),l[0]||null):null}catch(t){return console.error("Error checking external links:",t),new v.Notice("Error checking external links. Check console for details."),null}}async refreshGlobalResults(){try{let{clearAllCache:n}=await Promise.resolve().then(()=>(R(),O));n();let t=await this.plugin.getFilesToCheck();if(t.length===0)return new v.Notice("No markdown files found in configured directories."),[];t.length>20&&new v.Notice(`Refreshing SEO audit on ${t.length} files... This may take a moment.`);let{runSEOCheck:e}=await Promise.resolve().then(()=>(R(),O)),s=await e(this.plugin,t);return this.plugin.settings.cachedGlobalResults=s,this.plugin.settings.lastScanTimestamp=Date.now(),await this.plugin.saveSettings(),new v.Notice(`SEO audit complete with ${s.length} files.`),s}catch(n){return console.error("Error checking all notes:",n),new v.Notice("Error analyzing files. Check console for details."),[]}}async openFile(n){try{let t=this.app.vault.getAbstractFileByPath(n);if(t)try{await this.app.workspace.getLeaf().openFile(t)}catch(e){await this.app.workspace.openLinkText(n,"",!0)}}catch(t){console.error(`Error opening file ${n}:`,t)}}async openFileAndAudit(n){let t=this.app.vault.getAbstractFileByPath(n);t&&(await this.app.workspace.getLeaf().openFile(t),this.plugin.openCurrentPanel(),setTimeout(()=>{let e=this.app.workspace.getLeavesOfType(F)[0];if(e){let s=e.view.containerEl.querySelector(".seo-top-btn");s&&s.click()}},200))}showSortMenu(n,t,e,s,i,l){let c=new v.Menu,o=l?l.checkPotentiallyBrokenLinks&&l.checkPotentiallyBrokenEmbeds:!0,r=!o&&(s==="notices-desc"||s==="notices-asc")?"issues-desc":s;c.addItem(u=>{u.setTitle("Issues (high to low)").onClick(()=>{i("issues-desc"),this.sortAndRenderFiles(t,e,"issues-desc",l)}),r==="issues-desc"&&u.setIcon("check")}),c.addItem(u=>{u.setTitle("Issues (low to high)").onClick(()=>{i("issues-asc"),this.sortAndRenderFiles(t,e,"issues-asc",l)}),r==="issues-asc"&&u.setIcon("check")}),c.addSeparator(),c.addItem(u=>{u.setTitle("Warnings (high to low)").onClick(()=>{i("warnings-desc"),this.sortAndRenderFiles(t,e,"warnings-desc",l)}),r==="warnings-desc"&&u.setIcon("check")}),c.addItem(u=>{u.setTitle("Warnings (low to high)").onClick(()=>{i("warnings-asc"),this.sortAndRenderFiles(t,e,"warnings-asc",l)}),r==="warnings-asc"&&u.setIcon("check")}),c.addSeparator(),o&&(c.addItem(u=>{u.setTitle("Notices (high to low)").onClick(()=>{i("notices-desc"),this.sortAndRenderFiles(t,e,"notices-desc",l)}),r==="notices-desc"&&u.setIcon("check")}),c.addItem(u=>{u.setTitle("Notices (low to high)").onClick(()=>{i("notices-asc"),this.sortAndRenderFiles(t,e,"notices-asc",l)}),r==="notices-asc"&&u.setIcon("check")}),c.addSeparator()),c.addItem(u=>{u.setTitle("File name (A to Z)").onClick(()=>{i("filename-asc"),this.sortAndRenderFiles(t,e,"filename-asc",l)}),r==="filename-asc"&&u.setIcon("check")}),c.addItem(u=>{u.setTitle("File name (Z to A)").onClick(()=>{i("filename-desc"),this.sortAndRenderFiles(t,e,"filename-desc",l)}),r==="filename-desc"&&u.setIcon("check")}),c.showAtPosition({x:n.clientX,y:n.clientY})}sortAndRenderFiles(n,t,e,s){let i=be([...n],e),l=t.querySelector(".seo-files-list-container");l&&(l.querySelectorAll(".seo-file-issue").forEach(c=>c.remove()),this.renderFilesList(i,l,s))}renderFilesList(n,t,e){n.forEach(s=>{let i=t.createEl("div",{cls:"seo-file-issue"});i.setAttribute("data-file-path",s.file),i.createEl("a",{text:s.displayName||this.getDisplayPath(s.file),cls:"seo-file-link",href:"#"}).addEventListener("click",h=>{h.preventDefault(),this.openFile(s.file)});let c=i.createEl("div",{cls:"seo-stats-container"}),o=e?e.checkPotentiallyBrokenLinks&&e.checkPotentiallyBrokenEmbeds:!0,r=[];s.issuesCount>0&&r.push(`${s.issuesCount} issues`),s.warningsCount>0&&r.push(`${s.warningsCount} warnings`),o&&s.noticesCount>0&&r.push(`${s.noticesCount} notices`),c.createEl("span",{text:r.join(", "),cls:"seo-file-stats"});let u=c.createEl("button",{cls:"clickable-icon seo-audit-btn",attr:{"aria-label":"Audit this note"}});(0,v.setIcon)(u,"search-check"),u.addEventListener("click",async h=>{h.preventDefault(),h.stopPropagation(),await this.openFileAndAudit(s.file)})})}getDisplayPath(n){let t=n.split("/");return t.length<=2?n:t.slice(-2).join("/")}};var B=require("obsidian");var j=class{constructor(n,t,e){this.container=n;this.onFileClick=t;this.onFileAudit=e;this.isCollapsed=!0}async navigateToPosition(n){try{let t=window.app;if(!t){console.warn("Obsidian app not found");return}let e=t.workspace.getActiveFile();if(!e){console.warn("No active file found for navigation");return}await this.onFileClick(e.path);let s=null,i=null;if(t.workspace.activeLeaf&&(s=t.workspace.activeLeaf.view),!s&&t.workspace.getLeavesOfType){let l=t.workspace.getLeavesOfType("markdown");l.length>0&&(s=l[0].view)}if(!s&&t.workspace.getLeaves){let l=t.workspace.getLeaves();for(let c of l)if(c.view&&c.view.editor){s=c.view;break}}if(!s){console.warn("No markdown view found");return}if(i=s.editor,!i){console.warn("No editor found in markdown view");return}if(n.line){let l=Math.max(0,n.line-1);i.setCursor({line:l,ch:0});try{i.scrollIntoView({line:l,ch:0})}catch(c){try{i.scrollIntoView(l)}catch(o){}}try{let c=i.getLine(l).length;i.addHighlights([{from:{line:l,ch:0},to:{line:l,ch:c}}]),setTimeout(()=>{try{i.removeHighlights()}catch(o){}},2e3)}catch(c){}}}catch(t){console.error("Error navigating to position:",t)}}renderResults(n){let t=this.container.createEl("div",{cls:"seo-score-header"}),e=t.createEl("div",{cls:"seo-score-text"});e.createEl("span",{text:"Score: "});let s=e.createEl("span",{text:`${Math.round(n.overallScore)}%`});if(n.overallScore>=80?s.addClass("seo-score-excellent"):n.overallScore>=60?s.addClass("seo-score-good"):n.overallScore>=40?s.addClass("seo-score-fair"):s.addClass("seo-score-poor"),n.issuesCount>0||n.warningsCount>0||n.noticesCount>0){e.createEl("span",{text:" ("});let c=e.createEl("span",{text:`${n.issuesCount} issues`,cls:"seo-issues-count-text"});e.createEl("span",{text:", "});let o=e.createEl("span",{text:`${n.warningsCount} warnings`,cls:"seo-warnings-count-text"});if(n.noticesCount>0){e.createEl("span",{text:", "});let r=e.createEl("span",{text:`${n.noticesCount} notices`,cls:"seo-notices-count-text"})}e.createEl("span",{text:")"})}else e.createEl("span",{text:" (All checks passed!)",cls:"seo-success"});let i=t.createEl("div",{cls:"seo-toggle-icon"});(0,B.setIcon)(i,"chevrons-down-up"),i.addEventListener("click",()=>{this.isCollapsed=!this.isCollapsed,(0,B.setIcon)(i,this.isCollapsed?"chevrons-up-down":"chevrons-down-up"),this.toggleChecksVisibility()});let l=this.container.createEl("div",{cls:"seo-checks"});this.isCollapsed=!1,Object.entries(n.checks).forEach(([c,o])=>{if(o.length===0)return;let r=o.some(C=>C.severity==="error"),u=o.some(C=>C.severity==="warning"),h=o.some(C=>C.severity==="notice"),g=o.every(C=>C.severity==="info"),f="seo-passed";r?f="seo-error":u?f="seo-warning":h?f="seo-notice":g&&(f="seo-passed");let d=l.createEl("div",{cls:`seo-check ${f}`}),k=d.createEl("div",{cls:"seo-check-header seo-collapsible-header"}),p=c.replace(/([A-Z])/g," $1").trim().replace(/^./,C=>C.toUpperCase());if(c==="brokenLinks")p="Broken Internal Links";else if(c==="externalBrokenLinks"){let C=o.some(S=>S.severity==="notice"),N=o.some(S=>S.severity==="error");C&&!N?p="External Links":p="External Broken Links"}let y=k.createEl("span",{cls:"seo-collapse-icon"});y.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6,9 12,15 18,9"/></svg>',k.createEl("span",{text:p});let w=k.createEl("span",{cls:"seo-status"}),V=o.some(C=>C.severity==="error"),H=o.some(C=>C.severity==="warning"),je=o.some(C=>C.severity==="notice");V?w.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>':H?w.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>':je?w.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>':w.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></svg>';let G=d.createEl("ul",{cls:"seo-results"});G.style.display="block",o.forEach(C=>{let N=G.createEl("li",{cls:`seo-result seo-${C.severity}`});if(C.position){let S=N.createEl("span",{text:C.message,cls:"seo-result-message seo-clickable"});S.addEventListener("click",async Ee=>{Ee.preventDefault(),Ee.stopPropagation(),await this.navigateToPosition(C.position)}),S.style.cursor="pointer",S.style.textDecoration="underline",S.title="Click to jump to this issue in the note"}else N.createEl("span",{text:C.message,cls:"seo-result-message"});if(C.suggestion){let S=N.createEl("div",{cls:"seo-suggestion"});S.innerHTML=C.suggestion}}),k.addEventListener("click",()=>{let C=G.style.display==="none";G.style.display=C?"block":"none";let N=y.querySelector("svg");if(N&&(N.style.transform=C?"rotate(0deg)":"rotate(-90deg)"),C){this.isCollapsed=!1;let S=this.container.querySelector(".seo-toggle-icon");S&&(0,B.setIcon)(S,"chevrons-down-up")}})})}renderGlobalResults(n,t){let e=this.container.createEl("div",{cls:"seo-vault-summary"}),s=n.length,i=n.reduce((y,w)=>y+w.issuesCount,0),l=n.reduce((y,w)=>y+w.warningsCount,0),c=n.reduce((y,w)=>y+w.noticesCount,0),o=Math.round(n.reduce((y,w)=>y+w.overallScore,0)/s),r=t?t.checkPotentiallyBrokenLinks&&t.checkPotentiallyBrokenEmbeds:!0,u=e.createEl("div",{cls:"seo-stats-grid"}),h=u.createEl("div",{cls:"seo-stat-item"}),g=h.createEl("div",{cls:"seo-stat-number",text:`${o}%`});o>=80?g.addClass("seo-score-excellent"):o>=60?g.addClass("seo-score-good"):o>=40?g.addClass("seo-score-fair"):g.addClass("seo-score-poor"),h.createEl("div",{cls:"seo-stat-label",text:"Average Score"});let f=u.createEl("div",{cls:"seo-stat-item"}),d=f.createEl("div",{cls:"seo-stat-number",text:i.toString()});i>0&&d.addClass("seo-issues-count"),f.createEl("div",{cls:"seo-stat-label",text:"Issues"});let k=u.createEl("div",{cls:"seo-stat-item"}),p=k.createEl("div",{cls:"seo-stat-number",text:l.toString()});if(l>0&&p.addClass("seo-warnings-count"),k.createEl("div",{cls:"seo-stat-label",text:"Warnings"}),r){let y=u.createEl("div",{cls:"seo-stat-item"}),w=y.createEl("div",{cls:"seo-stat-number",text:c.toString()});c>0&&w.addClass("seo-notices-count"),y.createEl("div",{cls:"seo-stat-label",text:"Notices"})}}renderIssuesList(n,t,e,s,i){let l=i?i.checkPotentiallyBrokenLinks&&i.checkPotentiallyBrokenEmbeds:!0,c=n.filter(d=>{let k=d.issuesCount>0,p=d.warningsCount>0,y=l&&d.noticesCount>0;return k||p||y});if(c.length===0)return;let o=this.container.createEl("div",{cls:"seo-issues-list"}),r=o.createEl("div",{cls:"seo-issues-header-container"}),u=r.createEl("span",{cls:"seo-collapse-icon seo-collapsible-header"});u.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6,9 12,15 18,9"/></svg>',r.createEl("h4",{text:"Files with results",cls:"seo-issues-header"});let h=r.createEl("button",{cls:"seo-sort-btn",attr:{"aria-label":"Sort files"}});(0,B.setIcon)(h,"arrow-up-narrow-wide"),h.addEventListener("click",s);let g=o.createEl("div",{cls:"seo-files-list-container"});this.sortFiles(c,t).forEach(d=>{let k=g.createEl("div",{cls:"seo-file-issue"});k.setAttribute("data-file-path",d.file),k.createEl("a",{text:d.displayName||xe(d.file),cls:"seo-file-link",href:"#"}).addEventListener("click",async H=>{H.preventDefault(),await this.onFileClick(d.file)});let y=k.createEl("div",{cls:"seo-stats-container"}),w=[];d.issuesCount>0&&w.push(`${d.issuesCount} issues`),d.warningsCount>0&&w.push(`${d.warningsCount} warnings`),l&&d.noticesCount>0&&w.push(`${d.noticesCount} notices`),y.createEl("span",{text:w.join(", "),cls:"seo-file-stats"});let V=y.createEl("button",{cls:"clickable-icon seo-audit-btn",attr:{"aria-label":"Audit this note"}});(0,B.setIcon)(V,"search-check"),V.addEventListener("click",async H=>{H.preventDefault(),H.stopPropagation(),await this.onFileAudit(d.file)})}),u.addEventListener("click",d=>{let k=g.style.display==="none";g.style.display=k?"block":"none";let p=u.querySelector("svg");p&&(p.style.transform=k?"rotate(0deg)":"rotate(-90deg)")})}sortFiles(n,t){let e=[...n];switch(t){case"warnings-desc":e.sort((s,i)=>{let l=i.warningsCount-s.warningsCount;if(l!==0)return l;let c=i.issuesCount-s.issuesCount;if(c!==0)return c;let o=s.file.split("/").pop()||"",r=i.file.split("/").pop()||"";return o.localeCompare(r)});break;case"warnings-asc":e.sort((s,i)=>{let l=s.warningsCount-i.warningsCount;if(l!==0)return l;let c=s.issuesCount-i.issuesCount;if(c!==0)return c;let o=s.file.split("/").pop()||"",r=i.file.split("/").pop()||"";return o.localeCompare(r)});break;case"issues-desc":e.sort((s,i)=>{let l=i.issuesCount-s.issuesCount;if(l!==0)return l;let c=i.warningsCount-s.warningsCount;if(c!==0)return c;let o=s.file.split("/").pop()||"",r=i.file.split("/").pop()||"";return o.localeCompare(r)});break;case"issues-asc":e.sort((s,i)=>{let l=s.issuesCount-i.issuesCount;if(l!==0)return l;let c=s.warningsCount-i.warningsCount;if(c!==0)return c;let o=s.file.split("/").pop()||"",r=i.file.split("/").pop()||"";return o.localeCompare(r)});break;case"filename-asc":e.sort((s,i)=>{let l=s.file.split("/").pop()||"",c=i.file.split("/").pop()||"",o=l.localeCompare(c);return o!==0?o:s.file.localeCompare(i.file)});break;case"filename-desc":e.sort((s,i)=>{let l=s.file.split("/").pop()||"",o=(i.file.split("/").pop()||"").localeCompare(l);return o!==0?o:i.file.localeCompare(s.file)});break}return e}toggleChecksVisibility(){let n=this.container.querySelector(".seo-checks");if(!n)return;n.querySelectorAll(".seo-check-header").forEach(e=>{var c;let s=e,i=(c=s.parentElement)==null?void 0:c.querySelector(".seo-results"),l=s.querySelector(".seo-collapse-icon svg");i&&l&&(this.isCollapsed?(i.style.display="none",l.style.transform="rotate(-90deg)"):(i.style.display="block",l.style.transform="rotate(0deg)"))})}};var L=class extends U.ItemView{constructor(t,e="current",s){super(s||t.app.workspace.getLeaf());this.currentNoteResults=null;this.globalResults=[];this.panelType="current";this.hasRunInitialScan=!1;this.plugin=t,this.panelType=e,this.currentSort=t.settings.defaultSort,this.actions=new z(this.app,this.plugin,this.panelType),this.resultsDisplay=new j(this.containerEl,async i=>await this.actions.openFile(i),async i=>await this.actions.openFileAndAudit(i))}getViewType(){return this.panelType==="current"?F:I}getDisplayText(){return this.panelType==="current"?"SEO audit: current note":"SEO audit: vault"}getIcon(){return"search-check"}async onOpen(){try{this.panelType==="global"&&this.plugin.settings.cachedGlobalResults.length>0&&(this.globalResults=this.plugin.settings.cachedGlobalResults),this.forceIconRefresh(),this.panelType==="global"&&!this.hasRunInitialScan&&this.globalResults.length===0?(this.showLoadingState(),this.hasRunInitialScan=!0,await this.runInitialScan()):this.render()}catch(t){console.error("Error opening SEO panel:",t)}}async onClose(){}cleanup(){}async runInitialScan(){let t=await this.actions.runInitialScan();t.length>0&&(this.globalResults=t,this.render())}forceIconRefresh(){this.leaf&&this.leaf.setViewState({type:this.getViewType(),state:this.leaf.view.getState()}),setTimeout(()=>{let t=this.containerEl.querySelector(".view-header-icon");t&&(t.innerHTML="",t.setAttribute("data-icon","search-check"),t.setAttribute("data-icon",""),t.offsetHeight,t.setAttribute("data-icon","search-check"));let e=this.containerEl.querySelector(".view-header");e&&(e.style.display="none",e.offsetHeight,e.style.display=""),this.app.workspace.trigger("layout-change")},50)}async updateCurrentNoteResults(t){if(!(!t||!t.path.endsWith(".md")))try{let e=await this.app.vault.read(t);this.render()}catch(e){console.error("Error updating current note results:",e)}}async updateResults(t){this.globalResults=t,this.render()}showLoadingState(){let{containerEl:t}=this;t.empty(),t.addClass("seo-panel");let e=t.createEl("div",{cls:"seo-panel-header"});if(e.createEl("h2",{text:this.panelType==="current"?"SEO audit: current note":"SEO audit: vault"}),this.panelType==="global"){let l=Q(this.plugin.settings.scanDirectories),c=e.createEl("div",{cls:"seo-filename"});c.textContent=l}let s=t.createEl("div",{cls:"seo-loading-container"}),i=s.createEl("div",{cls:"seo-loading-spinner"});(0,U.setIcon)(i,"loader-circle"),s.createEl("h3",{text:"Running SEO audit...",cls:"seo-loading-title"}),s.createEl("p",{text:"This may take a moment for large vaults. Please wait...",cls:"seo-loading-message"})}refresh(){this.render()}render(){var t;try{let{containerEl:e}=this;e.empty(),e.addClass("seo-panel");let s=e.createEl("div",{cls:"seo-panel-header"});if(s.createEl("h2",{text:this.panelType==="current"?"SEO audit: current note":"SEO audit: vault"}),this.panelType==="current"){let i=this.app.workspace.getActiveFile();if(i&&i.path.endsWith(".md")){let l=s.createEl("div",{cls:"seo-filename"}),c=((t=this.currentNoteResults)==null?void 0:t.displayName)||i.path;l.textContent=`Target note: ${c}`}}else{let i=this.globalResults.length,l=Q(this.plugin.settings.scanDirectories,i),c=s.createEl("div",{cls:"seo-filename"});c.textContent=l}if(this.panelType==="current"){let i=e.createEl("button",{text:"Audit current note",cls:"mod-cta seo-btn seo-top-btn"});if(i.addEventListener("click",async()=>{let l=i.textContent;i.disabled=!0,i.style.opacity="0.7";try{let c=await this.actions.checkCurrentNote();c&&(this.currentNoteResults=c,this.updateGlobalResultsIfExists(c),this.render())}finally{i.disabled=!1,i.style.opacity="1"}}),this.plugin.settings.enableExternalLinkButton&&!this.plugin.settings.enableExternalLinkVaultCheck){let l=e.createEl("button",{text:"Check external links for 404s",cls:"seo-btn"});l.addEventListener("click",async()=>{l.disabled=!0,l.textContent="This may take some time...",l.style.opacity="0.7";try{let c=await this.actions.checkExternalLinks();c&&(this.currentNoteResults=c,this.updateGlobalResultsIfExists(c),this.render())}finally{l.disabled=!1,l.textContent="Check external links for 404s",l.style.opacity="1"}})}}this.panelType==="current"?this.currentNoteResults?this.resultsDisplay.renderResults(this.currentNoteResults):e.createEl("div",{cls:"seo-no-results"}).createEl("p",{text:'Open a markdown file and click "Audit current note" to audit it.'}):this.globalResults.length>0?this.renderGlobalResults(e):e.createEl("div",{cls:"seo-no-results"}).createEl("p",{text:'Click "Audit all notes" to audit your files in your configured directories.'})}catch(e){console.error("Error rendering SEO panel:",e),this.containerEl.createEl("div",{text:"Error loading SEO panel. Please try again."})}}updateGlobalResultsIfExists(t){if(this.plugin.settings.cachedGlobalResults&&this.plugin.settings.cachedGlobalResults.length>0){let e=this.plugin.settings.cachedGlobalResults,s=e.findIndex(i=>i.file===t.file);s!==-1?e[s]=t:e.push(t),this.plugin.saveSettings(),this.updateGlobalPanelIfOpen()}}updateGlobalPanelIfOpen(){let t=this.app.workspace.getLeavesOfType("seo-global-panel");if(t.length>0){let e=t[0];if(e!=null&&e.view){let s=e.view;s.globalResults=[...this.plugin.settings.cachedGlobalResults],s.render()}}}renderGlobalResults(t){this.resultsDisplay.renderGlobalResults(this.globalResults,this.plugin.settings);let e=t.createEl("button",{text:"Refresh",cls:"mod-cta seo-btn seo-refresh-btn"});e.addEventListener("click",async()=>{e.textContent="Refreshing...",e.disabled=!0;try{let s=await this.actions.refreshGlobalResults();s.length>0&&(this.globalResults=s,this.render())}finally{e.textContent="Refresh",e.disabled=!1}}),this.resultsDisplay.renderIssuesList(this.globalResults,this.currentSort,s=>{this.currentSort=s,this.plugin.settings.defaultSort=s,this.plugin.saveSettings()},s=>{let i=this.plugin.settings.checkPotentiallyBrokenLinks&&this.plugin.settings.checkPotentiallyBrokenEmbeds,l=this.globalResults.filter(c=>{let o=c.issuesCount>0,r=c.warningsCount>0,u=i&&c.noticesCount>0;return o||r||u});this.actions.showSortMenu(s,l,t,this.currentSort,c=>{this.currentSort=c,this.plugin.settings.defaultSort=c,this.plugin.saveSettings()},this.plugin.settings)},this.plugin.settings)}};var Be=require("obsidian");var q=class{constructor(n,t){this.app=n;this.plugin=t}openCurrentPanel(){this.openPanel(F,"current")}openGlobalPanel(){this.openPanel(I,"global")}openPanel(n,t){let e=this.app.workspace.getLeavesOfType(n)[0];if(e)this.app.workspace.revealLeaf(e),this.app.workspace.setActiveLeaf(e),e.view instanceof L&&(this.plugin.sidePanel=e.view),e.view instanceof L&&setTimeout(()=>e.view.forceIconRefresh(),100);else{let s=this.app.workspace.getRightLeaf(!1);if(s){let i=new L(this.plugin,t,s);this.plugin.sidePanel=i,s.open(i),this.app.workspace.setActiveLeaf(s),setTimeout(()=>{s.view instanceof L&&s.view.forceIconRefresh()},100)}}}async getFilesToCheck(){let{vault:n}=this.app,{scanDirectories:t}=this.plugin.settings;if(!t.trim())return n.getMarkdownFiles();let e=t.split(",").map(i=>i.trim()),s=[];for(let i of e){let l=n.getAbstractFileByPath(i);l&&l instanceof Be.TFolder&&s.push(...n.getMarkdownFiles().filter(c=>c.path.startsWith(i+"/")||c.path===i))}return s}};var K=class{constructor(n,t){this.app=n;this.plugin=t;this.timeoutId=null}registerRealTimeChecking(){this.plugin.registerEvent(this.app.workspace.on("editor-change",()=>{this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.checkCurrentNote()},2e3)}))}async checkCurrentNote(){let n=this.app.workspace.getActiveFile();if(!(!n||!n.path.endsWith(".md")))try{let{runSEOCheck:t}=await Promise.resolve().then(()=>(R(),O)),e=await t(this.plugin,[n])}catch(t){console.error("Error checking current note:",t)}}async runBulkCheck(){let{runSEOCheck:n}=await Promise.resolve().then(()=>(R(),O)),t=await this.plugin.getFilesToCheck();if(t.length!==0)try{let e=await n(this.plugin,t)}catch(e){console.error("Error running bulk check:",e)}}};var Ve=require("obsidian");var _=class extends Error{constructor(t,e="error",s,i){super(t);this.name="SEOPluginError",this.severity=e,this.userMessage=s||t,this.suggestion=i}};function T(a,n,t=!0){let e,s="error",i;if(a instanceof _?(e=a.userMessage,s=a.severity,i=a.suggestion):a instanceof Error?(e=a.message,s="error",i="Please try again or check the plugin settings"):(e="An unexpected error occurred",s="critical",i="Please restart Obsidian and try again"),console.error(`[SEO Plugin] Error in ${n}:`,a),t){let l=i?`${e} - ${i}`:e;new Ve.Notice(l,5e3)}return{message:e,severity:s,suggestion:i}}async function A(a,n,t){try{return await a()}catch(e){return T(e,n,!0),t}}function Ge(a,n){let t=Object.entries(a).filter(([e,s])=>s==null).map(([e])=>e);if(t.length>0)throw new _(`Missing required parameters: ${t.join(", ")}`,"error",`Missing required parameters: ${t.join(", ")}`,"Please check your plugin configuration")}var Z=class{constructor(n={}){this.cache=new Map;this.cleanupTimer=null;this.config={maxSize:n.maxSize||100,maxAge:n.maxAge||30*60*1e3,cleanupInterval:n.cleanupInterval||5*60*1e3},this.startCleanupTimer()}get(n){let t=this.cache.get(n);if(t){if(this.isExpired(t)){this.cache.delete(n);return}return t.accessCount++,t.lastAccessed=Date.now(),t.value}}set(n,t){this.cache.has(n)&&this.cache.delete(n),this.cache.size>=this.config.maxSize&&this.evictLRU(),this.cache.set(n,{value:t,timestamp:Date.now(),accessCount:1,lastAccessed:Date.now()})}has(n){let t=this.cache.get(n);return t?this.isExpired(t)?(this.cache.delete(n),!1):!0:!1}delete(n){return this.cache.delete(n)}clear(){this.cache.clear()}getStats(){let n=Date.now(),t=Array.from(this.cache.values());return{size:this.cache.size,maxSize:this.config.maxSize,hitRate:this.calculateHitRate(),oldestEntry:Math.min(...t.map(e=>e.timestamp)),newestEntry:Math.max(...t.map(e=>e.timestamp)),expiredEntries:t.filter(e=>this.isExpired(e)).length}}cleanup(){let n=Date.now(),t=[];for(let[e,s]of this.cache.entries())this.isExpired(s)&&t.push(e);t.forEach(e=>this.cache.delete(e))}destroy(){this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null),this.clear()}isExpired(n){return Date.now()-n.timestamp>this.config.maxAge}evictLRU(){let n="",t=Date.now();for(let[e,s]of this.cache.entries())s.lastAccessed<t&&(t=s.lastAccessed,n=e);n&&this.cache.delete(n)}calculateHitRate(){let n=Array.from(this.cache.values()),t=n.reduce((e,s)=>e+s.accessCount,0);return t>0?n.length/t:0}startCleanupTimer(){this.cleanupTimer=setInterval(()=>{this.cleanup()},this.config.cleanupInterval)}},we=class{constructor(){this.resultsCache=new Z({maxSize:50,maxAge:60*60*1e3,cleanupInterval:10*60*1e3}),this.fileCache=new Z({maxSize:200,maxAge:30*60*1e3,cleanupInterval:5*60*1e3})}getResults(n){return this.resultsCache.get(n)}setResults(n,t){this.resultsCache.set(n,t)}getFileContent(n){return this.fileCache.get(n)}setFileContent(n,t){this.fileCache.set(n,t)}clearAll(){this.resultsCache.clear(),this.fileCache.clear()}getStats(){return{results:this.resultsCache.getStats(),files:this.fileCache.getStats()}}cleanup(){this.resultsCache.cleanup(),this.fileCache.cleanup()}destroy(){this.resultsCache.destroy(),this.fileCache.destroy()}},Ce=new we;function We(){Ce.clearAll()}var J=class extends ze.Plugin{constructor(){super(...arguments);this.sidePanel=null}async onload(){try{await this.loadSettings(),Ge({app:this.app,settings:this.settings},"plugin initialization"),this.panelManager=await A(()=>Promise.resolve(new q(this.app,this)),"panel manager initialization",null),this.realTimeChecker=await A(()=>Promise.resolve(new K(this.app,this)),"real-time checker initialization",null),this.forceIconRefresh(),await A(async()=>{this.registerView(F,t=>{let e=new L(this,"current",t);return this.sidePanel=e,e}),this.registerView(I,t=>{let e=new L(this,"global",t);return this.sidePanel=e,e})},"side panel registration",void 0),await A(async()=>{Se(this)},"command registration",void 0),await A(async()=>{this.addSettingTab(new W(this.app,this))},"settings tab registration",void 0),await A(async()=>{this.realTimeChecker&&this.realTimeChecker.registerRealTimeChecking()},"real-time checking registration",void 0),await A(async()=>{this.addRibbonIcon("search-check","Open SEO audit panel",async()=>{try{let e=this.app.workspace.getLeavesOfType("seo-global-panel").length===0;this.openGlobalPanel(),e||setTimeout(async()=>{try{let s=this.app.workspace.getLeavesOfType("seo-global-panel");if(s.length>0){let i=s[0];if(i!=null&&i.view){let l=i.view;await l.actions.refreshGlobalResults(),l.render()}}}catch(s){T(s,"ribbon icon panel refresh",!0)}},500)}catch(t){T(t,"ribbon icon click handler",!0)}})},"ribbon icon registration",void 0)}catch(t){T(t,"plugin initialization",!0)}}onunload(){try{Ce.destroy()}catch(t){T(t,"plugin unload",!1)}}async loadSettings(){try{this.settings=Object.assign({},Y,await this.loadData())}catch(t){T(t,"loading settings",!0),this.settings={...Y}}}async saveSettings(){try{await this.saveData(this.settings),We()}catch(t){T(t,"saving settings",!0)}}addStatusBar(){}removeStatusBar(){}openCurrentPanel(){try{if(this.panelManager)this.panelManager.openCurrentPanel();else throw new Error("Panel manager not initialized")}catch(t){T(t,"opening current panel",!0)}}openGlobalPanel(){try{if(this.panelManager)this.panelManager.openGlobalPanel();else throw new Error("Panel manager not initialized")}catch(t){T(t,"opening global panel",!0)}}async runBulkCheck(){try{if(this.realTimeChecker)await this.realTimeChecker.runBulkCheck();else throw new Error("Real-time checker not initialized")}catch(t){T(t,"running bulk check",!0)}}async getFilesToCheck(){try{if(this.panelManager)return await this.panelManager.getFilesToCheck();throw new Error("Panel manager not initialized")}catch(t){return T(t,"getting files to check",!0),[]}}forceIconRefresh(){this.app.workspace.onLayoutReady(()=>{let t=this.app.workspace.getLeavesOfType(F),e=this.app.workspace.getLeavesOfType(I);[...t,...e].forEach(s=>{s.view instanceof L&&s.view.render()})})}};
