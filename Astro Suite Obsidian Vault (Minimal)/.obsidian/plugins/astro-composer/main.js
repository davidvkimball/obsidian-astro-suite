/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => AstroComposerPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian7 = require("obsidian");

// src/types.ts
var KNOWN_ARRAY_KEYS = ["tags", "aliases", "cssclasses"];
var CONSTANTS = {
  DEBOUNCE_MS: 500,
  STAT_MTIME_THRESHOLD: 1e3,
  EDITOR_STABILIZE_DELAY: 100,
  FILE_EXPLORER_REVEAL_DELAY: 200
};

// src/settings.ts
var DEFAULT_SETTINGS = {
  enableUnderscorePrefix: false,
  defaultTemplate: '---\ntitle: "{{title}}"\ndate: {{date}}\ntags: []\n---\n',
  postsFolder: "posts",
  postsLinkBasePath: "blog/",
  automatePostCreation: true,
  autoInsertProperties: true,
  creationMode: "file",
  indexFileName: "",
  dateFormat: "YYYY-MM-DD",
  excludedDirectories: "",
  onlyAutomateInPostsFolder: false,
  enablePages: false,
  pagesFolder: "pages",
  pagesLinkBasePath: "",
  pagesCreationMode: "file",
  pagesIndexFileName: "",
  pageTemplate: '---\ntitle: "{{title}}"\ndescription: ""\n---\n',
  enableCopyHeadingLink: true,
  copyHeadingLinkFormat: "obsidian",
  addTrailingSlashToLinks: false,
  customContentTypes: []
};

// src/commands/index.ts
var import_obsidian5 = require("obsidian");

// src/utils/file-operations.ts
var import_obsidian = require("obsidian");
var FileOperations = class {
  constructor(app, settings, plugin) {
    this.app = app;
    this.settings = settings;
    this.plugin = plugin;
  }
  toKebabCase(str) {
    return str.toLowerCase().replace(/[^a-z0-9\s-]/g, "").trim().replace(/\s+/g, "-").replace(/-+/g, "-").replace(/^-|-$/g, "");
  }
  generateFilename(title) {
    const kebabTitle = this.toKebabCase(title);
    const prefix = this.settings.enableUnderscorePrefix ? "_" : "";
    return `${prefix}${kebabTitle}`;
  }
  determineType(file) {
    const filePath = file.path;
    for (const customType of this.settings.customContentTypes) {
      if (customType.enabled && customType.folder && (filePath.startsWith(customType.folder + "/") || filePath === customType.folder)) {
        return customType.id;
      }
    }
    const pagesFolder = this.settings.pagesFolder || "";
    let isPage = false;
    if (this.settings.enablePages) {
      if (pagesFolder) {
        isPage = filePath.startsWith(pagesFolder + "/") || filePath === pagesFolder;
      } else {
        isPage = !filePath.includes("/");
      }
    }
    if (isPage)
      return "page";
    const postsFolder = this.settings.postsFolder || "";
    let isPost = false;
    if (this.settings.automatePostCreation) {
      if (postsFolder) {
        isPost = filePath.startsWith(postsFolder + "/") || filePath === postsFolder;
      } else {
        isPost = !filePath.includes("/");
      }
    }
    if (isPost)
      return "post";
    return "note";
  }
  getCustomContentType(typeId) {
    return this.settings.customContentTypes.find((ct) => ct.id === typeId) || null;
  }
  isCustomContentType(type) {
    return type !== "post" && type !== "page";
  }
  getTitleKey(type) {
    if (type === "note")
      return "title";
    let template;
    if (this.isCustomContentType(type)) {
      const customType = this.getCustomContentType(type);
      if (!customType)
        return "title";
      template = customType.template;
    } else {
      template = type === "post" ? this.settings.defaultTemplate : this.settings.pageTemplate;
    }
    const lines = template.split("\n");
    let inProperties = false;
    for (const line of lines) {
      const trimmed = line.trim();
      if (trimmed === "---") {
        inProperties = !inProperties;
        continue;
      }
      if (inProperties) {
        const match = trimmed.match(/^(\w+):\s*(.+)$/);
        if (match) {
          const key = match[1];
          const value = match[2];
          if (value.includes("{{title}}")) {
            return key;
          }
        }
      }
    }
    return "title";
  }
  async createFile(options) {
    var _a, _b;
    const { file, title, type } = options;
    if (!title) {
      new import_obsidian.Notice(`Title is required to create a ${type}.`);
      return null;
    }
    const kebabTitle = this.toKebabCase(title);
    const prefix = this.settings.enableUnderscorePrefix ? "_" : "";
    let targetFolder = "";
    if (type === "note") {
      targetFolder = "";
    } else if (this.isCustomContentType(type)) {
      const customType = this.getCustomContentType(type);
      const originalDir = ((_a = file.parent) == null ? void 0 : _a.path) || "";
      if (originalDir === "" || originalDir === "/") {
        targetFolder = customType ? customType.folder : "";
      } else {
        targetFolder = originalDir;
      }
    } else {
      const postsFolder = this.settings.postsFolder || "";
      const pagesFolder = this.settings.pagesFolder || "";
      const originalDir = ((_b = file.parent) == null ? void 0 : _b.path) || "";
      if (originalDir === "" || originalDir === "/") {
        targetFolder = "";
      } else {
        targetFolder = originalDir;
      }
    }
    if (targetFolder) {
      const folder = this.app.vault.getAbstractFileByPath(targetFolder);
      if (!(folder instanceof import_obsidian.TFolder)) {
        await this.app.vault.createFolder(targetFolder);
      }
    }
    if (this.settings.creationMode === "folder") {
      return this.createFolderStructure(file, kebabTitle, prefix, targetFolder, type);
    } else {
      return this.createFileStructure(file, kebabTitle, prefix, targetFolder);
    }
  }
  async createFolderStructure(file, kebabTitle, prefix, targetFolder, type) {
    const folderName = `${prefix}${kebabTitle}`;
    let folderPath;
    if (targetFolder) {
      folderPath = `${targetFolder}/${folderName}`;
    } else {
      const currentDir = file.parent ? file.parent.path : "";
      if (currentDir && currentDir !== "/") {
        folderPath = `${currentDir}/${folderName}`;
      } else {
        folderPath = folderName;
      }
    }
    try {
      const folder = this.app.vault.getAbstractFileByPath(folderPath);
      if (!(folder instanceof import_obsidian.TFolder)) {
        await this.app.vault.createFolder(folderPath);
      }
    } catch (error) {
    }
    const indexFileName = this.settings.indexFileName || "index";
    const fileName = `${indexFileName}.md`;
    const newPath = `${folderPath}/${fileName}`;
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile) {
      new import_obsidian.Notice(`File already exists at ${newPath}.`);
      return null;
    }
    try {
      await this.app.vault.rename(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        return null;
      }
      setTimeout(() => {
        const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
        if (fileExplorer && fileExplorer.view) {
          const fileTree = fileExplorer.view.tree;
          if (fileTree && newFile instanceof import_obsidian.TFile && typeof fileTree.revealFile === "function") {
            fileTree.revealFile(newFile);
          }
        }
      }, 200);
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(newFile);
      return newFile;
    } catch (error) {
      new import_obsidian.Notice(`Failed to create folder structure: ${error.message}.`);
      return null;
    }
  }
  async createFileStructure(file, kebabTitle, prefix, targetFolder) {
    const newName = `${prefix}${kebabTitle}.md`;
    let newPath;
    if (targetFolder) {
      newPath = `${targetFolder}/${newName}`;
    } else {
      const currentDir = file.parent ? file.parent.path : "";
      if (currentDir && currentDir !== "/") {
        newPath = `${currentDir}/${newName}`;
      } else {
        newPath = newName;
      }
    }
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
      new import_obsidian.Notice(`File with name "${newName}" already exists.`);
      return null;
    }
    try {
      await this.app.vault.rename(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        return null;
      }
      if (this.plugin && "pluginCreatedFiles" in this.plugin) {
        this.plugin.pluginCreatedFiles.add(newPath);
      }
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(newFile);
      return newFile;
    } catch (error) {
      new import_obsidian.Notice(`Failed to rename file: ${error.message}.`);
      return null;
    }
  }
  async renameFile(options) {
    const { file, title, type } = options;
    if (!title) {
      new import_obsidian.Notice(`Title is required to rename the content.`);
      return null;
    }
    const kebabTitle = this.toKebabCase(title);
    const prefix = "";
    if (this.settings.creationMode === "folder") {
      return this.renameFolderStructure(file, kebabTitle, prefix, type);
    } else {
      return this.renameFileStructure(file, kebabTitle, prefix);
    }
  }
  async renameFolderStructure(file, kebabTitle, prefix, type) {
    const indexFileName = this.settings.indexFileName || "index";
    const isIndex = file.basename === indexFileName;
    if (isIndex) {
      if (!file.parent) {
        new import_obsidian.Notice("Cannot rename: File has no parent folder.");
        return null;
      }
      prefix = file.parent.name.startsWith("_") ? "_" : "";
      const newFolderName = `${prefix}${kebabTitle}`;
      const parentFolder = file.parent.parent;
      if (!parentFolder) {
        new import_obsidian.Notice("Cannot rename: Parent folder has no parent.");
        return null;
      }
      const newFolderPath = `${parentFolder.path}/${newFolderName}`;
      const existingFolder = this.app.vault.getAbstractFileByPath(newFolderPath);
      if (existingFolder instanceof import_obsidian.TFolder) {
        new import_obsidian.Notice(`Folder already exists at ${newFolderPath}.`);
        return null;
      }
      await this.app.vault.rename(file.parent, newFolderPath);
      const newFilePath = `${newFolderPath}/${file.name}`;
      const newFile = this.app.vault.getAbstractFileByPath(newFilePath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile;
    } else {
      if (!file.parent) {
        new import_obsidian.Notice("Cannot rename: File has no parent folder.");
        return null;
      }
      prefix = file.basename.startsWith("_") ? "_" : "";
      const newName = `${prefix}${kebabTitle}.md`;
      const newPath = `${file.parent.path}/${newName}`;
      const existingFile = this.app.vault.getAbstractFileByPath(newPath);
      if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
        new import_obsidian.Notice(`File already exists at ${newPath}.`);
        return null;
      }
      await this.app.vault.rename(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile;
    }
  }
  async renameFileStructure(file, kebabTitle, prefix) {
    if (!file.parent) {
      new import_obsidian.Notice("Cannot rename: File has no parent folder.");
      return null;
    }
    const isIndex = this.settings.indexFileName && this.settings.indexFileName.trim() !== "" && file.basename === this.settings.indexFileName;
    if (isIndex) {
      prefix = file.parent.name.startsWith("_") ? "_" : "";
      const newFolderName = `${prefix}${kebabTitle}`;
      const parentFolder = file.parent.parent;
      if (!parentFolder) {
        new import_obsidian.Notice("Cannot rename: Parent folder has no parent.");
        return null;
      }
      const newFolderPath = `${parentFolder.path}/${newFolderName}`;
      const existingFolder = this.app.vault.getAbstractFileByPath(newFolderPath);
      if (existingFolder instanceof import_obsidian.TFolder) {
        new import_obsidian.Notice(`Folder already exists at ${newFolderPath}.`);
        return null;
      }
      await this.app.vault.rename(file.parent, newFolderPath);
      const newFilePath = `${newFolderPath}/${file.name}`;
      const newFile2 = this.app.vault.getAbstractFileByPath(newFilePath);
      if (!(newFile2 instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile2;
    }
    prefix = file.basename.startsWith("_") ? "_" : "";
    const newName = `${prefix}${kebabTitle}.md`;
    const newPath = `${file.parent.path}/${newName}`;
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
      new import_obsidian.Notice(`File already exists at ${newPath}.`);
      return null;
    }
    await this.app.vault.rename(file, newPath);
    const newFile = this.app.vault.getAbstractFileByPath(newPath);
    if (!(newFile instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice("Failed to locate renamed file.");
      return null;
    }
    return newFile;
  }
};

// src/utils/template-parsing.ts
var import_obsidian2 = require("obsidian");
var TemplateParser = class {
  constructor(app, settings) {
    this.app = app;
    this.settings = settings;
  }
  async parseFrontmatter(content) {
    let propertiesEnd = 0;
    let propertiesText = "";
    const existingProperties = {};
    if (content.startsWith("---")) {
      propertiesEnd = content.indexOf("\n---", 3);
      if (propertiesEnd === -1) {
        propertiesEnd = content.length;
      } else {
        propertiesEnd += 4;
      }
      propertiesText = content.slice(4, propertiesEnd - 4).trim();
      try {
        let currentKey = null;
        const arrayKeys = /* @__PURE__ */ new Set();
        propertiesText.split("\n").forEach((line) => {
          const trimmedLine = line.trim();
          const match = trimmedLine.match(/^([a-zA-Z_][a-zA-Z0-9_-]*):\s*(.*)$/);
          if (match) {
            const [, key, value] = match;
            currentKey = key;
            const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
            const isEmptyArray = !value || value.trim() === "" || value.trim() === "[]";
            const isArrayProperty = isKnownArrayKey || isEmptyArray;
            if (isArrayProperty) {
              existingProperties[key] = [];
              arrayKeys.add(key);
            } else {
              existingProperties[key] = [value ? value.trim() : ""];
            }
          } else if (currentKey && trimmedLine.startsWith("- ")) {
            const isArrayProperty = arrayKeys.has(currentKey);
            if (isArrayProperty) {
              const item = trimmedLine.replace(/^-\s*/, "");
              if (item)
                existingProperties[currentKey].push(item);
            }
          } else if (trimmedLine && !trimmedLine.startsWith("- ") && !trimmedLine.startsWith("#")) {
            const keyMatch = trimmedLine.match(/^([^:]+):\s*(.*)$/);
            if (keyMatch) {
              const [, key, value] = keyMatch;
              if (!existingProperties[key]) {
                existingProperties[key] = [value ? value.trim() : ""];
              }
            }
          }
        });
        KNOWN_ARRAY_KEYS.forEach((key) => {
          if (propertiesText.includes(key + ":") && !existingProperties[key]) {
            existingProperties[key] = [];
          }
        });
      } catch (error) {
        new import_obsidian2.Notice("Falling back to template due to parsing error.");
      }
    }
    const bodyContent = content.slice(propertiesEnd);
    return {
      properties: existingProperties,
      propertiesText,
      propertiesEnd,
      bodyContent
    };
  }
  parseTemplate(templateString, title) {
    const templateLines = templateString.split("\n");
    const templateProps = [];
    const templateValues = {};
    let inProperties = false;
    for (let i = 0; i < templateLines.length; i++) {
      const line = templateLines[i].trim();
      if (line === "---") {
        inProperties = !inProperties;
        if (!inProperties) {
          break;
        }
        continue;
      }
      if (inProperties) {
        const match = line.match(/^(\w+):\s*(.*)$/);
        if (match) {
          const [, key, value] = match;
          templateProps.push(key);
          const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
          const isEmptyArray = !value || value.trim() === "" || value.trim() === "[]";
          const isArrayProperty = isKnownArrayKey || isEmptyArray;
          if (isArrayProperty) {
            if (value && value.startsWith("[")) {
              const items = value.replace(/[[\]]/g, "").split(",").map((t) => t.trim()).filter((t) => t);
              templateValues[key] = items;
            } else {
              templateValues[key] = [];
              for (let j = i + 1; j < templateLines.length; j++) {
                const nextLine = templateLines[j].trim();
                if (nextLine.startsWith("- ")) {
                  const item = nextLine.replace(/^-\s*/, "").trim();
                  if (item)
                    templateValues[key].push(item);
                } else if (nextLine === "---" || nextLine && !nextLine.startsWith("- ") && nextLine.includes(":")) {
                  break;
                }
              }
            }
          } else {
            const stringValue = (value || "").replace(/\{\{title\}\}/g, title).replace(/\{\{date\}\}/g, window.moment(new Date()).format(this.settings.dateFormat));
            templateValues[key] = stringValue;
          }
        }
      }
    }
    return { templateProps, templateValues };
  }
  buildFrontmatterContent(finalProps, arrayKeys) {
    let newContent = "---\n";
    for (const key in finalProps) {
      const isArrayProperty = KNOWN_ARRAY_KEYS.includes(key) || arrayKeys && arrayKeys.has(key);
      if (isArrayProperty) {
        newContent += `${key}:
`;
        if (finalProps[key].length > 0) {
          finalProps[key].forEach((item) => {
            newContent += `  - ${item}
`;
          });
        }
      } else {
        newContent += `${key}: ${finalProps[key][0] || ""}
`;
      }
    }
    newContent += "---";
    return newContent;
  }
  async updateTitleInFrontmatter(file, newTitle, type) {
    const titleKey = this.getTitleKey(type);
    const content = await this.app.vault.read(file);
    let propertiesEnd = 0;
    let propertiesText = "";
    if (content.startsWith("---")) {
      propertiesEnd = content.indexOf("\n---", 3);
      if (propertiesEnd === -1) {
        propertiesEnd = content.length;
      } else {
        propertiesEnd += 4;
      }
      propertiesText = content.slice(4, propertiesEnd - 4).trim();
    }
    const propOrder = [];
    const existing = {};
    let currentKey = null;
    let titleKeyPosition = -1;
    const arrayKeys = /* @__PURE__ */ new Set();
    propertiesText.split("\n").forEach((line, index) => {
      const trimmedLine = line.trim();
      const match = trimmedLine.match(/^([a-zA-Z_][a-zA-Z0-9_-]*):\s*(.*)$/);
      if (match) {
        const [, key, value] = match;
        propOrder.push(key);
        currentKey = key;
        if (key === titleKey) {
          titleKeyPosition = index;
        }
        const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
        const isEmptyArray = !value || value.trim() === "" || value.trim() === "[]";
        const isArrayProperty = isKnownArrayKey || isEmptyArray;
        if (isArrayProperty) {
          existing[key] = [];
          arrayKeys.add(key);
        } else {
          existing[key] = value ? value.trim() : "";
        }
      } else if (currentKey && arrayKeys.has(currentKey) && trimmedLine.startsWith("- ")) {
        const item = trimmedLine.replace(/^-\s*/, "");
        if (item)
          existing[currentKey].push(item);
      } else if (trimmedLine && !trimmedLine.startsWith("- ") && !trimmedLine.startsWith("#")) {
        const keyMatch = trimmedLine.match(/^([^:]+):\s*(.*)$/);
        if (keyMatch) {
          const [, key, value] = keyMatch;
          if (!propOrder.includes(key)) {
            propOrder.push(key);
            existing[key] = value ? value.trim() : "";
          }
        }
      }
    });
    const escapedTitle = newTitle.replace(/"/g, '\\"');
    const titleVal = newTitle.includes(" ") || newTitle.includes('"') ? `"${escapedTitle}"` : newTitle;
    existing[titleKey] = titleVal;
    if (titleKeyPosition === -1) {
      propOrder.push(titleKey);
    }
    let newContent = "---\n";
    for (const key of propOrder) {
      const val = existing[key];
      if (Array.isArray(val)) {
        newContent += `${key}:
`;
        if (val.length > 0) {
          val.forEach((item) => {
            newContent += `  - ${item}
`;
          });
        }
      } else {
        newContent += `${key}: ${val || ""}
`;
      }
    }
    newContent += "---";
    const bodyContent = content.slice(propertiesEnd);
    newContent += bodyContent;
    await this.app.vault.modify(file, newContent);
  }
  getTitleKey(type) {
    let template;
    if (this.isCustomContentType(type)) {
      const customType = this.getCustomContentType(type);
      if (!customType)
        return "title";
      template = customType.template;
    } else {
      template = type === "post" ? this.settings.defaultTemplate : this.settings.pageTemplate;
    }
    const lines = template.split("\n");
    let inProperties = false;
    for (const line of lines) {
      const trimmed = line.trim();
      if (trimmed === "---") {
        inProperties = !inProperties;
        continue;
      }
      if (inProperties) {
        const match = trimmed.match(/^(\w+):\s*(.+)$/);
        if (match) {
          const key = match[1];
          const value = match[2];
          if (value.includes("{{title}}")) {
            return key;
          }
        }
      }
    }
    return "title";
  }
  isCustomContentType(type) {
    return type !== "post" && type !== "page";
  }
  getCustomContentType(typeId) {
    return this.settings.customContentTypes.find((ct) => ct.id === typeId) || null;
  }
};

// src/utils/link-conversion.ts
var import_obsidian3 = require("obsidian");
var LinkConverter = class {
  constructor(settings) {
    this.settings = settings;
  }
  toKebabCase(str) {
    return str.toLowerCase().replace(/[^a-z0-9\s-]/g, "").trim().replace(/\s+/g, "-").replace(/-+/g, "-").replace(/^-|-$/g, "");
  }
  getAstroUrlFromInternalLink(link) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = decodeURIComponent(path);
    path = path.replace(/\.md$/, "");
    let basePath = "";
    let contentFolder = "";
    let creationMode = "file";
    let indexFileName = "";
    let foundCustomType = false;
    for (const customType of this.settings.customContentTypes) {
      if (customType.enabled && customType.folder && path.startsWith(customType.folder + "/")) {
        contentFolder = customType.folder;
        basePath = customType.linkBasePath || "";
        creationMode = customType.creationMode;
        indexFileName = customType.indexFileName;
        foundCustomType = true;
        break;
      }
    }
    if (!foundCustomType && this.settings.enablePages && this.settings.pagesFolder && path.startsWith(this.settings.pagesFolder + "/")) {
      contentFolder = this.settings.pagesFolder;
      basePath = this.settings.pagesLinkBasePath;
      creationMode = this.settings.pagesCreationMode || "file";
      indexFileName = this.settings.pagesIndexFileName || "";
    } else if (!foundCustomType && this.settings.postsFolder && path.startsWith(this.settings.postsFolder + "/")) {
      contentFolder = this.settings.postsFolder;
      basePath = this.settings.postsLinkBasePath;
      creationMode = this.settings.creationMode;
      indexFileName = this.settings.indexFileName || "index";
    } else if (!foundCustomType && !this.settings.postsFolder && !this.settings.onlyAutomateInPostsFolder) {
      if (!path.includes("/") || path.includes("/") && !path.startsWith("/") && path.split("/").length === 2) {
        let shouldExcludeFromPosts = false;
        if (this.settings.enablePages && this.settings.pagesFolder && path.startsWith(this.settings.pagesFolder + "/")) {
          shouldExcludeFromPosts = true;
        }
        if (this.settings.excludedDirectories) {
          const excludedDirs = this.settings.excludedDirectories.split("|").map((dir) => dir.trim()).filter((dir) => dir);
          for (const excludedDir of excludedDirs) {
            if (path.startsWith(excludedDir + "/") || path === excludedDir) {
              shouldExcludeFromPosts = true;
              break;
            }
          }
        }
        if (!shouldExcludeFromPosts) {
          basePath = this.settings.postsLinkBasePath;
          creationMode = this.settings.creationMode;
          indexFileName = this.settings.indexFileName || "index";
        }
      }
    }
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    const parts = path.split("/");
    const lastPart = parts[parts.length - 1];
    if (indexFileName && indexFileName.trim() !== "" && lastPart === indexFileName) {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    } else if ((!indexFileName || indexFileName.trim() === "") && lastPart === "index") {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    }
    const slugParts = path.split("/").map((part) => this.toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) {
        basePath = "/" + basePath;
      }
      if (!basePath.endsWith("/")) {
        basePath += "/";
      }
    } else {
      basePath = "/";
    }
    const shouldAddTrailingSlash = this.settings.addTrailingSlashToLinks || addTrailingSlash;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  getAstroUrlFromInternalLinkWithContext(link, currentFilePath, currentFileContentType) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = decodeURIComponent(path);
    path = path.replace(/\.md$/, "");
    let basePath = "";
    let contentFolder = "";
    let creationMode = "file";
    let indexFileName = "";
    const targetContentType = this.getContentTypeForPath(path + ".md");
    if (!targetContentType.basePath && currentFileContentType.basePath) {
      basePath = currentFileContentType.basePath;
      creationMode = currentFileContentType.creationMode;
      indexFileName = currentFileContentType.indexFileName;
    } else {
      basePath = targetContentType.basePath;
      creationMode = targetContentType.creationMode;
      indexFileName = targetContentType.indexFileName;
    }
    const targetPath = path + ".md";
    for (const customType of this.settings.customContentTypes) {
      if (customType.enabled && customType.folder && targetPath.startsWith(customType.folder + "/")) {
        contentFolder = customType.folder;
        break;
      }
    }
    if (!contentFolder && this.settings.enablePages && this.settings.pagesFolder && targetPath.startsWith(this.settings.pagesFolder + "/")) {
      contentFolder = this.settings.pagesFolder;
    }
    if (!contentFolder && this.settings.postsFolder && targetPath.startsWith(this.settings.postsFolder + "/")) {
      contentFolder = this.settings.postsFolder;
    }
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    const parts = path.split("/");
    const lastPart = parts[parts.length - 1];
    if (indexFileName && indexFileName.trim() !== "" && lastPart === indexFileName) {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    } else if ((!indexFileName || indexFileName.trim() === "") && lastPart === "index") {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    }
    const slugParts = path.split("/").map((part) => this.toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) {
        basePath = "/" + basePath;
      }
      if (!basePath.endsWith("/")) {
        basePath += "/";
      }
    } else {
      basePath = "/";
    }
    const shouldAddTrailingSlash = this.settings.addTrailingSlashToLinks || addTrailingSlash;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  getContentTypeForPath(filePath) {
    for (const customType of this.settings.customContentTypes) {
      if (customType.enabled && customType.folder && filePath.startsWith(customType.folder + "/")) {
        return {
          basePath: customType.linkBasePath || "",
          creationMode: customType.creationMode,
          indexFileName: customType.indexFileName
        };
      }
    }
    if (this.settings.enablePages) {
      if (this.settings.pagesFolder && filePath.startsWith(this.settings.pagesFolder + "/")) {
        return {
          basePath: this.settings.pagesLinkBasePath,
          creationMode: this.settings.pagesCreationMode || "file",
          indexFileName: this.settings.pagesIndexFileName || ""
        };
      } else if (!this.settings.pagesFolder && !filePath.includes("/")) {
        return {
          basePath: this.settings.pagesLinkBasePath,
          creationMode: this.settings.pagesCreationMode || "file",
          indexFileName: this.settings.pagesIndexFileName || ""
        };
      }
    }
    if (this.settings.postsFolder && filePath.startsWith(this.settings.postsFolder + "/")) {
      return {
        basePath: this.settings.postsLinkBasePath,
        creationMode: this.settings.creationMode,
        indexFileName: this.settings.indexFileName || "index"
      };
    }
    if (!this.settings.postsFolder && this.settings.automatePostCreation) {
      return {
        basePath: this.settings.postsLinkBasePath,
        creationMode: this.settings.creationMode,
        indexFileName: this.settings.indexFileName || "index"
      };
    }
    return {
      basePath: "",
      creationMode: "file",
      indexFileName: ""
    };
  }
  async convertWikilinksForAstro(editor, file) {
    if (!(file instanceof import_obsidian3.TFile)) {
      new import_obsidian3.Notice("No active file.");
      return;
    }
    const content = editor.getValue();
    let newContent = content;
    const currentFileContentType = this.getContentTypeForPath(file.path);
    const imageExtensions = /\.(png|jpg|jpeg|gif|svg)$/i;
    newContent = newContent.replace(
      /\[\[([^\]|]+)(\|([^\]]+))?\]\]/g,
      (match, linkText, _pipe, displayText) => {
        if (imageExtensions.test(linkText)) {
          return match;
        }
        const display = displayText || linkText.replace(/\.md$/, "");
        const url = this.getAstroUrlFromInternalLinkWithContext(linkText, file.path, currentFileContentType);
        return `[${display}](${url})`;
      }
    );
    newContent = newContent.replace(
      /\[([^\]]+)\]\(([^)]+)\)/g,
      (match, displayText, link) => {
        if (link.match(/^https?:\/\//) || imageExtensions.test(link)) {
          return match;
        }
        if (!link.includes(".md")) {
          return match;
        }
        const url = this.getAstroUrlFromInternalLinkWithContext(link, file.path, currentFileContentType);
        return `[${displayText}](${url})`;
      }
    );
    newContent = newContent.replace(
      /!\[(.*?)\]\(([^)]+)\)/g,
      (match) => {
        return match;
      }
    );
    newContent = newContent.replace(/\{\{([^}]+)\}\}/g, (match, fileName) => {
      if (imageExtensions.test(fileName)) {
        return match;
      }
      const url = this.getAstroUrlFromInternalLinkWithContext(fileName, file.path, currentFileContentType);
      return `[Embedded: ${fileName}](${url})`;
    });
    editor.setValue(newContent);
    new import_obsidian3.Notice("All internal links converted for Astro.");
  }
};

// src/ui/title-modal.ts
var import_obsidian4 = require("obsidian");
var TitleModal = class extends import_obsidian4.Modal {
  constructor(app, file, plugin, type = "post", isRename = false, isNewNote = false) {
    super(app);
    this.file = file;
    this.plugin = plugin;
    this.type = type;
    this.isRename = isRename;
    this.isNewNote = isNewNote;
    const settings = plugin.settings;
    this.fileOps = new FileOperations(app, settings);
    this.templateParser = new TemplateParser(app, settings);
  }
  getCurrentTitle() {
    if (!this.file) {
      return "";
    }
    const titleKey = this.fileOps.getTitleKey(this.type);
    const cache = this.app.metadataCache.getFileCache(this.file);
    let basename = this.file.basename;
    if (this.file.parent && this.plugin.settings.indexFileName && this.plugin.settings.indexFileName.trim() !== "" && basename === this.plugin.settings.indexFileName) {
      basename = this.file.parent.name;
    }
    if (basename.startsWith("_")) {
      basename = basename.slice(1);
    }
    const fallbackTitle = basename.replace(/-/g, " ").split(" ").map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join(" ");
    if ((cache == null ? void 0 : cache.frontmatter) && cache.frontmatter[titleKey]) {
      return cache.frontmatter[titleKey];
    }
    return fallbackTitle;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    const isMobile = window.innerWidth <= 768 || /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    if (isMobile) {
      this.modalEl.addClass("astro-composer-mobile-modal");
    }
    if (this.isRename) {
      const typeName = this.getTypeDisplayName();
      const isCustomType = this.fileOps.isCustomContentType(this.type);
      if (isCustomType) {
        contentEl.createEl("h2", { text: `Rename Custom Type: ${typeName}` });
        contentEl.createEl("p", { text: "Enter a new title for this content type:" });
      } else if (this.type === "note") {
        contentEl.createEl("h2", { text: "Rename Custom Content Type" });
        contentEl.createEl("p", { text: "Enter a title for this content type:" });
      } else {
        contentEl.createEl("h2", { text: `Rename ${typeName}` });
        contentEl.createEl("p", { text: `Enter new title for your ${typeName.toLowerCase()}:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: `My Renamed ${typeName}`,
        cls: "astro-composer-title-input"
      });
      this.titleInput.value = this.getCurrentTitle();
    } else if (this.isNewNote) {
      const typeName = this.getTypeDisplayName();
      const isCustomType = this.fileOps.isCustomContentType(this.type);
      if (isCustomType) {
        contentEl.createEl("h2", { text: `New Custom Type: ${typeName}` });
        contentEl.createEl("p", { text: "Enter a title for this content type:" });
      } else {
        contentEl.createEl("h2", { text: `Create New ${typeName}` });
        contentEl.createEl("p", { text: `Enter a title for your new ${typeName.toLowerCase()}:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: `My Awesome ${typeName}`,
        cls: "astro-composer-title-input"
      });
    } else {
      const typeName = this.getTypeDisplayName();
      const isCustomType = this.fileOps.isCustomContentType(this.type);
      if (isCustomType) {
        contentEl.createEl("h2", { text: `New Custom Type: ${typeName}` });
        contentEl.createEl("p", { text: "Enter a title for this content type:" });
      } else {
        contentEl.createEl("h2", { text: `New ${typeName}` });
        contentEl.createEl("p", { text: `Enter a title for your ${typeName.toLowerCase()}:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: `My Awesome ${typeName}`,
        cls: "astro-composer-title-input"
      });
    }
    this.titleInput.focus();
    const buttonContainer = contentEl.createDiv({ cls: "astro-composer-button-container" });
    const cancelButton = buttonContainer.createEl("button", { text: "Cancel", cls: "astro-composer-cancel-button" });
    cancelButton.onclick = () => this.close();
    const submitButton = buttonContainer.createEl("button", { text: this.isRename ? "Rename" : "Create", cls: ["astro-composer-create-button", "mod-cta"] });
    submitButton.onclick = () => this.submit();
    this.titleInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter")
        this.submit();
    });
  }
  async submit() {
    const title = this.titleInput.value.trim();
    if (!title) {
      new import_obsidian4.Notice("Please enter a title.");
      return;
    }
    try {
      let newFile = null;
      if (this.isRename) {
        newFile = await this.fileOps.renameFile({ file: this.file, title, type: this.type });
        if (newFile) {
          await this.templateParser.updateTitleInFrontmatter(newFile, title, this.type);
        }
      } else if (this.isNewNote) {
        newFile = await this.createNewFile(title);
      } else if (this.file) {
        newFile = await this.fileOps.createFile({ file: this.file, title, type: this.type });
        if (newFile && this.plugin.settings.autoInsertProperties) {
          await this.addPropertiesToFile(newFile, title, this.type);
        }
      } else {
        newFile = await this.createNewFile(title);
      }
      if (!newFile) {
        throw new Error("Failed to process the content.");
      }
    } catch (error) {
      new import_obsidian4.Notice(`Error ${this.isRename ? "renaming" : "creating"} ${this.type}: ${error.message}.`);
    }
    this.close();
  }
  getTypeDisplayName() {
    if (this.fileOps.isCustomContentType(this.type)) {
      const customType = this.fileOps.getCustomContentType(this.type);
      return customType ? customType.name : "Content";
    }
    return this.type === "post" ? "Blog Post" : "Page";
  }
  async createNewFile(title) {
    var _a, _b;
    let targetFolder;
    const originalDir = ((_b = (_a = this.file) == null ? void 0 : _a.parent) == null ? void 0 : _b.path) || "";
    if (this.fileOps.isCustomContentType(this.type)) {
      const customType = this.fileOps.getCustomContentType(this.type);
      if (originalDir === "" || originalDir === "/") {
        targetFolder = (customType == null ? void 0 : customType.folder) || "";
      } else {
        targetFolder = originalDir;
      }
    } else if (this.type === "page") {
      targetFolder = this.plugin.settings.pagesFolder || originalDir;
    } else {
      targetFolder = this.plugin.settings.postsFolder || originalDir;
    }
    const filename = this.fileOps.generateFilename(title);
    const filePath = targetFolder ? `${targetFolder}/${filename}.md` : `${filename}.md`;
    let initialContent = "";
    if (this.plugin.settings.autoInsertProperties) {
      initialContent = await this.generateInitialContent(title);
    }
    try {
      const newFile = await this.app.vault.create(filePath, initialContent);
      if (this.plugin && "pluginCreatedFiles" in this.plugin) {
        this.plugin.pluginCreatedFiles.add(filePath);
      }
      await this.app.workspace.getLeaf().openFile(newFile);
      return newFile;
    } catch (error) {
      throw new Error(`Failed to create file: ${error.message}`);
    }
  }
  async generateInitialContent(title) {
    const now = new Date();
    const dateString = window.moment(now).format(this.plugin.settings.dateFormat);
    let template;
    if (this.type === "note") {
      template = `---
title: "${title}"
date: ${dateString}
---
`;
    } else if (this.fileOps.isCustomContentType(this.type)) {
      const customType = this.fileOps.getCustomContentType(this.type);
      template = customType ? customType.template : this.plugin.settings.defaultTemplate;
    } else {
      template = this.type === "post" ? this.plugin.settings.defaultTemplate : this.plugin.settings.pageTemplate;
    }
    template = template.replace(/\{\{title\}\}/g, title);
    template = template.replace(/\{\{date\}\}/g, dateString);
    return template;
  }
  async addPropertiesToFile(file, title, type = "post") {
    const now = new Date();
    const dateString = window.moment(now).format(this.plugin.settings.dateFormat);
    let template;
    if (type === "note") {
      template = `---
title: "${title}"
date: ${dateString}
---
`;
    } else if (this.fileOps.isCustomContentType(type)) {
      const customType = this.fileOps.getCustomContentType(type);
      template = customType ? customType.template : this.plugin.settings.defaultTemplate;
    } else {
      template = type === "post" ? this.plugin.settings.defaultTemplate : this.plugin.settings.pageTemplate;
    }
    template = template.replace(/\{\{title\}\}/g, title);
    template = template.replace(/\{\{date\}\}/g, dateString);
    await this.app.vault.modify(file, template);
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/commands/index.ts
function registerCommands(plugin, settings) {
  const fileOps = new FileOperations(plugin.app, settings, plugin);
  const linkConverter = new LinkConverter(settings);
  function hasMatchingContentType(file, settings2) {
    const filePath = file.path;
    const postsFolder = settings2.postsFolder || "";
    const pagesFolder = settings2.enablePages ? settings2.pagesFolder || "" : "";
    if (settings2.automatePostCreation) {
      if (postsFolder) {
        if (filePath.startsWith(postsFolder + "/") || filePath === postsFolder) {
          return true;
        }
      } else {
        if (!filePath.includes("/") || filePath.includes("/") && !filePath.startsWith("/") && filePath.split("/").length === 2) {
          return true;
        }
      }
    }
    if (settings2.enablePages) {
      if (pagesFolder && (filePath.startsWith(pagesFolder + "/") || filePath === pagesFolder)) {
        return true;
      } else if (!pagesFolder && !filePath.includes("/")) {
        return true;
      }
    }
    const type = fileOps.determineType(file);
    if (fileOps.isCustomContentType(type)) {
      const customType = fileOps.getCustomContentType(type);
      if (customType && customType.enabled) {
        return true;
      }
    }
    return false;
  }
  plugin.addCommand({
    id: "standardize-properties",
    name: "Standardize Properties",
    icon: "file-check",
    editorCallback: (editor, ctx) => {
      if (ctx.file instanceof import_obsidian5.TFile) {
        standardizeProperties(plugin.app, settings, ctx.file, plugin);
      }
    }
  });
  plugin.addCommand({
    id: "convert-wikilinks-astro",
    name: "Convert internal links for Astro",
    icon: "link-2",
    editorCallback: (editor, ctx) => {
      if (ctx.file instanceof import_obsidian5.TFile) {
        linkConverter.convertWikilinksForAstro(editor, ctx.file);
      }
    }
  });
  plugin.addCommand({
    id: "rename-content",
    name: "Rename Current Content",
    icon: "pencil",
    editorCallback: (editor, ctx) => {
      if (ctx.file instanceof import_obsidian5.TFile) {
        if (!hasMatchingContentType(ctx.file, settings)) {
          new import_obsidian5.Notice("Cannot rename: This file is not part of a configured content type folder.");
          return;
        }
        const type = fileOps.determineType(ctx.file);
        const cache = plugin.app.metadataCache.getFileCache(ctx.file);
        const titleKey = fileOps.getTitleKey(type);
        if (!(cache == null ? void 0 : cache.frontmatter) || !(titleKey in cache.frontmatter)) {
          new import_obsidian5.Notice(`Cannot rename: No ${titleKey} found in properties`);
          return;
        }
        new TitleModal(plugin.app, ctx.file, plugin, type, true).open();
      }
    }
  });
}
async function standardizeProperties(app, settings, file, plugin) {
  const templateParser = new TemplateParser(app, settings);
  const fileOps = new FileOperations(app, settings, plugin);
  const type = fileOps.determineType(file);
  let templateString;
  const filePath = file.path;
  const postsFolder = settings.postsFolder || "";
  const pagesFolder = settings.enablePages ? settings.pagesFolder || "" : "";
  let hasMatchingContentType = false;
  if (settings.automatePostCreation) {
    if (postsFolder) {
      if (filePath.startsWith(postsFolder + "/") || filePath === postsFolder) {
        hasMatchingContentType = true;
      }
    } else {
      if (!filePath.includes("/") || filePath.includes("/") && !filePath.startsWith("/") && filePath.split("/").length === 2) {
        hasMatchingContentType = true;
      }
    }
  }
  if (!hasMatchingContentType && settings.enablePages) {
    if (pagesFolder && (filePath.startsWith(pagesFolder + "/") || filePath === pagesFolder)) {
      hasMatchingContentType = true;
    } else if (!pagesFolder && !filePath.includes("/")) {
      hasMatchingContentType = true;
    }
  }
  if (!hasMatchingContentType && fileOps.isCustomContentType(type)) {
    const customType = fileOps.getCustomContentType(type);
    if (customType && customType.enabled) {
      hasMatchingContentType = true;
    }
  }
  if (!hasMatchingContentType) {
    new import_obsidian5.Notice("No properties template specified for this content. This file doesn't match any configured content type folders.");
    return;
  }
  if (fileOps.isCustomContentType(type)) {
    const customType = fileOps.getCustomContentType(type);
    templateString = customType ? customType.template : settings.defaultTemplate;
  } else {
    const isPage = type === "page";
    templateString = isPage ? settings.pageTemplate : settings.defaultTemplate;
  }
  await new Promise((resolve) => setTimeout(resolve, 100));
  const content = await app.vault.read(file);
  const title = file.basename.replace(/^_/, "");
  const parsed = await templateParser.parseFrontmatter(content);
  const { templateProps, templateValues } = templateParser.parseTemplate(templateString, title);
  const finalProps = { ...parsed.properties };
  const arrayKeys = /* @__PURE__ */ new Set();
  for (const key of templateProps) {
    if (!(key in parsed.properties)) {
      const templateValue = templateValues[key];
      if (Array.isArray(templateValue)) {
        finalProps[key] = templateValue;
        arrayKeys.add(key);
      } else {
        finalProps[key] = [templateValue || ""];
      }
    } else {
      const templateValue = templateValues[key];
      const isArrayValue = Array.isArray(templateValue);
      if (isArrayValue) {
        const existingItems = parsed.properties[key] || [];
        const newItems = templateValue.filter((item) => !existingItems.includes(item));
        finalProps[key] = [...existingItems, ...newItems];
        arrayKeys.add(key);
      }
    }
  }
  for (const key in parsed.properties) {
    if (parsed.properties[key].length > 1) {
      arrayKeys.add(key);
    }
  }
  const newContent = templateParser.buildFrontmatterContent(finalProps, arrayKeys) + parsed.bodyContent;
  await app.vault.modify(file, newContent);
  new import_obsidian5.Notice("Properties standardized using template.");
}

// src/ui/settings-tab.ts
var import_obsidian6 = require("obsidian");
var AstroComposerSettingTab = class extends import_obsidian6.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.autoRenameContainer = null;
    this.postsFolderContainer = null;
    this.onlyAutomateContainer = null;
    this.creationModeContainer = null;
    this.indexFileContainer = null;
    this.excludedDirsContainer = null;
    this.underscorePrefixContainer = null;
    this.autoInsertContainer = null;
    this.pagesFieldsContainer = null;
    this.pagesIndexFileContainer = null;
    this.copyHeadingContainer = null;
    this.customContentTypesContainer = null;
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    const settings = this.plugin.settings;
    new import_obsidian6.Setting(containerEl).setName("Date format").setDesc("Format for the date in properties (e.g., YYYY-MM-DD, MMMM D, YYYY, YYYY-MM-DD HH:mm).").addText(
      (text) => text.setPlaceholder("YYYY-MM-DD").setValue(settings.dateFormat).onChange(async (value) => {
        settings.dateFormat = value || "YYYY-MM-DD";
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian6.Setting(containerEl).setName("Enable copy heading links").setDesc("Add right-click context menu option to copy heading links in various formats.").addToggle(
      (toggle) => toggle.setValue(settings.enableCopyHeadingLink).onChange(async (value) => {
        settings.enableCopyHeadingLink = value;
        await this.plugin.saveSettings();
        this.updateCopyHeadingFields();
      })
    );
    this.copyHeadingContainer = containerEl.createDiv({ cls: "copy-heading-fields" });
    this.copyHeadingContainer.style.display = settings.enableCopyHeadingLink ? "block" : "none";
    new import_obsidian6.Setting(this.copyHeadingContainer).setName("Default heading link format").setDesc("Choose the default format for copied heading links. Obsidian format respects your Obsidian settings for wikilink vs markdown preference. Astro link uses your Link base path from above and converts the heading into kebab-case format as an anchor link.").addDropdown(
      (dropdown) => dropdown.addOption("obsidian", "Obsidian link").addOption("astro", "Astro link").setValue(settings.copyHeadingLinkFormat).onChange(async (value) => {
        settings.copyHeadingLinkFormat = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian6.Setting(containerEl).setName("Add trailing slash to links").setDesc("Add trailing slashes to all converted internal links (e.g., /about/ instead of /about).").addToggle(
      (toggle) => toggle.setValue(settings.addTrailingSlashToLinks).onChange(async (value) => {
        settings.addTrailingSlashToLinks = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian6.Setting(containerEl).setName("Post settings").setDesc("").setHeading();
    new import_obsidian6.Setting(containerEl).setName("Automate post creation").setDesc("Automatically show title dialog for new .md files, rename them based on the title, and insert properties if enabled.").addToggle(
      (toggle) => toggle.setValue(settings.automatePostCreation).onChange(async (value) => {
        settings.automatePostCreation = value;
        settings.autoInsertProperties = value;
        await this.plugin.saveSettings();
        this.plugin.registerCreateEvent();
        this.updateConditionalFields();
      })
    );
    this.autoRenameContainer = containerEl.createDiv({ cls: "auto-rename-fields" });
    this.autoRenameContainer.style.display = settings.automatePostCreation ? "block" : "none";
    this.autoInsertContainer = this.autoRenameContainer.createDiv();
    new import_obsidian6.Setting(this.autoInsertContainer).setName("Auto-insert properties").setDesc("Automatically insert the properties template when creating new files (requires 'Automate post creation' to be enabled).").addToggle(
      (toggle) => toggle.setValue(settings.autoInsertProperties).setDisabled(!settings.automatePostCreation).onChange(async (value) => {
        settings.autoInsertProperties = value;
        await this.plugin.saveSettings();
      })
    );
    this.postsFolderContainer = this.autoRenameContainer.createDiv();
    new import_obsidian6.Setting(this.postsFolderContainer).setName("Posts folder").setDesc("Folder name for blog posts (leave blank to use the vault folder). You can specify the default location for new notes in Obsidian's 'Files and links' settings.").addText(
      (text) => text.setPlaceholder("Enter folder path").setValue(settings.postsFolder).onChange(async (value) => {
        settings.postsFolder = value;
        await this.plugin.saveSettings();
        this.updateOnlyAutomateField();
        this.updateExcludedDirsField();
      })
    );
    this.onlyAutomateContainer = this.autoRenameContainer.createDiv();
    new import_obsidian6.Setting(this.onlyAutomateContainer).setName("Ignore subfolders").setDesc("When enabled, automation will only trigger for new .md files within the Posts folder and one level down (for folder-based posts). Files in deeper subfolders will be ignored.").addToggle(
      (toggle) => toggle.setValue(settings.onlyAutomateInPostsFolder).onChange(async (value) => {
        settings.onlyAutomateInPostsFolder = value;
        await this.plugin.saveSettings();
        this.updateExcludedDirsField();
      })
    );
    this.excludedDirsContainer = this.autoRenameContainer.createDiv({ cls: "excluded-dirs-field" });
    this.excludedDirsContainer.style.display = !settings.onlyAutomateInPostsFolder ? "block" : "none";
    new import_obsidian6.Setting(this.excludedDirsContainer).setName("Excluded directories").setDesc("Directories to exclude from automatic post creation (e.g., pages|posts/example). Excluded directories and their child folders will be ignored. Use '|' to separate multiple directories.").addText(
      (text) => text.setPlaceholder("pages|posts/example").setValue(settings.excludedDirectories).onChange(async (value) => {
        settings.excludedDirectories = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian6.Setting(this.autoRenameContainer).setName("Posts link base path").setDesc("Base path for converted links in posts (e.g., /blog/, leave blank for root /).").addText(
      (text) => text.setPlaceholder("/blog/").setValue(settings.postsLinkBasePath).onChange(async (value) => {
        settings.postsLinkBasePath = value;
        await this.plugin.saveSettings();
      })
    );
    this.creationModeContainer = this.autoRenameContainer.createDiv();
    new import_obsidian6.Setting(this.creationModeContainer).setName("Creation mode").setDesc("How to create new entries: file-based or folder-based with an index file.").addDropdown(
      (dropdown) => dropdown.addOption("file", "File-based (post-title.md)").addOption("folder", "Folder-based (post-title/index.md)").setValue(settings.creationMode).onChange(async (value) => {
        settings.creationMode = value;
        await this.plugin.saveSettings();
        this.updateIndexFileField();
      })
    );
    this.indexFileContainer = this.autoRenameContainer.createDiv({ cls: "index-file-field" });
    this.indexFileContainer.style.display = settings.creationMode === "folder" ? "block" : "none";
    new import_obsidian6.Setting(this.indexFileContainer).setName("Index file name").setDesc("Name for index files in folder-based content (without .md extension). Defaults to 'index' if left blank.").addText(
      (text) => text.setPlaceholder("index").setValue(settings.indexFileName).onChange(async (value) => {
        settings.indexFileName = value;
        await this.plugin.saveSettings();
      })
    );
    this.underscorePrefixContainer = this.autoRenameContainer.createDiv();
    new import_obsidian6.Setting(this.underscorePrefixContainer).setName("Use underscore prefix for drafts").setDesc("Add an underscore prefix (_post-title) to new notes by default when enabled. This hides them from Astro, which can be helpful for post drafts. Disable to skip prefixing.").addToggle(
      (toggle) => toggle.setValue(settings.enableUnderscorePrefix).onChange(async (value) => {
        settings.enableUnderscorePrefix = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian6.Setting(containerEl).setName("Post properties template").addTextArea((text) => {
      text.setPlaceholder(
        '---\ntitle: "{{title}}"\ndate: {{date}}\ntags: []\n---\n'
      ).setValue(settings.defaultTemplate).onChange(async (value) => {
        settings.defaultTemplate = value;
        await this.plugin.saveSettings();
      });
      text.inputEl.classList.add("astro-composer-template-textarea");
      return text;
    }).then((setting) => {
      setting.descEl.empty();
      const descDiv = setting.descEl.createEl("div");
      descDiv.innerHTML = "Used for new posts and when standardizing properties.<br />Variables include {{title}} and {{date}}.<br />Do not wrap {{date}} in quotes as it represents a datetime value, not a string.<br />The 'standardize properties' command ignores anything below the second '---' line.";
    });
    new import_obsidian6.Setting(containerEl).setName("Page settings").setDesc("").setHeading();
    new import_obsidian6.Setting(containerEl).setName("Enable pages").setDesc("Enable page content type for static pages.").addToggle(
      (toggle) => toggle.setValue(settings.enablePages).onChange(async (value) => {
        settings.enablePages = value;
        await this.plugin.saveSettings();
        this.plugin.registerCreateEvent();
        this.updatePagesFields();
      })
    );
    this.pagesFieldsContainer = containerEl.createDiv({ cls: "pages-fields" });
    this.pagesFieldsContainer.style.display = settings.enablePages ? "block" : "none";
    new import_obsidian6.Setting(this.pagesFieldsContainer).setName("Pages folder").setDesc("Folder name for pages (leave blank to use the vault folder).").addText(
      (text) => text.setPlaceholder("Enter folder path").setValue(settings.pagesFolder).onChange(async (value) => {
        settings.pagesFolder = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian6.Setting(this.pagesFieldsContainer).setName("Pages link base path").setDesc("Base path for converted links in pages (e.g., /about/, leave blank for root /).").addText(
      (text) => text.setPlaceholder("/").setValue(settings.pagesLinkBasePath).onChange(async (value) => {
        settings.pagesLinkBasePath = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian6.Setting(this.pagesFieldsContainer).setName("Creation mode").setDesc("How to create new entries: file-based or folder-based with an index file.").addDropdown(
      (dropdown) => dropdown.addOption("file", "File-based (page-title.md)").addOption("folder", "Folder-based (page-title/index.md)").setValue(settings.pagesCreationMode || "file").onChange(async (value) => {
        settings.pagesCreationMode = value;
        await this.plugin.saveSettings();
        this.updatePagesIndexFileField();
      })
    );
    this.pagesIndexFileContainer = this.pagesFieldsContainer.createDiv({ cls: "pages-index-file-field" });
    this.pagesIndexFileContainer.style.display = (settings.pagesCreationMode || "file") === "folder" ? "block" : "none";
    new import_obsidian6.Setting(this.pagesIndexFileContainer).setName("Index file name").setDesc("Name for index files in folder-based content (without .md extension). Defaults to 'index' if left blank.").addText(
      (text) => text.setPlaceholder("index").setValue(settings.pagesIndexFileName || "").onChange(async (value) => {
        settings.pagesIndexFileName = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian6.Setting(this.pagesFieldsContainer).setName("Page properties template").setDesc("Template for new page files. Variables include {{title}} and {{date}}.").addTextArea((text) => {
      text.setPlaceholder('---\ntitle: "{{title}}"\ndescription: ""\n---\n').setValue(settings.pageTemplate).onChange(async (value) => {
        settings.pageTemplate = value;
        await this.plugin.saveSettings();
      });
      text.inputEl.classList.add("astro-composer-template-textarea");
      return text;
    });
    new import_obsidian6.Setting(containerEl).setName("Custom content types").setDesc("").setHeading();
    this.customContentTypesContainer = containerEl.createDiv({ cls: "custom-content-types-container" });
    this.renderCustomContentTypes();
    this.updateConditionalFields();
    this.updateIndexFileField();
    this.updateExcludedDirsField();
    this.updateOnlyAutomateField();
    this.updatePagesFields();
    this.updateCopyHeadingFields();
  }
  updateConditionalFields() {
    if (this.autoRenameContainer) {
      const settings = this.plugin.settings;
      this.autoRenameContainer.style.display = settings.automatePostCreation ? "block" : "none";
    }
  }
  updateIndexFileField() {
    if (this.indexFileContainer) {
      const settings = this.plugin.settings;
      this.indexFileContainer.style.display = settings.creationMode === "folder" ? "block" : "none";
    }
  }
  updateOnlyAutomateField() {
    if (this.onlyAutomateContainer) {
      const settings = this.plugin.settings;
      this.onlyAutomateContainer.style.display = settings.postsFolder ? "block" : "none";
    }
  }
  updateExcludedDirsField() {
    if (this.excludedDirsContainer) {
      const settings = this.plugin.settings;
      this.excludedDirsContainer.style.display = settings.postsFolder && !settings.onlyAutomateInPostsFolder ? "block" : "none";
    }
  }
  updatePagesFields() {
    if (this.pagesFieldsContainer) {
      const settings = this.plugin.settings;
      this.pagesFieldsContainer.style.display = settings.enablePages ? "block" : "none";
    }
  }
  updateCopyHeadingFields() {
    if (this.copyHeadingContainer) {
      const settings = this.plugin.settings;
      this.copyHeadingContainer.style.display = settings.enableCopyHeadingLink ? "block" : "none";
    }
  }
  checkForFolderConflicts() {
    const settings = this.plugin.settings;
    const blankFolders = [];
    const folderConflicts = {};
    if (!settings.postsFolder && settings.automatePostCreation) {
      blankFolders.push("Posts");
    } else if (settings.postsFolder && settings.automatePostCreation) {
      if (!folderConflicts[settings.postsFolder]) {
        folderConflicts[settings.postsFolder] = [];
      }
      folderConflicts[settings.postsFolder].push("Posts");
    }
    if (!settings.pagesFolder && settings.enablePages) {
      blankFolders.push("Pages");
    } else if (settings.pagesFolder && settings.enablePages) {
      if (!folderConflicts[settings.pagesFolder]) {
        folderConflicts[settings.pagesFolder] = [];
      }
      folderConflicts[settings.pagesFolder].push("Pages");
    }
    for (const customType of settings.customContentTypes) {
      if (customType.enabled) {
        if (!customType.folder) {
          blankFolders.push(customType.name || "Custom Content");
        } else {
          if (!folderConflicts[customType.folder]) {
            folderConflicts[customType.folder] = [];
          }
          folderConflicts[customType.folder].push(customType.name || "Custom Content");
        }
      }
    }
    let hasConflicts = false;
    let conflictMessage = "";
    if (blankFolders.length > 1) {
      hasConflicts = true;
      conflictMessage += `Multiple content types are set to use the vault root: <strong>${blankFolders.join(", ")}</strong><br><br>`;
    }
    for (const [folder, contentTypes] of Object.entries(folderConflicts)) {
      if (contentTypes.length > 1) {
        hasConflicts = true;
        conflictMessage += `Multiple content types are set to use the same folder "${folder}": <strong>${contentTypes.join(", ")}</strong><br><br>`;
      }
    }
  }
  addCustomContentType() {
    const settings = this.plugin.settings;
    const newType = {
      id: `custom-${Date.now()}`,
      name: `Custom ${settings.customContentTypes.length + 1}`,
      folder: "",
      linkBasePath: "",
      template: '---\ntitle: "{{title}}"\ndate: {{date}}\n---\n',
      enabled: true,
      creationMode: "file",
      indexFileName: ""
    };
    settings.customContentTypes.push(newType);
    this.plugin.saveSettings();
    this.renderCustomContentTypes();
    this.plugin.registerCreateEvent();
  }
  renderCustomContentTypes() {
    if (!this.customContentTypesContainer)
      return;
    this.customContentTypesContainer.empty();
    const settings = this.plugin.settings;
    settings.customContentTypes.forEach((customType, index) => {
      if (!this.customContentTypesContainer)
        return;
      const typeContainer = this.customContentTypesContainer.createDiv({
        cls: "custom-content-type-item",
        attr: { "data-type-id": customType.id }
      });
      const header = typeContainer.createDiv({ cls: "custom-content-type-header" });
      header.style.display = "flex";
      header.style.justifyContent = "space-between";
      header.style.alignItems = "center";
      header.style.padding = "8px 0";
      const headerName = header.createDiv();
      headerName.createEl("div", { text: `Custom ${index + 1}`, cls: "setting-item-name" });
      const toggleContainer = header.createDiv({ cls: "checkbox-container" });
      if (customType.enabled) {
        toggleContainer.classList.add("is-enabled");
      }
      const toggle = toggleContainer.createEl("input", { type: "checkbox", cls: "checkbox-input" });
      toggle.checked = customType.enabled;
      toggleContainer.addEventListener("click", async (e) => {
        e.preventDefault();
        const newValue = !customType.enabled;
        customType.enabled = newValue;
        toggle.checked = newValue;
        await this.plugin.saveSettings();
        this.plugin.registerCreateEvent();
        if (newValue) {
          toggleContainer.classList.add("is-enabled");
        } else {
          toggleContainer.classList.remove("is-enabled");
        }
        this.updateCustomContentTypeVisibility(customType.id, newValue);
      });
      toggle.addEventListener("change", async (e) => {
        const value = e.target.checked;
        customType.enabled = value;
        await this.plugin.saveSettings();
        this.plugin.registerCreateEvent();
        if (value) {
          toggleContainer.classList.add("is-enabled");
        } else {
          toggleContainer.classList.remove("is-enabled");
        }
        this.updateCustomContentTypeVisibility(customType.id, value);
      });
      const settingsContainer = typeContainer.createDiv({
        cls: "custom-content-type-settings",
        attr: { "data-type-id": customType.id }
      });
      const nameContainer = settingsContainer.createDiv();
      new import_obsidian6.Setting(nameContainer).setName("Content type name").setDesc("Display name for this content type (e.g., 'Projects', 'Notes', 'Tutorials')").addText((text) => {
        text.setPlaceholder("Enter content type name").setValue(customType.name).onChange(async (value) => {
          customType.name = value;
          await this.plugin.saveSettings();
        });
      });
      const folderContainer = settingsContainer.createDiv();
      new import_obsidian6.Setting(folderContainer).setName("Folder location").setDesc("Folder path where this content type will be created (e.g., 'projects', 'notes/tutorials')").addText((text) => {
        text.setPlaceholder("Enter folder path").setValue(customType.folder).onChange(async (value) => {
          customType.folder = value;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
        });
      });
      const linkContainer = settingsContainer.createDiv();
      new import_obsidian6.Setting(linkContainer).setName("Link base path").setDesc("Base path for converted links (e.g., '/projects/', '/notes/tutorials/', leave blank for root /).").addText((text) => {
        text.setPlaceholder("Enter link base path").setValue(customType.linkBasePath || "").onChange(async (value) => {
          customType.linkBasePath = value;
          await this.plugin.saveSettings();
        });
      });
      const creationModeContainer = settingsContainer.createDiv();
      new import_obsidian6.Setting(creationModeContainer).setName("Creation mode").setDesc("How to create new entries: file-based or folder-based with an index file.").addDropdown(
        (dropdown) => dropdown.addOption("file", "File-based (content-title.md)").addOption("folder", "Folder-based (content-title/index.md)").setValue(customType.creationMode).onChange(async (value) => {
          customType.creationMode = value;
          await this.plugin.saveSettings();
          this.updateCustomContentTypeIndexFileField(customType.id);
        })
      );
      const indexFileContainer = settingsContainer.createDiv({ cls: "custom-index-file-field" });
      indexFileContainer.style.display = customType.creationMode === "folder" ? "block" : "none";
      new import_obsidian6.Setting(indexFileContainer).setName("Index file name").setDesc("Name for index files in folder-based content (without .md extension). Defaults to 'index' if left blank.").addText(
        (text) => text.setPlaceholder("index").setValue(customType.indexFileName).onChange(async (value) => {
          customType.indexFileName = value;
          await this.plugin.saveSettings();
        })
      );
      const templateContainer = settingsContainer.createDiv();
      new import_obsidian6.Setting(templateContainer).setName("Properties template").addTextArea((text) => {
        text.setPlaceholder('---\ntitle: "{{title}}"\ndate: {{date}}\n---\n').setValue(customType.template).onChange(async (value) => {
          customType.template = value;
          await this.plugin.saveSettings();
        });
        text.inputEl.classList.add("astro-composer-template-textarea");
        return text;
      }).then((setting) => {
        setting.descEl.empty();
        const descDiv = setting.descEl.createEl("div");
        descDiv.innerHTML = "Template for new files of this content type.<br />Variables include {{title}} and {{date}}.<br />Do not wrap {{date}} in quotes as it represents a datetime value, not a string.";
      });
      const removeContainer = settingsContainer.createDiv();
      const removeSetting = new import_obsidian6.Setting(removeContainer).setName("").addButton((button) => {
        button.setButtonText("Remove").setWarning().onClick(() => {
          this.removeCustomContentType(customType.id);
        });
      });
      removeSetting.settingEl.style.borderTop = "none";
      this.updateCustomContentTypeVisibility(customType.id, customType.enabled);
    });
    const addButtonContainer = this.customContentTypesContainer.createDiv();
    const addButtonSetting = new import_obsidian6.Setting(addButtonContainer).setName("").addButton((button) => {
      button.setButtonText("Add custom content type").setCta().onClick(() => {
        this.addCustomContentType();
      });
    });
    addButtonSetting.settingEl.style.borderTop = "none";
  }
  updateCustomContentTypeVisibility(typeId, enabled) {
    var _a;
    const settingsContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].custom-content-type-settings`);
    if (settingsContainer) {
      settingsContainer.style.display = enabled ? "block" : "none";
    }
  }
  updateCustomContentTypeIndexFileField(typeId) {
    var _a;
    const customType = this.plugin.settings.customContentTypes.find((type) => type.id === typeId);
    if (!customType)
      return;
    const indexFileContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"] .custom-index-file-field`);
    if (indexFileContainer) {
      indexFileContainer.style.display = customType.creationMode === "folder" ? "block" : "none";
    }
  }
  updatePagesIndexFileField() {
    if (this.pagesIndexFileContainer) {
      this.pagesIndexFileContainer.style.display = this.plugin.settings.pagesCreationMode === "folder" ? "block" : "none";
    }
  }
  removeCustomContentType(typeId) {
    const settings = this.plugin.settings;
    settings.customContentTypes = settings.customContentTypes.filter((ct) => ct.id !== typeId);
    this.plugin.saveSettings();
    this.renderCustomContentTypes();
    this.plugin.registerCreateEvent();
  }
};

// src/utils/heading-link-generator.ts
var HeadingLinkGenerator = class {
  constructor(settings) {
    this.settings = settings;
  }
  /**
   * Converts text to kebab-case slug for URLs
   */
  toKebabCase(str) {
    return str.toLowerCase().replace(/[^a-z0-9\s-]/g, "").trim().replace(/\s+/g, "-").replace(/-+/g, "-").replace(/^-|-$/g, "");
  }
  /**
   * Gets the Astro-compatible URL from an internal link (copied from LinkConverter)
   */
  getAstroUrlFromInternalLink(link) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = path.replace(/\.md$/, "");
    let basePath = "";
    let contentFolder = "";
    let creationMode = "file";
    let indexFileName = "";
    let foundCustomType = false;
    for (const customType of this.settings.customContentTypes) {
      if (customType.enabled && customType.folder && path.startsWith(customType.folder + "/")) {
        contentFolder = customType.folder;
        basePath = customType.linkBasePath || "";
        creationMode = customType.creationMode;
        indexFileName = customType.indexFileName;
        foundCustomType = true;
        break;
      }
    }
    if (!foundCustomType && this.settings.enablePages && this.settings.pagesFolder && path.startsWith(this.settings.pagesFolder + "/")) {
      contentFolder = this.settings.pagesFolder;
      basePath = this.settings.pagesLinkBasePath;
      creationMode = this.settings.pagesCreationMode || "file";
      indexFileName = this.settings.pagesIndexFileName || "";
    } else if (!foundCustomType && this.settings.postsFolder && path.startsWith(this.settings.postsFolder + "/")) {
      contentFolder = this.settings.postsFolder;
      basePath = this.settings.postsLinkBasePath;
      creationMode = this.settings.creationMode;
      indexFileName = this.settings.indexFileName || "index";
    } else if (!foundCustomType && !this.settings.postsFolder && this.settings.automatePostCreation && !this.settings.onlyAutomateInPostsFolder) {
      basePath = this.settings.postsLinkBasePath;
      creationMode = this.settings.creationMode;
      indexFileName = this.settings.indexFileName || "index";
    }
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    if (indexFileName && indexFileName.trim() !== "") {
      const parts = path.split("/");
      if (parts[parts.length - 1] === indexFileName) {
        parts.pop();
        path = parts.join("/");
        addTrailingSlash = true;
      }
    } else if (creationMode === "folder") {
      const defaultIndexName = "index";
      const parts = path.split("/");
      if (parts[parts.length - 1] === defaultIndexName) {
        parts.pop();
        path = parts.join("/");
        addTrailingSlash = true;
      }
    }
    const slugParts = path.split("/").map((part) => this.toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/"))
        basePath = "/" + basePath;
      if (!basePath.endsWith("/"))
        basePath += "/";
    }
    const shouldAddTrailingSlash = this.settings.addTrailingSlashToLinks || addTrailingSlash;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  /**
   * Generates a standard Obsidian link to a heading, respecting user's link format preference
   */
  generateObsidianLink(app, file, heading) {
    const headingText = heading.heading;
    const testLink = app.fileManager.generateMarkdownLink(file, "", "");
    if (testLink.startsWith("[[")) {
      const filePath = file.path.replace(/\.md$/, "");
      return `[[${filePath}#${headingText}|${headingText}]]`;
    } else {
      const anchor = this.toKebabCase(headingText);
      const baseLink = app.fileManager.generateMarkdownLink(file, "", "");
      if (baseLink.startsWith("[[")) {
        const filePath = file.path.replace(/\.md$/, "");
        return `[[${filePath}#${headingText}|${headingText}]]`;
      } else {
        const match = baseLink.match(/\[([^\]]+)\]\(([^)]+)\)/);
        if (match) {
          const [, , path] = match;
          return `[${headingText}](${path}#${encodeURIComponent(anchor)})`;
        } else {
          const encodedFilename = encodeURIComponent(file.name);
          return `[${headingText}](${encodedFilename}#${encodeURIComponent(anchor)})`;
        }
      }
    }
  }
  /**
   * Generates a standard Obsidian wikilink to a heading
   */
  generateObsidianWikilink(file, heading) {
    const headingText = heading.heading;
    const filePath = file.path.replace(/\.md$/, "");
    return `[[${filePath}#${headingText}|${headingText}]]`;
  }
  /**
   * Generates an Astro-compatible markdown link to a heading
   */
  generateAstroLink(file, heading) {
    const headingText = heading.heading;
    const anchor = this.toKebabCase(headingText);
    const internalLink = `${file.path}#${anchor}`;
    const astroUrl = this.getAstroUrlFromInternalLink(internalLink);
    return `[${headingText}](${astroUrl})`;
  }
  /**
   * Generates an Astro-compatible wikilink to a heading
   */
  generateAstroWikilink(file, heading) {
    const headingText = heading.heading;
    const anchor = this.toKebabCase(headingText);
    const internalLink = `${file.path}#${anchor}`;
    const astroUrl = this.getAstroUrlFromInternalLink(internalLink);
    return `[[${headingText}|${astroUrl}]]`;
  }
  /**
   * Generates the appropriate link format based on settings
   */
  generateLink(app, file, heading) {
    if (this.settings.copyHeadingLinkFormat === "astro") {
      return this.generateAstroLink(file, heading);
    } else {
      return this.generateObsidianLink(app, file, heading);
    }
  }
  /**
   * Finds the heading at a specific line in a file
   */
  findHeadingAtLine(app, file, line) {
    const cache = app.metadataCache.getFileCache(file);
    if (!cache || !cache.headings) {
      return null;
    }
    for (let i = cache.headings.length - 1; i >= 0; i--) {
      const heading = cache.headings[i];
      if (heading.position.start.line <= line) {
        return heading;
      }
    }
    return null;
  }
};

// src/main.ts
var AstroComposerPlugin = class extends import_obsidian7.Plugin {
  constructor() {
    super(...arguments);
    this.pluginCreatedFiles = /* @__PURE__ */ new Set();
  }
  async onload() {
    await this.loadSettings();
    this.fileOps = new FileOperations(this.app, this.settings, this);
    this.templateParser = new TemplateParser(this.app, this.settings);
    this.headingLinkGenerator = new HeadingLinkGenerator(this.settings);
    this.app.workspace.onLayoutReady(() => {
      this.registerCreateEvent();
    });
    registerCommands(this, this.settings);
    this.addSettingTab(new AstroComposerSettingTab(this.app, this));
    this.registerContextMenu();
  }
  registerCreateEvent() {
    if (this.createEvent) {
      this.app.vault.off("create", this.createEvent);
    }
    const hasCustomContentTypes = this.settings.customContentTypes.some((ct) => ct.enabled);
    const shouldUseCreateEvent = this.settings.automatePostCreation || this.settings.enablePages || hasCustomContentTypes;
    if (shouldUseCreateEvent) {
      let lastProcessedTime = 0;
      this.createEvent = async (file) => {
        var _a;
        const now = Date.now();
        if (now - lastProcessedTime < CONSTANTS.DEBOUNCE_MS) {
          return;
        }
        lastProcessedTime = now;
        if (file instanceof import_obsidian7.TFile && file.extension === "md") {
          const filePath = file.path;
          if (this.pluginCreatedFiles.has(filePath)) {
            this.pluginCreatedFiles.delete(filePath);
            return;
          }
          const postsFolder = this.settings.postsFolder || "";
          const pagesFolder = this.settings.enablePages ? this.settings.pagesFolder || "" : "";
          let isPage = false;
          let customTypeId = null;
          let shouldProcess = false;
          let isExcluded = false;
          if (postsFolder && this.settings.excludedDirectories) {
            const excludedDirs = this.settings.excludedDirectories.split("|").map((dir) => dir.trim()).filter((dir) => dir);
            for (const excludedDir of excludedDirs) {
              if (filePath === excludedDir || filePath.startsWith(excludedDir + "/")) {
                isExcluded = true;
                break;
              }
            }
          }
          if (isExcluded) {
            return;
          }
          const fileDir = ((_a = file.parent) == null ? void 0 : _a.path) || "";
          const isInVaultRoot = fileDir === "" || fileDir === "/";
          const applicableContentTypes = [];
          if (this.settings.automatePostCreation) {
            if (!postsFolder && isInVaultRoot) {
              applicableContentTypes.push("Posts");
            } else if (postsFolder && (filePath.startsWith(postsFolder + "/") || filePath === postsFolder)) {
              applicableContentTypes.push("Posts");
            }
          }
          if (this.settings.enablePages) {
            if (!pagesFolder && isInVaultRoot) {
              applicableContentTypes.push("Pages");
            } else if (pagesFolder && (filePath.startsWith(pagesFolder + "/") || filePath === pagesFolder)) {
              applicableContentTypes.push("Pages");
            }
          }
          for (const customType of this.settings.customContentTypes) {
            if (customType.enabled) {
              if (!customType.folder && isInVaultRoot) {
                applicableContentTypes.push(customType.name || "Custom Content");
              } else if (customType.folder && (filePath.startsWith(customType.folder + "/") || filePath === customType.folder)) {
                applicableContentTypes.push(customType.name || "Custom Content");
              }
            }
          }
          if (applicableContentTypes.length > 1) {
            new import_obsidian7.Notice(`\u26A0\uFE0F Folder conflict detected! Multiple content types (${applicableContentTypes.join(", ")}) would process this file. Please specify different folders in settings.`);
            return;
          }
          for (const customType of this.settings.customContentTypes) {
            if (customType.enabled) {
              if (customType.folder && (filePath.startsWith(customType.folder + "/") || filePath === customType.folder)) {
                customTypeId = customType.id;
                shouldProcess = true;
                break;
              } else if (!customType.folder) {
                customTypeId = customType.id;
                shouldProcess = true;
                break;
              }
            }
          }
          if (!customTypeId) {
            if (pagesFolder && (filePath.startsWith(pagesFolder + "/") || filePath === pagesFolder)) {
              isPage = true;
              shouldProcess = true;
            } else if (!pagesFolder && this.settings.enablePages && isInVaultRoot) {
              isPage = true;
              shouldProcess = true;
            }
          }
          if (!shouldProcess && this.settings.automatePostCreation) {
            if (postsFolder) {
              if (this.settings.onlyAutomateInPostsFolder) {
                const pathDepth = filePath.split("/").length;
                const postsDepth = postsFolder.split("/").length;
                if (filePath.startsWith(postsFolder + "/") || filePath === postsFolder) {
                  if (pathDepth <= postsDepth + 1) {
                    shouldProcess = true;
                  }
                }
              } else {
                if (filePath.startsWith(postsFolder + "/") || filePath === postsFolder) {
                  shouldProcess = true;
                }
              }
            } else {
              shouldProcess = true;
            }
          }
          if (!shouldProcess) {
            return;
          }
          const stat = await this.app.vault.adapter.stat(file.path);
          const isNewNote = (stat == null ? void 0 : stat.mtime) && now - stat.mtime < CONSTANTS.STAT_MTIME_THRESHOLD;
          if (!isNewNote) {
            return;
          }
          const cache = this.app.metadataCache.getFileCache(file);
          if (cache == null ? void 0 : cache.frontmatter) {
            const frontmatterKeys = Object.keys(cache.frontmatter);
            if (frontmatterKeys.length > 1 || !frontmatterKeys.includes("title")) {
              return;
            }
          }
          if (customTypeId) {
            new TitleModal(this.app, file, this, customTypeId).open();
          } else if (isPage) {
            new TitleModal(this.app, file, this, "page").open();
          } else {
            new TitleModal(this.app, file, this, "post").open();
          }
        }
      };
      this.registerEvent(this.app.vault.on("create", this.createEvent));
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  registerContextMenu() {
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        if (!this.settings.enableCopyHeadingLink) {
          return;
        }
        const cursor = editor.getCursor();
        const file = view.file;
        if (!(file instanceof import_obsidian7.TFile)) {
          return;
        }
        const heading = this.headingLinkGenerator.findHeadingAtLine(this.app, file, cursor.line);
        if (heading) {
          menu.addItem((item) => {
            item.setTitle("Copy Heading Link").setIcon("link-2").onClick(async () => {
              const link = this.headingLinkGenerator.generateLink(this.app, file, heading);
              await navigator.clipboard.writeText(link);
              new import_obsidian7.Notice("Heading link copied to clipboard");
            });
          });
        }
      })
    );
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9zZXR0aW5ncy50cyIsICJzcmMvY29tbWFuZHMvaW5kZXgudHMiLCAic3JjL3V0aWxzL2ZpbGUtb3BlcmF0aW9ucy50cyIsICJzcmMvdXRpbHMvdGVtcGxhdGUtcGFyc2luZy50cyIsICJzcmMvdXRpbHMvbGluay1jb252ZXJzaW9uLnRzIiwgInNyYy91aS90aXRsZS1tb2RhbC50cyIsICJzcmMvdWkvc2V0dGluZ3MtdGFiLnRzIiwgInNyYy91dGlscy9oZWFkaW5nLWxpbmstZ2VuZXJhdG9yLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQge1xyXG5cdFBsdWdpbixcclxuXHRURmlsZSxcclxuXHROb3RpY2UsXHJcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MsIENPTlNUQU5UUyB9IGZyb20gXCIuL3NldHRpbmdzXCI7XHJcbmltcG9ydCB7IEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UgfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5pbXBvcnQgeyByZWdpc3RlckNvbW1hbmRzIH0gZnJvbSBcIi4vY29tbWFuZHNcIjtcclxuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdUYWIgfSBmcm9tIFwiLi91aS9zZXR0aW5ncy10YWJcIjtcclxuaW1wb3J0IHsgVGl0bGVNb2RhbCB9IGZyb20gXCIuL3VpL3RpdGxlLW1vZGFsXCI7XHJcbmltcG9ydCB7IEZpbGVPcGVyYXRpb25zIH0gZnJvbSBcIi4vdXRpbHMvZmlsZS1vcGVyYXRpb25zXCI7XHJcbmltcG9ydCB7IFRlbXBsYXRlUGFyc2VyIH0gZnJvbSBcIi4vdXRpbHMvdGVtcGxhdGUtcGFyc2luZ1wiO1xyXG5pbXBvcnQgeyBIZWFkaW5nTGlua0dlbmVyYXRvciB9IGZyb20gXCIuL3V0aWxzL2hlYWRpbmctbGluay1nZW5lcmF0b3JcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFzdHJvQ29tcG9zZXJQbHVnaW4gZXh0ZW5kcyBQbHVnaW4gaW1wbGVtZW50cyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlIHtcclxuXHRzZXR0aW5ncyE6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncztcclxuXHRwcml2YXRlIGNyZWF0ZUV2ZW50ITogKGZpbGU6IFRGaWxlKSA9PiB2b2lkO1xyXG5cdHByaXZhdGUgZmlsZU9wcyE6IEZpbGVPcGVyYXRpb25zO1xyXG5cdHByaXZhdGUgdGVtcGxhdGVQYXJzZXIhOiBUZW1wbGF0ZVBhcnNlcjtcclxuXHRwcml2YXRlIGhlYWRpbmdMaW5rR2VuZXJhdG9yITogSGVhZGluZ0xpbmtHZW5lcmF0b3I7XHJcblx0cHJpdmF0ZSBwbHVnaW5DcmVhdGVkRmlsZXM6IFNldDxzdHJpbmc+ID0gbmV3IFNldCgpO1xyXG5cclxuXHRhc3luYyBvbmxvYWQoKSB7XHJcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG5cclxuXHRcdC8vIEluaXRpYWxpemUgdXRpbGl0aWVzXHJcblx0XHR0aGlzLmZpbGVPcHMgPSBuZXcgRmlsZU9wZXJhdGlvbnModGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MsIHRoaXMpO1xyXG5cdFx0dGhpcy50ZW1wbGF0ZVBhcnNlciA9IG5ldyBUZW1wbGF0ZVBhcnNlcih0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncyk7XHJcblx0XHR0aGlzLmhlYWRpbmdMaW5rR2VuZXJhdG9yID0gbmV3IEhlYWRpbmdMaW5rR2VuZXJhdG9yKHRoaXMuc2V0dGluZ3MpO1xyXG5cclxuXHRcdC8vIFdhaXQgZm9yIHRoZSB2YXVsdCB0byBiZSBmdWxseSBsb2FkZWQgYmVmb3JlIHJlZ2lzdGVyaW5nIHRoZSBjcmVhdGUgZXZlbnRcclxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KCgpID0+IHtcclxuXHRcdFx0dGhpcy5yZWdpc3RlckNyZWF0ZUV2ZW50KCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBSZWdpc3RlciBjb21tYW5kc1xyXG5cdFx0cmVnaXN0ZXJDb21tYW5kcyh0aGlzLCB0aGlzLnNldHRpbmdzKTtcclxuXHJcblx0XHQvLyBBZGQgc2V0dGluZ3MgdGFiXHJcblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IEFzdHJvQ29tcG9zZXJTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XHJcblxyXG5cdFx0Ly8gUmVnaXN0ZXIgY29udGV4dCBtZW51IGZvciBjb3B5IGhlYWRpbmcgbGlua3NcclxuXHRcdHRoaXMucmVnaXN0ZXJDb250ZXh0TWVudSgpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHJlZ2lzdGVyQ3JlYXRlRXZlbnQoKSB7XHJcblx0XHRpZiAodGhpcy5jcmVhdGVFdmVudCkge1xyXG5cdFx0XHR0aGlzLmFwcC52YXVsdC5vZmYoXCJjcmVhdGVcIiwgdGhpcy5jcmVhdGVFdmVudCBhcyBhbnkpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFJlZ2lzdGVyIGNyZWF0ZSBldmVudCBmb3IgYXV0b21hdGlvblxyXG5cdFx0Y29uc3QgaGFzQ3VzdG9tQ29udGVudFR5cGVzID0gdGhpcy5zZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXMuc29tZShjdCA9PiBjdC5lbmFibGVkKTtcclxuXHRcdGNvbnN0IHNob3VsZFVzZUNyZWF0ZUV2ZW50ID0gdGhpcy5zZXR0aW5ncy5hdXRvbWF0ZVBvc3RDcmVhdGlvbiB8fCB0aGlzLnNldHRpbmdzLmVuYWJsZVBhZ2VzIHx8IGhhc0N1c3RvbUNvbnRlbnRUeXBlcztcclxuXHRcdFxyXG5cdFx0aWYgKHNob3VsZFVzZUNyZWF0ZUV2ZW50KSB7XHJcblx0XHRcdC8vIERlYm91bmNlIHRvIHByZXZlbnQgbXVsdGlwbGUgbW9kYWxzIGZyb20gcmFwaWQgZmlsZSBjcmVhdGlvbnNcclxuXHRcdFx0bGV0IGxhc3RQcm9jZXNzZWRUaW1lID0gMDtcclxuXHJcblx0XHRcdHRoaXMuY3JlYXRlRXZlbnQgPSBhc3luYyAoZmlsZTogVEZpbGUpID0+IHtcclxuXHRcdFx0XHRjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG5cdFx0XHRcdGlmIChub3cgLSBsYXN0UHJvY2Vzc2VkVGltZSA8IENPTlNUQU5UUy5ERUJPVU5DRV9NUykge1xyXG5cdFx0XHRcdFx0cmV0dXJuOyAvLyBTa2lwIGlmIHdpdGhpbiBkZWJvdW5jZSBwZXJpb2RcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0bGFzdFByb2Nlc3NlZFRpbWUgPSBub3c7XHJcblxyXG5cdFx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09IFwibWRcIikge1xyXG5cdFx0XHRcdFx0Y29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGg7XHJcblxyXG5cdFx0XHRcdFx0Ly8gU2tpcCBpZiB0aGlzIGZpbGUgd2FzIGNyZWF0ZWQgYnkgdGhlIHBsdWdpbiBpdHNlbGZcclxuXHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbkNyZWF0ZWRGaWxlcy5oYXMoZmlsZVBhdGgpKSB7XHJcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luQ3JlYXRlZEZpbGVzLmRlbGV0ZShmaWxlUGF0aCk7IC8vIENsZWFuIHVwXHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHQvLyBDaGVjayBmb2xkZXIgcmVzdHJpY3Rpb25zIEZJUlNUIC0gb25seSBwcm9jZWVkIGlmIGZpbGUgaXMgaW4gYSByZWxldmFudCBmb2xkZXJcclxuXHRcdFx0XHRcdGNvbnN0IHBvc3RzRm9sZGVyID0gdGhpcy5zZXR0aW5ncy5wb3N0c0ZvbGRlciB8fCBcIlwiO1xyXG5cdFx0XHRcdFx0Y29uc3QgcGFnZXNGb2xkZXIgPSB0aGlzLnNldHRpbmdzLmVuYWJsZVBhZ2VzID8gKHRoaXMuc2V0dGluZ3MucGFnZXNGb2xkZXIgfHwgXCJcIikgOiBcIlwiO1xyXG5cdFx0XHRcdFx0bGV0IGlzUGFnZSA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0bGV0IGN1c3RvbVR5cGVJZDogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcblx0XHRcdFx0XHRsZXQgc2hvdWxkUHJvY2VzcyA9IGZhbHNlO1xyXG5cclxuXHRcdFx0XHRcdC8vIENoZWNrIGV4Y2x1c2lvbnMgRklSU1QgLSBiZWZvcmUgYW55IGNvbnRlbnQgdHlwZSBtYXRjaGluZ1xyXG5cdFx0XHRcdFx0Ly8gT25seSBjaGVjayBleGNsdXNpb25zIHdoZW4gUG9zdHMgZm9sZGVyIGlzIHNwZWNpZmllZCAod2hlbiBleGNsdXNpb25zIG1ha2Ugc2Vuc2UpXHJcblx0XHRcdFx0XHRsZXQgaXNFeGNsdWRlZCA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0aWYgKHBvc3RzRm9sZGVyICYmIHRoaXMuc2V0dGluZ3MuZXhjbHVkZWREaXJlY3Rvcmllcykge1xyXG5cdFx0XHRcdFx0XHRjb25zdCBleGNsdWRlZERpcnMgPSB0aGlzLnNldHRpbmdzLmV4Y2x1ZGVkRGlyZWN0b3JpZXMuc3BsaXQoXCJ8XCIpLm1hcChkaXIgPT4gZGlyLnRyaW0oKSkuZmlsdGVyKGRpciA9PiBkaXIpO1xyXG5cdFx0XHRcdFx0XHRmb3IgKGNvbnN0IGV4Y2x1ZGVkRGlyIG9mIGV4Y2x1ZGVkRGlycykge1xyXG5cdFx0XHRcdFx0XHRcdC8vIENoZWNrIGlmIHRoZSBmaWxlIGlzIGluIHRoZSBleGNsdWRlZCBkaXJlY3RvcnkgKGV4YWN0IHBhdGggbWF0Y2ggb25seSlcclxuXHRcdFx0XHRcdFx0XHRpZiAoZmlsZVBhdGggPT09IGV4Y2x1ZGVkRGlyIHx8IGZpbGVQYXRoLnN0YXJ0c1dpdGgoZXhjbHVkZWREaXIgKyBcIi9cIikpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGlzRXhjbHVkZWQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0Ly8gSWYgZmlsZSBpcyBleGNsdWRlZCwgc2tpcCBlbnRpcmVseVxyXG5cdFx0XHRcdFx0aWYgKGlzRXhjbHVkZWQpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vIENoZWNrIGZvciBmb2xkZXIgY29uZmxpY3RzIG9ubHkgaWYgdGhlIGZpbGUgaXMgaW4gYSBjb25mbGljdGluZyBsb2NhdGlvblxyXG5cdFx0XHRcdFx0Y29uc3QgZmlsZURpciA9IGZpbGUucGFyZW50Py5wYXRoIHx8IFwiXCI7XHJcblx0XHRcdFx0XHRjb25zdCBpc0luVmF1bHRSb290ID0gZmlsZURpciA9PT0gXCJcIiB8fCBmaWxlRGlyID09PSBcIi9cIjtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0Ly8gRmluZCB3aGljaCBjb250ZW50IHR5cGVzIHdvdWxkIHByb2Nlc3MgdGhpcyBmaWxlXHJcblx0XHRcdFx0XHRjb25zdCBhcHBsaWNhYmxlQ29udGVudFR5cGVzOiBzdHJpbmdbXSA9IFtdO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHQvLyBDaGVjayBpZiBmaWxlIHdvdWxkIGJlIHByb2Nlc3NlZCBhcyBwb3N0XHJcblx0XHRcdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5hdXRvbWF0ZVBvc3RDcmVhdGlvbikge1xyXG5cdFx0XHRcdFx0XHRpZiAoIXBvc3RzRm9sZGVyICYmIGlzSW5WYXVsdFJvb3QpIHtcclxuXHRcdFx0XHRcdFx0XHRhcHBsaWNhYmxlQ29udGVudFR5cGVzLnB1c2goXCJQb3N0c1wiKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChwb3N0c0ZvbGRlciAmJiAoZmlsZVBhdGguc3RhcnRzV2l0aChwb3N0c0ZvbGRlciArIFwiL1wiKSB8fCBmaWxlUGF0aCA9PT0gcG9zdHNGb2xkZXIpKSB7XHJcblx0XHRcdFx0XHRcdFx0YXBwbGljYWJsZUNvbnRlbnRUeXBlcy5wdXNoKFwiUG9zdHNcIik7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0Ly8gQ2hlY2sgaWYgZmlsZSB3b3VsZCBiZSBwcm9jZXNzZWQgYXMgcGFnZVxyXG5cdFx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlUGFnZXMpIHtcclxuXHRcdFx0XHRcdFx0aWYgKCFwYWdlc0ZvbGRlciAmJiBpc0luVmF1bHRSb290KSB7XHJcblx0XHRcdFx0XHRcdFx0YXBwbGljYWJsZUNvbnRlbnRUeXBlcy5wdXNoKFwiUGFnZXNcIik7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAocGFnZXNGb2xkZXIgJiYgKGZpbGVQYXRoLnN0YXJ0c1dpdGgocGFnZXNGb2xkZXIgKyBcIi9cIikgfHwgZmlsZVBhdGggPT09IHBhZ2VzRm9sZGVyKSkge1xyXG5cdFx0XHRcdFx0XHRcdGFwcGxpY2FibGVDb250ZW50VHlwZXMucHVzaChcIlBhZ2VzXCIpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdC8vIENoZWNrIGlmIGZpbGUgd291bGQgYmUgcHJvY2Vzc2VkIGFzIGN1c3RvbSBjb250ZW50IHR5cGVcclxuXHRcdFx0XHRcdGZvciAoY29uc3QgY3VzdG9tVHlwZSBvZiB0aGlzLnNldHRpbmdzLmN1c3RvbUNvbnRlbnRUeXBlcykge1xyXG5cdFx0XHRcdFx0XHRpZiAoY3VzdG9tVHlwZS5lbmFibGVkKSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKCFjdXN0b21UeXBlLmZvbGRlciAmJiBpc0luVmF1bHRSb290KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRhcHBsaWNhYmxlQ29udGVudFR5cGVzLnB1c2goY3VzdG9tVHlwZS5uYW1lIHx8IFwiQ3VzdG9tIENvbnRlbnRcIik7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChjdXN0b21UeXBlLmZvbGRlciAmJiAoZmlsZVBhdGguc3RhcnRzV2l0aChjdXN0b21UeXBlLmZvbGRlciArIFwiL1wiKSB8fCBmaWxlUGF0aCA9PT0gY3VzdG9tVHlwZS5mb2xkZXIpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRhcHBsaWNhYmxlQ29udGVudFR5cGVzLnB1c2goY3VzdG9tVHlwZS5uYW1lIHx8IFwiQ3VzdG9tIENvbnRlbnRcIik7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdC8vIE9ubHkgc2hvdyBjb25mbGljdCBpZiBtdWx0aXBsZSBjb250ZW50IHR5cGVzIHdvdWxkIHByb2Nlc3MgdGhpcyBzcGVjaWZpYyBmaWxlXHJcblx0XHRcdFx0XHRpZiAoYXBwbGljYWJsZUNvbnRlbnRUeXBlcy5sZW5ndGggPiAxKSB7XHJcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYFx1MjZBMFx1RkUwRiBGb2xkZXIgY29uZmxpY3QgZGV0ZWN0ZWQhIE11bHRpcGxlIGNvbnRlbnQgdHlwZXMgKCR7YXBwbGljYWJsZUNvbnRlbnRUeXBlcy5qb2luKFwiLCBcIil9KSB3b3VsZCBwcm9jZXNzIHRoaXMgZmlsZS4gUGxlYXNlIHNwZWNpZnkgZGlmZmVyZW50IGZvbGRlcnMgaW4gc2V0dGluZ3MuYCk7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHQvLyBDaGVjayBjdXN0b20gY29udGVudCB0eXBlcyBmaXJzdFxyXG5cdFx0XHRcdFx0Zm9yIChjb25zdCBjdXN0b21UeXBlIG9mIHRoaXMuc2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzKSB7XHJcblx0XHRcdFx0XHRcdGlmIChjdXN0b21UeXBlLmVuYWJsZWQpIHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoY3VzdG9tVHlwZS5mb2xkZXIgJiYgXHJcblx0XHRcdFx0XHRcdFx0XHQoZmlsZVBhdGguc3RhcnRzV2l0aChjdXN0b21UeXBlLmZvbGRlciArIFwiL1wiKSB8fCBmaWxlUGF0aCA9PT0gY3VzdG9tVHlwZS5mb2xkZXIpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlSWQgPSBjdXN0b21UeXBlLmlkO1xyXG5cdFx0XHRcdFx0XHRcdFx0c2hvdWxkUHJvY2VzcyA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCFjdXN0b21UeXBlLmZvbGRlcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gQ3VzdG9tIGNvbnRlbnQgdHlwZSBmb2xkZXIgaXMgYmxhbmsgLSB0cmVhdCBhbGwgZmlsZXMgYXMgdGhpcyB0eXBlXHJcblx0XHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlSWQgPSBjdXN0b21UeXBlLmlkO1xyXG5cdFx0XHRcdFx0XHRcdFx0c2hvdWxkUHJvY2VzcyA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRpZiAoIWN1c3RvbVR5cGVJZCkge1xyXG5cdFx0XHRcdFx0XHRpZiAocGFnZXNGb2xkZXIgJiYgKGZpbGVQYXRoLnN0YXJ0c1dpdGgocGFnZXNGb2xkZXIgKyBcIi9cIikgfHwgZmlsZVBhdGggPT09IHBhZ2VzRm9sZGVyKSkge1xyXG5cdFx0XHRcdFx0XHRcdGlzUGFnZSA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0c2hvdWxkUHJvY2VzcyA9IHRydWU7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoIXBhZ2VzRm9sZGVyICYmIHRoaXMuc2V0dGluZ3MuZW5hYmxlUGFnZXMgJiYgaXNJblZhdWx0Um9vdCkge1xyXG5cdFx0XHRcdFx0XHRcdC8vIFBhZ2VzIGZvbGRlciBpcyBibGFuayAtIG9ubHkgdHJlYXQgZmlsZXMgaW4gdmF1bHQgcm9vdCBhcyBwYWdlc1xyXG5cdFx0XHRcdFx0XHRcdGlzUGFnZSA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0c2hvdWxkUHJvY2VzcyA9IHRydWU7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHQvLyBDaGVjayBwb3N0cyBmb2xkZXIgLSBidXQgb25seSBpZiBub3QgYWxyZWFkeSBtYXRjaGVkIGFzIHBhZ2Ugb3IgY3VzdG9tIGNvbnRlbnQgdHlwZVxyXG5cdFx0XHRcdFx0aWYgKCFzaG91bGRQcm9jZXNzICYmIHRoaXMuc2V0dGluZ3MuYXV0b21hdGVQb3N0Q3JlYXRpb24pIHtcclxuXHRcdFx0XHRcdFx0Ly8gT25seSBwcm9jZXNzIGFzIHBvc3QgaWYgbWVldHMgcG9zdHMgZm9sZGVyIGNyaXRlcmlhXHJcblx0XHRcdFx0XHRcdGlmIChwb3N0c0ZvbGRlcikge1xyXG5cdFx0XHRcdFx0XHRcdC8vIFBvc3RzIGZvbGRlciBpcyBzcGVjaWZpZWRcclxuXHRcdFx0XHRcdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5vbmx5QXV0b21hdGVJblBvc3RzRm9sZGVyKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBPbmx5IGF1dG9tYXRlIGluIHBvc3RzIGZvbGRlciBhbmQgb25lIGxldmVsIGRvd25cclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IHBhdGhEZXB0aCA9IGZpbGVQYXRoLnNwbGl0KFwiL1wiKS5sZW5ndGg7XHJcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBwb3N0c0RlcHRoID0gcG9zdHNGb2xkZXIuc3BsaXQoXCIvXCIpLmxlbmd0aDtcclxuXHRcdFx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGZpbGVQYXRoLnN0YXJ0c1dpdGgocG9zdHNGb2xkZXIgKyBcIi9cIikgfHwgZmlsZVBhdGggPT09IHBvc3RzRm9sZGVyKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEFsbG93IGZpbGVzIGluIHBvc3RzIGZvbGRlciBhbmQgZXhhY3RseSBvbmUgbGV2ZWwgZG93blxyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAocGF0aERlcHRoIDw9IHBvc3RzRGVwdGggKyAxKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0c2hvdWxkUHJvY2VzcyA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gTm9ybWFsIGF1dG9tYXRpb24gLSBjaGVjayBpZiBmaWxlIGlzIGluIHBvc3RzIGZvbGRlclxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGZpbGVQYXRoLnN0YXJ0c1dpdGgocG9zdHNGb2xkZXIgKyBcIi9cIikgfHwgZmlsZVBhdGggPT09IHBvc3RzRm9sZGVyKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHNob3VsZFByb2Nlc3MgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBQb3N0cyBmb2xkZXIgaXMgYmxhbmsgLSB0cmVhdCBhbGwgZmlsZXMgYXMgcG9zdHMgKGxpa2UgcGFnZXMpXHJcblx0XHRcdFx0XHRcdFx0c2hvdWxkUHJvY2VzcyA9IHRydWU7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHQvLyBJZiBub3QgaW4gYW55IHJlbGV2YW50IGZvbGRlciwgc2tpcCBlbnRpcmVseVxyXG5cdFx0XHRcdFx0aWYgKCFzaG91bGRQcm9jZXNzKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHQvLyBDaGVjayBpZiBmaWxlIGlzIG5ld2x5IGNyZWF0ZWQgYnkgdXNlciAocmVjZW50IGNyZWF0aW9uIHRpbWUpXHJcblx0XHRcdFx0XHRjb25zdCBzdGF0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuYWRhcHRlci5zdGF0KGZpbGUucGF0aCk7XHJcblx0XHRcdFx0XHRjb25zdCBpc05ld05vdGUgPSBzdGF0Py5tdGltZSAmJiAobm93IC0gc3RhdC5tdGltZSA8IENPTlNUQU5UUy5TVEFUX01USU1FX1RIUkVTSE9MRCk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gU2tpcCBpZiBub3QgYSB1c2VyLWluaXRpYXRlZCBuZXcgbm90ZVxyXG5cdFx0XHRcdFx0aWYgKCFpc05ld05vdGUpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vIENoZWNrIGlmIGZpbGUgYWxyZWFkeSBoYXMgZnJvbnRtYXR0ZXIgdGhhdCBsb29rcyBsaWtlIGl0IHdhcyBjcmVhdGVkIGJ5IGFub3RoZXIgcGx1Z2luXHJcblx0XHRcdFx0XHRjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG5cdFx0XHRcdFx0aWYgKGNhY2hlPy5mcm9udG1hdHRlcikge1xyXG5cdFx0XHRcdFx0XHQvLyBJZiBpdCBhbHJlYWR5IGhhcyBmcm9udG1hdHRlciwgaXQgbWlnaHQgaGF2ZSBiZWVuIGNyZWF0ZWQgYnkgYW5vdGhlciBwbHVnaW5cclxuXHRcdFx0XHRcdFx0Ly8gT25seSBwcm9jZWVkIGlmIGl0J3MgYSB2ZXJ5IGJhc2ljIGZyb250bWF0dGVyIChsaWtlIGp1c3QgYSB0aXRsZSlcclxuXHRcdFx0XHRcdFx0Y29uc3QgZnJvbnRtYXR0ZXJLZXlzID0gT2JqZWN0LmtleXMoY2FjaGUuZnJvbnRtYXR0ZXIpO1xyXG5cdFx0XHRcdFx0XHRpZiAoZnJvbnRtYXR0ZXJLZXlzLmxlbmd0aCA+IDEgfHwgIWZyb250bWF0dGVyS2V5cy5pbmNsdWRlcygndGl0bGUnKSkge1xyXG5cdFx0XHRcdFx0XHRcdC8vIFRoaXMgbG9va3MgbGlrZSBpdCB3YXMgY3JlYXRlZCBieSBhbm90aGVyIHBsdWdpbiB3aXRoIGEgZnVsbCB0ZW1wbGF0ZVxyXG5cdFx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vIFNob3cgdGhlIGFwcHJvcHJpYXRlIG1vZGFsXHJcblx0XHRcdFx0XHRpZiAoY3VzdG9tVHlwZUlkKSB7XHJcblx0XHRcdFx0XHRcdG5ldyBUaXRsZU1vZGFsKHRoaXMuYXBwLCBmaWxlLCB0aGlzLCBjdXN0b21UeXBlSWQpLm9wZW4oKTtcclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAoaXNQYWdlKSB7XHJcblx0XHRcdFx0XHRcdG5ldyBUaXRsZU1vZGFsKHRoaXMuYXBwLCBmaWxlLCB0aGlzLCBcInBhZ2VcIikub3BlbigpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIHBvc3RcclxuXHRcdFx0XHRcdFx0bmV3IFRpdGxlTW9kYWwodGhpcy5hcHAsIGZpbGUsIHRoaXMsIFwicG9zdFwiKS5vcGVuKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9O1xyXG5cdFx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAudmF1bHQub24oXCJjcmVhdGVcIiwgdGhpcy5jcmVhdGVFdmVudCBhcyBhbnkpKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xyXG5cdH1cclxuXHJcblx0YXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcmVnaXN0ZXJDb250ZXh0TWVudSgpIHtcclxuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcclxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItbWVudScsIChtZW51LCBlZGl0b3IsIHZpZXcpID0+IHtcclxuXHRcdFx0XHQvLyBPbmx5IHNob3cgbWVudSBpZiB0aGUgZmVhdHVyZSBpcyBlbmFibGVkXHJcblx0XHRcdFx0aWYgKCF0aGlzLnNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluaykge1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Y29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xyXG5cdFx0XHRcdGNvbnN0IGZpbGUgPSB2aWV3LmZpbGU7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0aWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Ly8gRmluZCB0aGUgaGVhZGluZyBhdCB0aGUgY3VycmVudCBjdXJzb3IgcG9zaXRpb25cclxuXHRcdFx0XHRjb25zdCBoZWFkaW5nID0gdGhpcy5oZWFkaW5nTGlua0dlbmVyYXRvci5maW5kSGVhZGluZ0F0TGluZSh0aGlzLmFwcCwgZmlsZSwgY3Vyc29yLmxpbmUpO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGlmIChoZWFkaW5nKSB7XHJcblx0XHRcdFx0XHQvLyBNYWluIGNvcHkgYnV0dG9uIC0gdXNlcyB0aGUgZGVmYXVsdCBmb3JtYXQgYW5kIHJlc3BlY3RzIE9ic2lkaWFuIHNldHRpbmdzXHJcblx0XHRcdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuXHRcdFx0XHRcdFx0aXRlbVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRUaXRsZSgnQ29weSBIZWFkaW5nIExpbmsnKVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRJY29uKCdsaW5rLTInKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGxpbmsgPSB0aGlzLmhlYWRpbmdMaW5rR2VuZXJhdG9yLmdlbmVyYXRlTGluayh0aGlzLmFwcCwgZmlsZSwgaGVhZGluZyk7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChsaW5rKTtcclxuXHRcdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoJ0hlYWRpbmcgbGluayBjb3BpZWQgdG8gY2xpcGJvYXJkJyk7XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pXHJcblx0XHQpO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQXN0cm9Db21wb3NlclNldHRpbmdzIHtcclxuXHRlbmFibGVVbmRlcnNjb3JlUHJlZml4OiBib29sZWFuO1xyXG5cdGRlZmF1bHRUZW1wbGF0ZTogc3RyaW5nO1xyXG5cdHBvc3RzRm9sZGVyOiBzdHJpbmc7XHJcblx0cG9zdHNMaW5rQmFzZVBhdGg6IHN0cmluZztcclxuXHRhdXRvbWF0ZVBvc3RDcmVhdGlvbjogYm9vbGVhbjtcclxuXHRhdXRvSW5zZXJ0UHJvcGVydGllczogYm9vbGVhbjtcclxuXHRjcmVhdGlvbk1vZGU6IFwiZmlsZVwiIHwgXCJmb2xkZXJcIjtcclxuXHRpbmRleEZpbGVOYW1lOiBzdHJpbmc7XHJcblx0ZGF0ZUZvcm1hdDogc3RyaW5nO1xyXG5cdGV4Y2x1ZGVkRGlyZWN0b3JpZXM6IHN0cmluZztcclxuXHRvbmx5QXV0b21hdGVJblBvc3RzRm9sZGVyOiBib29sZWFuO1xyXG5cdGVuYWJsZVBhZ2VzOiBib29sZWFuO1xyXG5cdHBhZ2VzRm9sZGVyOiBzdHJpbmc7XHJcblx0cGFnZXNMaW5rQmFzZVBhdGg6IHN0cmluZztcclxuXHRwYWdlc0NyZWF0aW9uTW9kZTogXCJmaWxlXCIgfCBcImZvbGRlclwiO1xyXG5cdHBhZ2VzSW5kZXhGaWxlTmFtZTogc3RyaW5nO1xyXG5cdHBhZ2VUZW1wbGF0ZTogc3RyaW5nO1xyXG5cdGVuYWJsZUNvcHlIZWFkaW5nTGluazogYm9vbGVhbjtcclxuXHRjb3B5SGVhZGluZ0xpbmtGb3JtYXQ6IFwib2JzaWRpYW5cIiB8IFwiYXN0cm9cIjtcclxuXHRhZGRUcmFpbGluZ1NsYXNoVG9MaW5rczogYm9vbGVhbjtcclxuXHRjdXN0b21Db250ZW50VHlwZXM6IEN1c3RvbUNvbnRlbnRUeXBlW107XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUGFyc2VkRnJvbnRtYXR0ZXIge1xyXG5cdHByb3BlcnRpZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPjtcclxuXHRwcm9wZXJ0aWVzVGV4dDogc3RyaW5nO1xyXG5cdHByb3BlcnRpZXNFbmQ6IG51bWJlcjtcclxuXHRib2R5Q29udGVudDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFRlbXBsYXRlVmFsdWVzIHtcclxuXHRba2V5OiBzdHJpbmddOiBzdHJpbmdbXSB8IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IHR5cGUgUG9zdFR5cGUgPSBcInBvc3RcIiB8IFwicGFnZVwiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21Db250ZW50VHlwZSB7XHJcblx0aWQ6IHN0cmluZztcclxuXHRuYW1lOiBzdHJpbmc7XHJcblx0Zm9sZGVyOiBzdHJpbmc7XHJcblx0bGlua0Jhc2VQYXRoOiBzdHJpbmc7XHJcblx0dGVtcGxhdGU6IHN0cmluZztcclxuXHRlbmFibGVkOiBib29sZWFuO1xyXG5cdGNyZWF0aW9uTW9kZTogXCJmaWxlXCIgfCBcImZvbGRlclwiO1xyXG5cdGluZGV4RmlsZU5hbWU6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBGaWxlQ3JlYXRpb25PcHRpb25zIHtcclxuXHRmaWxlOiBURmlsZTtcclxuXHR0aXRsZTogc3RyaW5nO1xyXG5cdHR5cGU6IFBvc3RUeXBlIHwgc3RyaW5nOyAvLyBzdHJpbmcgZm9yIGN1c3RvbSBjb250ZW50IHR5cGVzXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmVuYW1lT3B0aW9ucyB7XHJcblx0ZmlsZTogVEZpbGU7XHJcblx0dGl0bGU6IHN0cmluZztcclxuXHR0eXBlOiBQb3N0VHlwZSB8IHN0cmluZzsgLy8gc3RyaW5nIGZvciBjdXN0b20gY29udGVudCB0eXBlc1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgS05PV05fQVJSQVlfS0VZUyA9IFsndGFncycsICdhbGlhc2VzJywgJ2Nzc2NsYXNzZXMnXSBhcyBjb25zdDtcclxuXHJcbmV4cG9ydCBjb25zdCBDT05TVEFOVFMgPSB7XHJcblx0REVCT1VOQ0VfTVM6IDUwMCxcclxuXHRTVEFUX01USU1FX1RIUkVTSE9MRDogMTAwMCxcclxuXHRFRElUT1JfU1RBQklMSVpFX0RFTEFZOiAxMDAsXHJcblx0RklMRV9FWFBMT1JFUl9SRVZFQUxfREVMQVk6IDIwMCxcclxufSBhcyBjb25zdDtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSB7XHJcblx0c2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncztcclxuXHRzYXZlU2V0dGluZ3MoKTogUHJvbWlzZTx2b2lkPjtcclxuXHRyZWdpc3RlckNyZWF0ZUV2ZW50KCk6IHZvaWQ7XHJcbn0iLCAiaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzIH0gZnJvbSBcIi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCB0eXBlIHsgQXN0cm9Db21wb3NlclNldHRpbmdzIH0gZnJvbSBcIi4vdHlwZXNcIjtcclxuZXhwb3J0IHsgQ09OU1RBTlRTIH0gZnJvbSBcIi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgPSB7XHJcblx0ZW5hYmxlVW5kZXJzY29yZVByZWZpeDogZmFsc2UsXHJcblx0ZGVmYXVsdFRlbXBsYXRlOlxyXG5cdFx0Jy0tLVxcbnRpdGxlOiBcInt7dGl0bGV9fVwiXFxuZGF0ZToge3tkYXRlfX1cXG50YWdzOiBbXVxcbi0tLVxcbicsXHJcblx0cG9zdHNGb2xkZXI6IFwicG9zdHNcIixcclxuXHRwb3N0c0xpbmtCYXNlUGF0aDogXCJibG9nL1wiLFxyXG5cdGF1dG9tYXRlUG9zdENyZWF0aW9uOiB0cnVlLFxyXG5cdGF1dG9JbnNlcnRQcm9wZXJ0aWVzOiB0cnVlLFxyXG5cdGNyZWF0aW9uTW9kZTogXCJmaWxlXCIsXHJcblx0aW5kZXhGaWxlTmFtZTogXCJcIixcclxuXHRkYXRlRm9ybWF0OiBcIllZWVktTU0tRERcIixcclxuXHRleGNsdWRlZERpcmVjdG9yaWVzOiBcIlwiLFxyXG5cdG9ubHlBdXRvbWF0ZUluUG9zdHNGb2xkZXI6IGZhbHNlLFxyXG5cdGVuYWJsZVBhZ2VzOiBmYWxzZSxcclxuXHRwYWdlc0ZvbGRlcjogXCJwYWdlc1wiLFxyXG5cdHBhZ2VzTGlua0Jhc2VQYXRoOiBcIlwiLFxyXG5cdHBhZ2VzQ3JlYXRpb25Nb2RlOiBcImZpbGVcIixcclxuXHRwYWdlc0luZGV4RmlsZU5hbWU6IFwiXCIsXHJcblx0cGFnZVRlbXBsYXRlOlxyXG5cdFx0Jy0tLVxcbnRpdGxlOiBcInt7dGl0bGV9fVwiXFxuZGVzY3JpcHRpb246IFwiXCJcXG4tLS1cXG4nLFxyXG5cdGVuYWJsZUNvcHlIZWFkaW5nTGluazogdHJ1ZSxcclxuXHRjb3B5SGVhZGluZ0xpbmtGb3JtYXQ6IFwib2JzaWRpYW5cIixcclxuXHRhZGRUcmFpbGluZ1NsYXNoVG9MaW5rczogZmFsc2UsXHJcblx0Y3VzdG9tQ29udGVudFR5cGVzOiBbXSxcclxufTtcclxuIiwgImltcG9ydCB7IFBsdWdpbiwgRWRpdG9yLCBNYXJrZG93blZpZXcsIFRGaWxlLCBOb3RpY2UsIEFwcCB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuaW1wb3J0IHsgRmlsZU9wZXJhdGlvbnMgfSBmcm9tIFwiLi4vdXRpbHMvZmlsZS1vcGVyYXRpb25zXCI7XHJcbmltcG9ydCB7IFRlbXBsYXRlUGFyc2VyIH0gZnJvbSBcIi4uL3V0aWxzL3RlbXBsYXRlLXBhcnNpbmdcIjtcclxuaW1wb3J0IHsgTGlua0NvbnZlcnRlciB9IGZyb20gXCIuLi91dGlscy9saW5rLWNvbnZlcnNpb25cIjtcclxuaW1wb3J0IHsgVGl0bGVNb2RhbCB9IGZyb20gXCIuLi91aS90aXRsZS1tb2RhbFwiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyQ29tbWFuZHMocGx1Z2luOiBQbHVnaW4sIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiB2b2lkIHtcclxuXHRjb25zdCBmaWxlT3BzID0gbmV3IEZpbGVPcGVyYXRpb25zKHBsdWdpbi5hcHAsIHNldHRpbmdzLCBwbHVnaW4pO1xyXG5cdGNvbnN0IGxpbmtDb252ZXJ0ZXIgPSBuZXcgTGlua0NvbnZlcnRlcihzZXR0aW5ncyk7XHJcblxyXG5cclxuXHQvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY2hlY2sgaWYgYSBmaWxlIG1hdGNoZXMgYW55IGNvbmZpZ3VyZWQgY29udGVudCB0eXBlXHJcblx0ZnVuY3Rpb24gaGFzTWF0Y2hpbmdDb250ZW50VHlwZShmaWxlOiBURmlsZSwgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyk6IGJvb2xlYW4ge1xyXG5cdFx0Y29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGg7XHJcblx0XHRjb25zdCBwb3N0c0ZvbGRlciA9IHNldHRpbmdzLnBvc3RzRm9sZGVyIHx8IFwiXCI7XHJcblx0XHRjb25zdCBwYWdlc0ZvbGRlciA9IHNldHRpbmdzLmVuYWJsZVBhZ2VzID8gKHNldHRpbmdzLnBhZ2VzRm9sZGVyIHx8IFwiXCIpIDogXCJcIjtcclxuXHRcdFxyXG5cdFx0Ly8gQ2hlY2sgaWYgaXQncyBhIHBvc3RcclxuXHRcdGlmIChzZXR0aW5ncy5hdXRvbWF0ZVBvc3RDcmVhdGlvbikge1xyXG5cdFx0XHRpZiAocG9zdHNGb2xkZXIpIHtcclxuXHRcdFx0XHQvLyBJZiBwb3N0c0ZvbGRlciBpcyBzcGVjaWZpZWQsIGNoZWNrIGlmIGZpbGUgaXMgaW4gdGhhdCBmb2xkZXJcclxuXHRcdFx0XHRpZiAoZmlsZVBhdGguc3RhcnRzV2l0aChwb3N0c0ZvbGRlciArIFwiL1wiKSB8fCBmaWxlUGF0aCA9PT0gcG9zdHNGb2xkZXIpIHtcclxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIElmIHBvc3RzRm9sZGVyIGlzIGJsYW5rLCBvbmx5IHRyZWF0IGZpbGVzIGluIHZhdWx0IHJvb3QgYXMgcG9zdHNcclxuXHRcdFx0Ly8gVGhpcyBpbmNsdWRlcyBib3RoIGRpcmVjdCBmaWxlcyBhbmQgZm9sZGVyLWJhc2VkIHBvc3RzIGluIHZhdWx0IHJvb3RcclxuXHRcdFx0aWYgKCFmaWxlUGF0aC5pbmNsdWRlcyhcIi9cIikgfHwgKGZpbGVQYXRoLmluY2x1ZGVzKFwiL1wiKSAmJiAhZmlsZVBhdGguc3RhcnRzV2l0aChcIi9cIikgJiYgZmlsZVBhdGguc3BsaXQoXCIvXCIpLmxlbmd0aCA9PT0gMikpIHtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvLyBDaGVjayBpZiBpdCdzIGEgcGFnZVxyXG5cdFx0aWYgKHNldHRpbmdzLmVuYWJsZVBhZ2VzKSB7XHJcblx0XHRcdGlmIChwYWdlc0ZvbGRlciAmJiAoZmlsZVBhdGguc3RhcnRzV2l0aChwYWdlc0ZvbGRlciArIFwiL1wiKSB8fCBmaWxlUGF0aCA9PT0gcGFnZXNGb2xkZXIpKSB7XHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH0gZWxzZSBpZiAoIXBhZ2VzRm9sZGVyICYmICFmaWxlUGF0aC5pbmNsdWRlcyhcIi9cIikpIHtcclxuXHRcdFx0XHQvLyBJZiBwYWdlc0ZvbGRlciBpcyBibGFuaywgb25seSB0cmVhdCBmaWxlcyBpbiB2YXVsdCByb290IGFzIHBhZ2VzXHJcblx0XHRcdFx0cmV0dXJuIHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly8gQ2hlY2sgaWYgaXQncyBhIGN1c3RvbSBjb250ZW50IHR5cGVcclxuXHRcdGNvbnN0IHR5cGUgPSBmaWxlT3BzLmRldGVybWluZVR5cGUoZmlsZSk7XHJcblx0XHRpZiAoZmlsZU9wcy5pc0N1c3RvbUNvbnRlbnRUeXBlKHR5cGUpKSB7XHJcblx0XHRcdGNvbnN0IGN1c3RvbVR5cGUgPSBmaWxlT3BzLmdldEN1c3RvbUNvbnRlbnRUeXBlKHR5cGUpO1xyXG5cdFx0XHRpZiAoY3VzdG9tVHlwZSAmJiBjdXN0b21UeXBlLmVuYWJsZWQpIHtcclxuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRyZXR1cm4gZmFsc2U7XHJcblx0fVxyXG5cclxuXHQvLyBTdGFuZGFyZGl6ZSBQcm9wZXJ0aWVzIGNvbW1hbmRcclxuXHRwbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRpZDogXCJzdGFuZGFyZGl6ZS1wcm9wZXJ0aWVzXCIsXHJcblx0XHRuYW1lOiBcIlN0YW5kYXJkaXplIFByb3BlcnRpZXNcIixcclxuXHRcdGljb246IFwiZmlsZS1jaGVja1wiLFxyXG5cdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBhbnkpID0+IHtcclxuXHRcdFx0aWYgKGN0eC5maWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuXHRcdFx0XHRzdGFuZGFyZGl6ZVByb3BlcnRpZXMocGx1Z2luLmFwcCwgc2V0dGluZ3MsIGN0eC5maWxlLCBwbHVnaW4pO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdH0pO1xyXG5cclxuXHQvLyBDb252ZXJ0IFdpa2lsaW5rcyBjb21tYW5kXHJcblx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0aWQ6IFwiY29udmVydC13aWtpbGlua3MtYXN0cm9cIixcclxuXHRcdG5hbWU6IFwiQ29udmVydCBpbnRlcm5hbCBsaW5rcyBmb3IgQXN0cm9cIixcclxuXHRcdGljb246IFwibGluay0yXCIsXHJcblx0XHRlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IGFueSkgPT4ge1xyXG5cdFx0XHRpZiAoY3R4LmZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG5cdFx0XHRcdGxpbmtDb252ZXJ0ZXIuY29udmVydFdpa2lsaW5rc0ZvckFzdHJvKGVkaXRvciwgY3R4LmZpbGUpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdH0pO1xyXG5cclxuXHQvLyBSZW5hbWUgQ29udGVudCBjb21tYW5kXHJcblx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0aWQ6IFwicmVuYW1lLWNvbnRlbnRcIixcclxuXHRcdG5hbWU6IFwiUmVuYW1lIEN1cnJlbnQgQ29udGVudFwiLFxyXG5cdFx0aWNvbjogXCJwZW5jaWxcIixcclxuXHRcdGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgYW55KSA9PiB7XHJcblx0XHRcdGlmIChjdHguZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBmaWxlIG1hdGNoZXMgYW55IGNvbmZpZ3VyZWQgY29udGVudCB0eXBlXHJcblx0XHRcdFx0aWYgKCFoYXNNYXRjaGluZ0NvbnRlbnRUeXBlKGN0eC5maWxlLCBzZXR0aW5ncykpIHtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJDYW5ub3QgcmVuYW1lOiBUaGlzIGZpbGUgaXMgbm90IHBhcnQgb2YgYSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZSBmb2xkZXIuXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRcclxuXHRcdFx0XHQvLyBEZXRlcm1pbmUgY29udGVudCB0eXBlIGZyb20gZm9sZGVyIHN0cnVjdHVyZVxyXG5cdFx0XHRcdGNvbnN0IHR5cGUgPSBmaWxlT3BzLmRldGVybWluZVR5cGUoY3R4LmZpbGUpO1xyXG5cdFx0XHRcdGNvbnN0IGNhY2hlID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShjdHguZmlsZSk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0Ly8gR2V0IHRoZSBhcHByb3ByaWF0ZSB0aXRsZSBrZXkgZm9yIHRoaXMgY29udGVudCB0eXBlXHJcblx0XHRcdFx0Y29uc3QgdGl0bGVLZXkgPSBmaWxlT3BzLmdldFRpdGxlS2V5KHR5cGUpO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdC8vIENoZWNrIGlmIHRoZSBmaWxlIGhhcyB0aGUgcmVxdWlyZWQgdGl0bGUgcHJvcGVydHlcclxuXHRcdFx0XHRpZiAoIWNhY2hlPy5mcm9udG1hdHRlciB8fCAhKHRpdGxlS2V5IGluIGNhY2hlLmZyb250bWF0dGVyKSkge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShgQ2Fubm90IHJlbmFtZTogTm8gJHt0aXRsZUtleX0gZm91bmQgaW4gcHJvcGVydGllc2ApO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRcclxuXHRcdFx0XHRuZXcgVGl0bGVNb2RhbChwbHVnaW4uYXBwLCBjdHguZmlsZSwgcGx1Z2luIGFzIGFueSwgdHlwZSwgdHJ1ZSkub3BlbigpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdH0pO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBzdGFuZGFyZGl6ZVByb3BlcnRpZXMoYXBwOiBBcHAsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIGZpbGU6IFRGaWxlLCBwbHVnaW4/OiBhbnkpOiBQcm9taXNlPHZvaWQ+IHtcclxuXHRjb25zdCB0ZW1wbGF0ZVBhcnNlciA9IG5ldyBUZW1wbGF0ZVBhcnNlcihhcHAsIHNldHRpbmdzKTtcclxuXHRjb25zdCBmaWxlT3BzID0gbmV3IEZpbGVPcGVyYXRpb25zKGFwcCwgc2V0dGluZ3MsIHBsdWdpbik7XHJcblx0XHJcblx0Ly8gRGV0ZXJtaW5lIGNvbnRlbnQgdHlwZVxyXG5cdGNvbnN0IHR5cGUgPSBmaWxlT3BzLmRldGVybWluZVR5cGUoZmlsZSk7XHJcblx0bGV0IHRlbXBsYXRlU3RyaW5nOiBzdHJpbmc7XHJcblx0XHJcblx0Ly8gQ2hlY2sgaWYgdGhpcyBmaWxlIG1hdGNoZXMgYW55IGNvbnRlbnQgdHlwZSBjcml0ZXJpYVxyXG5cdGNvbnN0IGZpbGVQYXRoID0gZmlsZS5wYXRoO1xyXG5cdGNvbnN0IHBvc3RzRm9sZGVyID0gc2V0dGluZ3MucG9zdHNGb2xkZXIgfHwgXCJcIjtcclxuXHRjb25zdCBwYWdlc0ZvbGRlciA9IHNldHRpbmdzLmVuYWJsZVBhZ2VzID8gKHNldHRpbmdzLnBhZ2VzRm9sZGVyIHx8IFwiXCIpIDogXCJcIjtcclxuXHRcclxuXHRsZXQgaGFzTWF0Y2hpbmdDb250ZW50VHlwZSA9IGZhbHNlO1xyXG5cdFxyXG5cdC8vIENoZWNrIGlmIGl0J3MgYSBwb3N0XHJcblx0aWYgKHNldHRpbmdzLmF1dG9tYXRlUG9zdENyZWF0aW9uKSB7XHJcblx0XHRpZiAocG9zdHNGb2xkZXIpIHtcclxuXHRcdFx0Ly8gSWYgcG9zdHNGb2xkZXIgaXMgc3BlY2lmaWVkLCBjaGVjayBpZiBmaWxlIGlzIGluIHRoYXQgZm9sZGVyXHJcblx0XHRcdGlmIChmaWxlUGF0aC5zdGFydHNXaXRoKHBvc3RzRm9sZGVyICsgXCIvXCIpIHx8IGZpbGVQYXRoID09PSBwb3N0c0ZvbGRlcikge1xyXG5cdFx0XHRcdGhhc01hdGNoaW5nQ29udGVudFR5cGUgPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBJZiBwb3N0c0ZvbGRlciBpcyBibGFuaywgb25seSB0cmVhdCBmaWxlcyBpbiB2YXVsdCByb290IGFzIHBvc3RzXHJcblx0XHRcdC8vIFRoaXMgaW5jbHVkZXMgYm90aCBkaXJlY3QgZmlsZXMgYW5kIGZvbGRlci1iYXNlZCBwb3N0cyBpbiB2YXVsdCByb290XHJcblx0XHRcdGlmICghZmlsZVBhdGguaW5jbHVkZXMoXCIvXCIpIHx8IChmaWxlUGF0aC5pbmNsdWRlcyhcIi9cIikgJiYgIWZpbGVQYXRoLnN0YXJ0c1dpdGgoXCIvXCIpICYmIGZpbGVQYXRoLnNwbGl0KFwiL1wiKS5sZW5ndGggPT09IDIpKSB7XHJcblx0XHRcdFx0aGFzTWF0Y2hpbmdDb250ZW50VHlwZSA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0Ly8gQ2hlY2sgaWYgaXQncyBhIHBhZ2VcclxuXHRpZiAoIWhhc01hdGNoaW5nQ29udGVudFR5cGUgJiYgc2V0dGluZ3MuZW5hYmxlUGFnZXMpIHtcclxuXHRcdGlmIChwYWdlc0ZvbGRlciAmJiAoZmlsZVBhdGguc3RhcnRzV2l0aChwYWdlc0ZvbGRlciArIFwiL1wiKSB8fCBmaWxlUGF0aCA9PT0gcGFnZXNGb2xkZXIpKSB7XHJcblx0XHRcdGhhc01hdGNoaW5nQ29udGVudFR5cGUgPSB0cnVlO1xyXG5cdFx0fSBlbHNlIGlmICghcGFnZXNGb2xkZXIgJiYgIWZpbGVQYXRoLmluY2x1ZGVzKFwiL1wiKSkge1xyXG5cdFx0XHQvLyBJZiBwYWdlc0ZvbGRlciBpcyBibGFuaywgb25seSB0cmVhdCBmaWxlcyBpbiB2YXVsdCByb290IGFzIHBhZ2VzXHJcblx0XHRcdGhhc01hdGNoaW5nQ29udGVudFR5cGUgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHQvLyBDaGVjayBpZiBpdCdzIGEgY3VzdG9tIGNvbnRlbnQgdHlwZVxyXG5cdGlmICghaGFzTWF0Y2hpbmdDb250ZW50VHlwZSAmJiBmaWxlT3BzLmlzQ3VzdG9tQ29udGVudFR5cGUodHlwZSkpIHtcclxuXHRcdGNvbnN0IGN1c3RvbVR5cGUgPSBmaWxlT3BzLmdldEN1c3RvbUNvbnRlbnRUeXBlKHR5cGUpO1xyXG5cdFx0aWYgKGN1c3RvbVR5cGUgJiYgY3VzdG9tVHlwZS5lbmFibGVkKSB7XHJcblx0XHRcdGhhc01hdGNoaW5nQ29udGVudFR5cGUgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRcclxuXHQvLyBJZiBubyBjb250ZW50IHR5cGUgbWF0Y2hlcywgc2hvdyBub3RpZmljYXRpb24gYW5kIHJldHVyblxyXG5cdGlmICghaGFzTWF0Y2hpbmdDb250ZW50VHlwZSkge1xyXG5cdFx0bmV3IE5vdGljZShcIk5vIHByb3BlcnRpZXMgdGVtcGxhdGUgc3BlY2lmaWVkIGZvciB0aGlzIGNvbnRlbnQuIFRoaXMgZmlsZSBkb2Vzbid0IG1hdGNoIGFueSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZSBmb2xkZXJzLlwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0XHJcblx0Ly8gRGV0ZXJtaW5lIHRlbXBsYXRlIGJhc2VkIG9uIGNvbnRlbnQgdHlwZVxyXG5cdGlmIChmaWxlT3BzLmlzQ3VzdG9tQ29udGVudFR5cGUodHlwZSkpIHtcclxuXHRcdGNvbnN0IGN1c3RvbVR5cGUgPSBmaWxlT3BzLmdldEN1c3RvbUNvbnRlbnRUeXBlKHR5cGUpO1xyXG5cdFx0dGVtcGxhdGVTdHJpbmcgPSBjdXN0b21UeXBlID8gY3VzdG9tVHlwZS50ZW1wbGF0ZSA6IHNldHRpbmdzLmRlZmF1bHRUZW1wbGF0ZTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0Y29uc3QgaXNQYWdlID0gdHlwZSA9PT0gXCJwYWdlXCI7XHJcblx0XHR0ZW1wbGF0ZVN0cmluZyA9IGlzUGFnZSA/IHNldHRpbmdzLnBhZ2VUZW1wbGF0ZSA6IHNldHRpbmdzLmRlZmF1bHRUZW1wbGF0ZTtcclxuXHR9XHJcblxyXG5cdC8vIFdhaXQgYnJpZWZseSB0byBhbGxvdyBlZGl0b3Igc3RhdGUgdG8gc3RhYmlsaXplXHJcblx0YXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMCkpO1xyXG5cclxuXHQvLyBSZS1yZWFkIGNvbnRlbnQgdG8gZW5zdXJlIGxhdGVzdCBzdGF0ZSBhZnRlciBlZGl0b3IgY2hhbmdlc1xyXG5cdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCBhcHAudmF1bHQucmVhZChmaWxlKTtcclxuXHRjb25zdCB0aXRsZSA9IGZpbGUuYmFzZW5hbWUucmVwbGFjZSgvXl8vLCBcIlwiKTtcclxuXHRcclxuXHRjb25zdCBwYXJzZWQgPSBhd2FpdCB0ZW1wbGF0ZVBhcnNlci5wYXJzZUZyb250bWF0dGVyKGNvbnRlbnQpO1xyXG5cdGNvbnN0IHsgdGVtcGxhdGVQcm9wcywgdGVtcGxhdGVWYWx1ZXMgfSA9IHRlbXBsYXRlUGFyc2VyLnBhcnNlVGVtcGxhdGUodGVtcGxhdGVTdHJpbmcsIHRpdGxlKTtcclxuXHJcblx0Ly8gTWVyZ2UgdGVtcGxhdGUgcHJvcGVydGllcyB3aXRoIGV4aXN0aW5nIG9uZXMsIHByZXNlcnZpbmcgYWxsIGV4aXN0aW5nXHJcblx0Y29uc3QgZmluYWxQcm9wczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0geyAuLi5wYXJzZWQucHJvcGVydGllcyB9O1xyXG5cdGNvbnN0IGFycmF5S2V5cyA9IG5ldyBTZXQ8c3RyaW5nPigpOyAvLyBUcmFjayB3aGljaCBrZXlzIGFyZSBhcnJheXNcclxuXHRcclxuXHRmb3IgKGNvbnN0IGtleSBvZiB0ZW1wbGF0ZVByb3BzKSB7XHJcblx0XHRpZiAoIShrZXkgaW4gcGFyc2VkLnByb3BlcnRpZXMpKSB7XHJcblx0XHRcdC8vIFByb3BlcnR5IGRvZXNuJ3QgZXhpc3QsIGFkZCBpdCBmcm9tIHRlbXBsYXRlXHJcblx0XHRcdGNvbnN0IHRlbXBsYXRlVmFsdWUgPSB0ZW1wbGF0ZVZhbHVlc1trZXldO1xyXG5cdFx0XHRpZiAoQXJyYXkuaXNBcnJheSh0ZW1wbGF0ZVZhbHVlKSkge1xyXG5cdFx0XHRcdGZpbmFsUHJvcHNba2V5XSA9IHRlbXBsYXRlVmFsdWU7XHJcblx0XHRcdFx0YXJyYXlLZXlzLmFkZChrZXkpOyAvLyBNYXJrIGFzIGFycmF5XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0ZmluYWxQcm9wc1trZXldID0gW3RlbXBsYXRlVmFsdWUgfHwgXCJcIl07XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIFByb3BlcnR5IGV4aXN0cywgY2hlY2sgaWYgaXQncyBhbiBhcnJheSB0eXBlXHJcblx0XHRcdGNvbnN0IHRlbXBsYXRlVmFsdWUgPSB0ZW1wbGF0ZVZhbHVlc1trZXldO1xyXG5cdFx0XHRjb25zdCBpc0FycmF5VmFsdWUgPSBBcnJheS5pc0FycmF5KHRlbXBsYXRlVmFsdWUpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYgKGlzQXJyYXlWYWx1ZSkge1xyXG5cdFx0XHRcdC8vIFRoaXMgaXMgYW4gYXJyYXkgcHJvcGVydHkgLSBwcmVzZXJ2ZSBleGlzdGluZyB2YWx1ZXMgYW5kIG1lcmdlIHdpdGggdGVtcGxhdGVcclxuXHRcdFx0XHRjb25zdCBleGlzdGluZ0l0ZW1zID0gcGFyc2VkLnByb3BlcnRpZXNba2V5XSB8fCBbXTtcclxuXHRcdFx0XHRjb25zdCBuZXdJdGVtcyA9IHRlbXBsYXRlVmFsdWUuZmlsdGVyKGl0ZW0gPT4gIWV4aXN0aW5nSXRlbXMuaW5jbHVkZXMoaXRlbSkpO1xyXG5cdFx0XHRcdGZpbmFsUHJvcHNba2V5XSA9IFsuLi5leGlzdGluZ0l0ZW1zLCAuLi5uZXdJdGVtc107XHJcblx0XHRcdFx0YXJyYXlLZXlzLmFkZChrZXkpOyAvLyBNYXJrIGFzIGFycmF5XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gRm9yIG5vbi1hcnJheSB2YWx1ZXMsIGtlZXAgZXhpc3RpbmcgdmFsdWUgKGRvbid0IG92ZXJ3cml0ZSlcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIEFsc28gYWRkIGFueSBleGlzdGluZyBhcnJheSBrZXlzIHRoYXQgd2VyZW4ndCBpbiB0aGUgdGVtcGxhdGVcclxuXHRmb3IgKGNvbnN0IGtleSBpbiBwYXJzZWQucHJvcGVydGllcykge1xyXG5cdFx0aWYgKHBhcnNlZC5wcm9wZXJ0aWVzW2tleV0ubGVuZ3RoID4gMSkge1xyXG5cdFx0XHRhcnJheUtleXMuYWRkKGtleSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRjb25zdCBuZXdDb250ZW50ID0gdGVtcGxhdGVQYXJzZXIuYnVpbGRGcm9udG1hdHRlckNvbnRlbnQoZmluYWxQcm9wcywgYXJyYXlLZXlzKSArIHBhcnNlZC5ib2R5Q29udGVudDtcclxuXHJcblx0YXdhaXQgYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcclxuXHRuZXcgTm90aWNlKFwiUHJvcGVydGllcyBzdGFuZGFyZGl6ZWQgdXNpbmcgdGVtcGxhdGUuXCIpO1xyXG59XHJcbiIsICJpbXBvcnQgeyBBcHAsIFRGaWxlLCBURm9sZGVyLCBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEFzdHJvQ29tcG9zZXJTZXR0aW5ncywgUG9zdFR5cGUsIEZpbGVDcmVhdGlvbk9wdGlvbnMsIFJlbmFtZU9wdGlvbnMsIEN1c3RvbUNvbnRlbnRUeXBlIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5cbmV4cG9ydCBjbGFzcyBGaWxlT3BlcmF0aW9ucyB7XG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgYXBwOiBBcHAsIHByaXZhdGUgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncywgcHJpdmF0ZSBwbHVnaW4/OiBhbnkpIHt9XG5cblx0dG9LZWJhYkNhc2Uoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdHJldHVybiBzdHJcblx0XHRcdC50b0xvd2VyQ2FzZSgpXG5cdFx0XHQucmVwbGFjZSgvW15hLXowLTlcXHMtXS9nLCBcIlwiKVxuXHRcdFx0LnRyaW0oKVxuXHRcdFx0LnJlcGxhY2UoL1xccysvZywgXCItXCIpXG5cdFx0XHQucmVwbGFjZSgvLSsvZywgXCItXCIpXG5cdFx0XHQucmVwbGFjZSgvXi18LSQvZywgXCJcIik7XG5cdH1cblxuXHRnZW5lcmF0ZUZpbGVuYW1lKHRpdGxlOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGtlYmFiVGl0bGUgPSB0aGlzLnRvS2ViYWJDYXNlKHRpdGxlKTtcblx0XHRjb25zdCBwcmVmaXggPSB0aGlzLnNldHRpbmdzLmVuYWJsZVVuZGVyc2NvcmVQcmVmaXggPyBcIl9cIiA6IFwiXCI7XG5cdFx0cmV0dXJuIGAke3ByZWZpeH0ke2tlYmFiVGl0bGV9YDtcblx0fVxuXG5cdGRldGVybWluZVR5cGUoZmlsZTogVEZpbGUpOiBQb3N0VHlwZSB8IHN0cmluZyB7XG5cdFx0Y29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGg7XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgY3VzdG9tIGNvbnRlbnQgdHlwZXMgZmlyc3Rcblx0XHRmb3IgKGNvbnN0IGN1c3RvbVR5cGUgb2YgdGhpcy5zZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXMpIHtcblx0XHRcdGlmIChjdXN0b21UeXBlLmVuYWJsZWQgJiYgY3VzdG9tVHlwZS5mb2xkZXIgJiYgXG5cdFx0XHRcdChmaWxlUGF0aC5zdGFydHNXaXRoKGN1c3RvbVR5cGUuZm9sZGVyICsgXCIvXCIpIHx8IGZpbGVQYXRoID09PSBjdXN0b21UeXBlLmZvbGRlcikpIHtcblx0XHRcdFx0cmV0dXJuIGN1c3RvbVR5cGUuaWQ7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENoZWNrIHBhZ2VzXG5cdFx0Y29uc3QgcGFnZXNGb2xkZXIgPSB0aGlzLnNldHRpbmdzLnBhZ2VzRm9sZGVyIHx8IFwiXCI7XG5cdFx0bGV0IGlzUGFnZSA9IGZhbHNlO1xuXHRcdGlmICh0aGlzLnNldHRpbmdzLmVuYWJsZVBhZ2VzKSB7XG5cdFx0XHRpZiAocGFnZXNGb2xkZXIpIHtcblx0XHRcdFx0Ly8gSWYgcGFnZXNGb2xkZXIgaXMgc3BlY2lmaWVkLCBjaGVjayBpZiBmaWxlIGlzIGluIHRoYXQgZm9sZGVyXG5cdFx0XHRcdGlzUGFnZSA9IGZpbGVQYXRoLnN0YXJ0c1dpdGgocGFnZXNGb2xkZXIgKyBcIi9cIikgfHwgZmlsZVBhdGggPT09IHBhZ2VzRm9sZGVyO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gSWYgcGFnZXNGb2xkZXIgaXMgYmxhbmssIG9ubHkgdHJlYXQgZmlsZXMgaW4gdmF1bHQgcm9vdCBhcyBwYWdlc1xuXHRcdFx0XHRpc1BhZ2UgPSAhZmlsZVBhdGguaW5jbHVkZXMoXCIvXCIpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAoaXNQYWdlKSByZXR1cm4gXCJwYWdlXCI7XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgcG9zdHNcblx0XHRjb25zdCBwb3N0c0ZvbGRlciA9IHRoaXMuc2V0dGluZ3MucG9zdHNGb2xkZXIgfHwgXCJcIjtcblx0XHRsZXQgaXNQb3N0ID0gZmFsc2U7XG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MuYXV0b21hdGVQb3N0Q3JlYXRpb24pIHtcblx0XHRcdGlmIChwb3N0c0ZvbGRlcikge1xuXHRcdFx0XHQvLyBJZiBwb3N0c0ZvbGRlciBpcyBzcGVjaWZpZWQsIGNoZWNrIGlmIGZpbGUgaXMgaW4gdGhhdCBmb2xkZXJcblx0XHRcdFx0aXNQb3N0ID0gZmlsZVBhdGguc3RhcnRzV2l0aChwb3N0c0ZvbGRlciArIFwiL1wiKSB8fCBmaWxlUGF0aCA9PT0gcG9zdHNGb2xkZXI7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIElmIHBvc3RzRm9sZGVyIGlzIGJsYW5rLCBvbmx5IHRyZWF0IGZpbGVzIGluIHZhdWx0IHJvb3QgYXMgcG9zdHNcblx0XHRcdGlzUG9zdCA9ICFmaWxlUGF0aC5pbmNsdWRlcyhcIi9cIik7XG5cdFx0fVxuXHRcdH1cblx0XHRpZiAoaXNQb3N0KSByZXR1cm4gXCJwb3N0XCI7XG5cdFx0XG5cdFx0Ly8gSWYgbm8gZm9sZGVyIHN0cnVjdHVyZSBtYXRjaGVzLCByZXR1cm4gXCJub3RlXCIgYXMgZmFsbGJhY2tcblx0XHRyZXR1cm4gXCJub3RlXCI7XG5cdH1cblxuXHRnZXRDdXN0b21Db250ZW50VHlwZSh0eXBlSWQ6IHN0cmluZyk6IEN1c3RvbUNvbnRlbnRUeXBlIHwgbnVsbCB7XG5cdFx0cmV0dXJuIHRoaXMuc2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzLmZpbmQoY3QgPT4gY3QuaWQgPT09IHR5cGVJZCkgfHwgbnVsbDtcblx0fVxuXG5cdGlzQ3VzdG9tQ29udGVudFR5cGUodHlwZTogUG9zdFR5cGUgfCBzdHJpbmcpOiBib29sZWFuIHtcblx0XHRyZXR1cm4gdHlwZSAhPT0gXCJwb3N0XCIgJiYgdHlwZSAhPT0gXCJwYWdlXCI7XG5cdH1cblxuXHRnZXRUaXRsZUtleSh0eXBlOiBQb3N0VHlwZSB8IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gRm9yIGdlbmVyaWMgbm90ZXMsIGFsd2F5cyB1c2UgXCJ0aXRsZVwiXG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSByZXR1cm4gXCJ0aXRsZVwiO1xuXHRcdFxuXHRcdGxldCB0ZW1wbGF0ZTogc3RyaW5nO1xuXHRcdFxuXHRcdGlmICh0aGlzLmlzQ3VzdG9tQ29udGVudFR5cGUodHlwZSkpIHtcblx0XHRcdGNvbnN0IGN1c3RvbVR5cGUgPSB0aGlzLmdldEN1c3RvbUNvbnRlbnRUeXBlKHR5cGUpO1xuXHRcdFx0aWYgKCFjdXN0b21UeXBlKSByZXR1cm4gXCJ0aXRsZVwiO1xuXHRcdFx0dGVtcGxhdGUgPSBjdXN0b21UeXBlLnRlbXBsYXRlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0ZW1wbGF0ZSA9IHR5cGUgPT09IFwicG9zdFwiID8gdGhpcy5zZXR0aW5ncy5kZWZhdWx0VGVtcGxhdGUgOiB0aGlzLnNldHRpbmdzLnBhZ2VUZW1wbGF0ZTtcblx0XHR9XG5cdFx0XG5cdFx0Y29uc3QgbGluZXMgPSB0ZW1wbGF0ZS5zcGxpdChcIlxcblwiKTtcblx0XHRsZXQgaW5Qcm9wZXJ0aWVzID0gZmFsc2U7XG5cdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRjb25zdCB0cmltbWVkID0gbGluZS50cmltKCk7XG5cdFx0XHRpZiAodHJpbW1lZCA9PT0gXCItLS1cIikge1xuXHRcdFx0XHRpblByb3BlcnRpZXMgPSAhaW5Qcm9wZXJ0aWVzO1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblx0XHRcdGlmIChpblByb3BlcnRpZXMpIHtcblx0XHRcdFx0Y29uc3QgbWF0Y2ggPSB0cmltbWVkLm1hdGNoKC9eKFxcdyspOlxccyooLispJC8pO1xuXHRcdFx0XHRpZiAobWF0Y2gpIHtcblx0XHRcdFx0XHRjb25zdCBrZXkgPSBtYXRjaFsxXTtcblx0XHRcdFx0XHRjb25zdCB2YWx1ZSA9IG1hdGNoWzJdO1xuXHRcdFx0XHRcdGlmICh2YWx1ZS5pbmNsdWRlcyhcInt7dGl0bGV9fVwiKSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGtleTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIFwidGl0bGVcIjtcblx0fVxuXG5cdGFzeW5jIGNyZWF0ZUZpbGUob3B0aW9uczogRmlsZUNyZWF0aW9uT3B0aW9ucyk6IFByb21pc2U8VEZpbGUgfCBudWxsPiB7XG5cdFx0Y29uc3QgeyBmaWxlLCB0aXRsZSwgdHlwZSB9ID0gb3B0aW9ucztcblx0XHRcblx0XHRpZiAoIXRpdGxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBUaXRsZSBpcyByZXF1aXJlZCB0byBjcmVhdGUgYSAke3R5cGV9LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Y29uc3Qga2ViYWJUaXRsZSA9IHRoaXMudG9LZWJhYkNhc2UodGl0bGUpO1xuXHRcdGNvbnN0IHByZWZpeCA9IHRoaXMuc2V0dGluZ3MuZW5hYmxlVW5kZXJzY29yZVByZWZpeCA/IFwiX1wiIDogXCJcIjtcblxuXHRcdGxldCB0YXJnZXRGb2xkZXIgPSBcIlwiO1xuXHRcdGlmICh0eXBlID09PSBcIm5vdGVcIikge1xuXHRcdFx0Ly8gRm9yIGdlbmVyaWMgbm90ZXMsIGtlZXAgdGhlbSBpbiB0aGVpciBjdXJyZW50IGxvY2F0aW9uXG5cdFx0XHR0YXJnZXRGb2xkZXIgPSBcIlwiO1xuXHRcdH0gZWxzZSBpZiAodGhpcy5pc0N1c3RvbUNvbnRlbnRUeXBlKHR5cGUpKSB7XG5cdFx0XHRjb25zdCBjdXN0b21UeXBlID0gdGhpcy5nZXRDdXN0b21Db250ZW50VHlwZSh0eXBlKTtcblx0XHRcdC8vIEdldCB0aGUgZGlyZWN0b3J5IHdoZXJlIHRoZSB1c2VyIGNyZWF0ZWQgdGhlIGZpbGVcblx0XHRcdGNvbnN0IG9yaWdpbmFsRGlyID0gZmlsZS5wYXJlbnQ/LnBhdGggfHwgXCJcIjtcblx0XHRcdFxuXHRcdFx0Ly8gRm9yIGN1c3RvbSBjb250ZW50IHR5cGVzLCByZXNwZWN0IHRoZSB1c2VyJ3MgY2hvc2VuIGxvY2F0aW9uIChzdWJmb2xkZXIpXG5cdFx0XHQvLyBPbmx5IHVzZSB0aGUgY29uZmlndXJlZCBmb2xkZXIgaWYgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZSBpbiB0aGUgdmF1bHQgcm9vdFxuXHRcdFx0aWYgKG9yaWdpbmFsRGlyID09PSBcIlwiIHx8IG9yaWdpbmFsRGlyID09PSBcIi9cIikge1xuXHRcdFx0XHR0YXJnZXRGb2xkZXIgPSBjdXN0b21UeXBlID8gY3VzdG9tVHlwZS5mb2xkZXIgOiBcIlwiO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGFyZ2V0Rm9sZGVyID0gb3JpZ2luYWxEaXI7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEZvciBwb3N0cyBhbmQgcGFnZXMsIHJlc3BlY3Qgd2hlcmUgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZVxuXHRcdFx0Y29uc3QgcG9zdHNGb2xkZXIgPSB0aGlzLnNldHRpbmdzLnBvc3RzRm9sZGVyIHx8IFwiXCI7XG5cdFx0XHRjb25zdCBwYWdlc0ZvbGRlciA9IHRoaXMuc2V0dGluZ3MucGFnZXNGb2xkZXIgfHwgXCJcIjtcblx0XHRcdFxuXHRcdFx0Ly8gR2V0IHRoZSBkaXJlY3Rvcnkgd2hlcmUgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZVxuXHRcdFx0Y29uc3Qgb3JpZ2luYWxEaXIgPSBmaWxlLnBhcmVudD8ucGF0aCB8fCBcIlwiO1xuXHRcdFx0XG5cdFx0XHQvLyBJZiB0aGUgZmlsZSBpcyBpbiB2YXVsdCByb290LCBkb24ndCBzZXQgYSB0YXJnZXQgZm9sZGVyIChrZWVwIGl0IGluIHJvb3QpXG5cdFx0XHRpZiAob3JpZ2luYWxEaXIgPT09IFwiXCIgfHwgb3JpZ2luYWxEaXIgPT09IFwiL1wiKSB7XG5cdFx0XHRcdHRhcmdldEZvbGRlciA9IFwiXCI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0YXJnZXRGb2xkZXIgPSBvcmlnaW5hbERpcjtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0aWYgKHRhcmdldEZvbGRlcikge1xuXHRcdFx0Y29uc3QgZm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRhcmdldEZvbGRlcik7XG5cdFx0XHRpZiAoIShmb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyKSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIodGFyZ2V0Rm9sZGVyKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAodGhpcy5zZXR0aW5ncy5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIpIHtcblx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUZvbGRlclN0cnVjdHVyZShmaWxlLCBrZWJhYlRpdGxlLCBwcmVmaXgsIHRhcmdldEZvbGRlciwgdHlwZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUZpbGVTdHJ1Y3R1cmUoZmlsZSwga2ViYWJUaXRsZSwgcHJlZml4LCB0YXJnZXRGb2xkZXIpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgY3JlYXRlRm9sZGVyU3RydWN0dXJlKGZpbGU6IFRGaWxlLCBrZWJhYlRpdGxlOiBzdHJpbmcsIHByZWZpeDogc3RyaW5nLCB0YXJnZXRGb2xkZXI6IHN0cmluZywgdHlwZTogUG9zdFR5cGUgfCBzdHJpbmcpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGNvbnN0IGZvbGRlck5hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfWA7XG5cdFx0bGV0IGZvbGRlclBhdGg6IHN0cmluZztcblx0XHRcblx0XHRpZiAodGFyZ2V0Rm9sZGVyKSB7XG5cdFx0XHQvLyBNb3ZlIHRvIHRhcmdldCBmb2xkZXJcblx0XHRcdGZvbGRlclBhdGggPSBgJHt0YXJnZXRGb2xkZXJ9LyR7Zm9sZGVyTmFtZX1gO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBLZWVwIGluIGN1cnJlbnQgbG9jYXRpb25cblx0XHRcdGNvbnN0IGN1cnJlbnREaXIgPSBmaWxlLnBhcmVudCA/IGZpbGUucGFyZW50LnBhdGggOiBcIlwiO1xuXHRcdFx0aWYgKGN1cnJlbnREaXIgJiYgY3VycmVudERpciAhPT0gXCIvXCIpIHtcblx0XHRcdFx0Zm9sZGVyUGF0aCA9IGAke2N1cnJlbnREaXJ9LyR7Zm9sZGVyTmFtZX1gO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRmlsZSBpcyBpbiB2YXVsdCByb290LCBqdXN0IHVzZSBmb2xkZXIgbmFtZVxuXHRcdFx0XHRmb2xkZXJQYXRoID0gZm9sZGVyTmFtZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgZm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZvbGRlclBhdGgpO1xuXHRcdFx0aWYgKCEoZm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlRm9sZGVyKGZvbGRlclBhdGgpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHQvLyBGb2xkZXIgbWlnaHQgYWxyZWFkeSBleGlzdCwgcHJvY2VlZFxuXHRcdH1cblxuXHRcdGNvbnN0IGluZGV4RmlsZU5hbWUgPSB0aGlzLnNldHRpbmdzLmluZGV4RmlsZU5hbWUgfHwgXCJpbmRleFwiO1xuXHRcdGNvbnN0IGZpbGVOYW1lID0gYCR7aW5kZXhGaWxlTmFtZX0ubWRgO1xuXHRcdGNvbnN0IG5ld1BhdGggPSBgJHtmb2xkZXJQYXRofS8ke2ZpbGVOYW1lfWA7XG5cblx0XHRjb25zdCBleGlzdGluZ0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3UGF0aCk7XG5cdFx0aWYgKGV4aXN0aW5nRmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBGaWxlIGFscmVhZHkgZXhpc3RzIGF0ICR7bmV3UGF0aH0uYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQucmVuYW1lKGZpbGUsIG5ld1BhdGgpO1xuXHRcdFx0Y29uc3QgbmV3RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdQYXRoKTtcblx0XHRcdGlmICghKG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWxlRXhwbG9yZXIgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwiZmlsZS1leHBsb3JlclwiKVswXTtcblx0XHRcdFx0aWYgKGZpbGVFeHBsb3JlciAmJiBmaWxlRXhwbG9yZXIudmlldykge1xuXHRcdFx0XHRcdGNvbnN0IGZpbGVUcmVlID0gKGZpbGVFeHBsb3Jlci52aWV3IGFzIGFueSkudHJlZTtcblx0XHRcdFx0XHRpZiAoZmlsZVRyZWUgJiYgbmV3RmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIHR5cGVvZiBmaWxlVHJlZS5yZXZlYWxGaWxlID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdFx0XHRmaWxlVHJlZS5yZXZlYWxGaWxlKG5ld0ZpbGUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSwgMjAwKTtcblxuXHRcdFx0Y29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcblx0XHRcdGF3YWl0IGxlYWYub3BlbkZpbGUobmV3RmlsZSk7XG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gY3JlYXRlIGZvbGRlciBzdHJ1Y3R1cmU6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfS5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgY3JlYXRlRmlsZVN0cnVjdHVyZShmaWxlOiBURmlsZSwga2ViYWJUaXRsZTogc3RyaW5nLCBwcmVmaXg6IHN0cmluZywgdGFyZ2V0Rm9sZGVyOiBzdHJpbmcpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGNvbnN0IG5ld05hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfS5tZGA7XG5cdFx0bGV0IG5ld1BhdGg6IHN0cmluZztcblx0XHRcblx0XHRpZiAodGFyZ2V0Rm9sZGVyKSB7XG5cdFx0XHQvLyBNb3ZlIHRvIHRhcmdldCBmb2xkZXJcblx0XHRcdG5ld1BhdGggPSBgJHt0YXJnZXRGb2xkZXJ9LyR7bmV3TmFtZX1gO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBLZWVwIGluIGN1cnJlbnQgbG9jYXRpb24sIGp1c3QgcmVuYW1lIHRoZSBmaWxlXG5cdFx0XHRjb25zdCBjdXJyZW50RGlyID0gZmlsZS5wYXJlbnQgPyBmaWxlLnBhcmVudC5wYXRoIDogXCJcIjtcblx0XHRcdGlmIChjdXJyZW50RGlyICYmIGN1cnJlbnREaXIgIT09IFwiL1wiKSB7XG5cdFx0XHRcdG5ld1BhdGggPSBgJHtjdXJyZW50RGlyfS8ke25ld05hbWV9YDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZpbGUgaXMgaW4gdmF1bHQgcm9vdCwganVzdCB1c2UgbmV3IG5hbWVcblx0XHRcdFx0bmV3UGF0aCA9IG5ld05hbWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Y29uc3QgZXhpc3RpbmdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdGlmIChleGlzdGluZ0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBleGlzdGluZ0ZpbGUgIT09IGZpbGUpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEZpbGUgd2l0aCBuYW1lIFwiJHtuZXdOYW1lfVwiIGFscmVhZHkgZXhpc3RzLmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlbmFtZShmaWxlLCBuZXdQYXRoKTtcblx0XHRcdGNvbnN0IG5ld0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3UGF0aCk7XG5cdFx0XHRpZiAoIShuZXdGaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBUcmFjayB0aGF0IHRoaXMgZmlsZSB3YXMgY3JlYXRlZCBieSB0aGUgcGx1Z2luIHRvIGF2b2lkIHRyaWdnZXJpbmcgdGhlIGNyZWF0ZSBldmVudFxuXHRcdFx0aWYgKHRoaXMucGx1Z2luICYmICdwbHVnaW5DcmVhdGVkRmlsZXMnIGluIHRoaXMucGx1Z2luKSB7XG5cdFx0XHRcdCh0aGlzLnBsdWdpbiBhcyBhbnkpLnBsdWdpbkNyZWF0ZWRGaWxlcy5hZGQobmV3UGF0aCk7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSk7XG5cdFx0XHRhd2FpdCBsZWFmLm9wZW5GaWxlKG5ld0ZpbGUpO1xuXG5cdFx0XHRyZXR1cm4gbmV3RmlsZTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIHJlbmFtZSBmaWxlOiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX0uYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHRhc3luYyByZW5hbWVGaWxlKG9wdGlvbnM6IFJlbmFtZU9wdGlvbnMpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGNvbnN0IHsgZmlsZSwgdGl0bGUsIHR5cGUgfSA9IG9wdGlvbnM7XG5cdFx0XG5cdFx0aWYgKCF0aXRsZSkge1xuXHRcdFx0bmV3IE5vdGljZShgVGl0bGUgaXMgcmVxdWlyZWQgdG8gcmVuYW1lIHRoZSBjb250ZW50LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Y29uc3Qga2ViYWJUaXRsZSA9IHRoaXMudG9LZWJhYkNhc2UodGl0bGUpO1xuXHRcdGNvbnN0IHByZWZpeCA9IFwiXCI7XG5cblx0XHRpZiAodGhpcy5zZXR0aW5ncy5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIpIHtcblx0XHRcdHJldHVybiB0aGlzLnJlbmFtZUZvbGRlclN0cnVjdHVyZShmaWxlLCBrZWJhYlRpdGxlLCBwcmVmaXgsIHR5cGUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5yZW5hbWVGaWxlU3RydWN0dXJlKGZpbGUsIGtlYmFiVGl0bGUsIHByZWZpeCk7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyByZW5hbWVGb2xkZXJTdHJ1Y3R1cmUoZmlsZTogVEZpbGUsIGtlYmFiVGl0bGU6IHN0cmluZywgcHJlZml4OiBzdHJpbmcsIHR5cGU6IFBvc3RUeXBlIHwgc3RyaW5nKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IHRyZWF0IGFzIGluZGV4IGlmIGZpbGVuYW1lIG1hdGNoZXMgdGhlIGluZGV4IGZpbGUgbmFtZVxuXHRcdC8vIERlZmF1bHQgdG8gXCJpbmRleFwiIHdoZW4gaW5kZXhGaWxlTmFtZSBpcyBibGFua1xuXHRcdGNvbnN0IGluZGV4RmlsZU5hbWUgPSB0aGlzLnNldHRpbmdzLmluZGV4RmlsZU5hbWUgfHwgXCJpbmRleFwiO1xuXHRcdGNvbnN0IGlzSW5kZXggPSBmaWxlLmJhc2VuYW1lID09PSBpbmRleEZpbGVOYW1lO1xuXHRcdGlmIChpc0luZGV4KSB7XG5cdFx0XHRpZiAoIWZpbGUucGFyZW50KSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJDYW5ub3QgcmVuYW1lOiBGaWxlIGhhcyBubyBwYXJlbnQgZm9sZGVyLlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHRwcmVmaXggPSBmaWxlLnBhcmVudC5uYW1lLnN0YXJ0c1dpdGgoXCJfXCIpID8gXCJfXCIgOiBcIlwiO1xuXHRcdFx0Y29uc3QgbmV3Rm9sZGVyTmFtZSA9IGAke3ByZWZpeH0ke2tlYmFiVGl0bGV9YDtcblx0XHRcdGNvbnN0IHBhcmVudEZvbGRlciA9IGZpbGUucGFyZW50LnBhcmVudDtcblx0XHRcdGlmICghcGFyZW50Rm9sZGVyKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJDYW5ub3QgcmVuYW1lOiBQYXJlbnQgZm9sZGVyIGhhcyBubyBwYXJlbnQuXCIpO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblx0XHRcdGNvbnN0IG5ld0ZvbGRlclBhdGggPSBgJHtwYXJlbnRGb2xkZXIucGF0aH0vJHtuZXdGb2xkZXJOYW1lfWA7XG5cblx0XHRcdGNvbnN0IGV4aXN0aW5nRm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld0ZvbGRlclBhdGgpO1xuXHRcdFx0aWYgKGV4aXN0aW5nRm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGb2xkZXIgYWxyZWFkeSBleGlzdHMgYXQgJHtuZXdGb2xkZXJQYXRofS5gKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlbmFtZShmaWxlLnBhcmVudCwgbmV3Rm9sZGVyUGF0aCk7XG5cdFx0XHRjb25zdCBuZXdGaWxlUGF0aCA9IGAke25ld0ZvbGRlclBhdGh9LyR7ZmlsZS5uYW1lfWA7XG5cdFx0XHRjb25zdCBuZXdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld0ZpbGVQYXRoKTtcblx0XHRcdGlmICghKG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdFx0bmV3IE5vdGljZShcIkZhaWxlZCB0byBsb2NhdGUgcmVuYW1lZCBmaWxlLlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbmV3RmlsZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKCFmaWxlLnBhcmVudCkge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogRmlsZSBoYXMgbm8gcGFyZW50IGZvbGRlci5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdFx0cHJlZml4ID0gZmlsZS5iYXNlbmFtZS5zdGFydHNXaXRoKFwiX1wiKSA/IFwiX1wiIDogXCJcIjtcblx0XHRcdGNvbnN0IG5ld05hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfS5tZGA7XG5cdFx0XHRjb25zdCBuZXdQYXRoID0gYCR7ZmlsZS5wYXJlbnQucGF0aH0vJHtuZXdOYW1lfWA7XG5cblx0XHRcdGNvbnN0IGV4aXN0aW5nRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdQYXRoKTtcblx0XHRcdGlmIChleGlzdGluZ0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBleGlzdGluZ0ZpbGUgIT09IGZpbGUpIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRmlsZSBhbHJlYWR5IGV4aXN0cyBhdCAke25ld1BhdGh9LmApO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQucmVuYW1lKGZpbGUsIG5ld1BhdGgpO1xuXHRcdFx0Y29uc3QgbmV3RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdQYXRoKTtcblx0XHRcdGlmICghKG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdFx0bmV3IE5vdGljZShcIkZhaWxlZCB0byBsb2NhdGUgcmVuYW1lZCBmaWxlLlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbmV3RmlsZTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHJlbmFtZUZpbGVTdHJ1Y3R1cmUoZmlsZTogVEZpbGUsIGtlYmFiVGl0bGU6IHN0cmluZywgcHJlZml4OiBzdHJpbmcpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGlmICghZmlsZS5wYXJlbnQpIHtcblx0XHRcdG5ldyBOb3RpY2UoXCJDYW5ub3QgcmVuYW1lOiBGaWxlIGhhcyBubyBwYXJlbnQgZm9sZGVyLlwiKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDaGVjayBpZiB0aGlzIGlzIGFuIGluZGV4IGZpbGUgLSBpZiBzbywgcmVuYW1lIHRoZSBwYXJlbnQgZm9sZGVyIGluc3RlYWRcblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IG9ubHkgdHJlYXQgYXMgaW5kZXggaWYgaW5kZXhGaWxlTmFtZSBpcyBzcGVjaWZpZWQgYW5kIG1hdGNoZXNcblx0XHRjb25zdCBpc0luZGV4ID0gdGhpcy5zZXR0aW5ncy5pbmRleEZpbGVOYW1lICYmIFxuXHRcdFx0dGhpcy5zZXR0aW5ncy5pbmRleEZpbGVOYW1lLnRyaW0oKSAhPT0gXCJcIiAmJiBcblx0XHRcdGZpbGUuYmFzZW5hbWUgPT09IHRoaXMuc2V0dGluZ3MuaW5kZXhGaWxlTmFtZTtcblx0XHRpZiAoaXNJbmRleCkge1xuXHRcdFx0cHJlZml4ID0gZmlsZS5wYXJlbnQubmFtZS5zdGFydHNXaXRoKFwiX1wiKSA/IFwiX1wiIDogXCJcIjtcblx0XHRcdGNvbnN0IG5ld0ZvbGRlck5hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfWA7XG5cdFx0XHRjb25zdCBwYXJlbnRGb2xkZXIgPSBmaWxlLnBhcmVudC5wYXJlbnQ7XG5cdFx0XHRpZiAoIXBhcmVudEZvbGRlcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogUGFyZW50IGZvbGRlciBoYXMgbm8gcGFyZW50LlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHRjb25zdCBuZXdGb2xkZXJQYXRoID0gYCR7cGFyZW50Rm9sZGVyLnBhdGh9LyR7bmV3Rm9sZGVyTmFtZX1gO1xuXG5cdFx0XHRjb25zdCBleGlzdGluZ0ZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdGb2xkZXJQYXRoKTtcblx0XHRcdGlmIChleGlzdGluZ0ZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRm9sZGVyIGFscmVhZHkgZXhpc3RzIGF0ICR7bmV3Rm9sZGVyUGF0aH0uYCk7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5yZW5hbWUoZmlsZS5wYXJlbnQsIG5ld0ZvbGRlclBhdGgpO1xuXHRcdFx0Y29uc3QgbmV3RmlsZVBhdGggPSBgJHtuZXdGb2xkZXJQYXRofS8ke2ZpbGUubmFtZX1gO1xuXHRcdFx0Y29uc3QgbmV3RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdGaWxlUGF0aCk7XG5cdFx0XHRpZiAoIShuZXdGaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJGYWlsZWQgdG8gbG9jYXRlIHJlbmFtZWQgZmlsZS5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIG5ld0ZpbGU7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEZvciBub24taW5kZXggZmlsZXMsIHJlbmFtZSB0aGUgZmlsZSBpdHNlbGZcblx0XHRwcmVmaXggPSBmaWxlLmJhc2VuYW1lLnN0YXJ0c1dpdGgoXCJfXCIpID8gXCJfXCIgOiBcIlwiO1xuXHRcdGNvbnN0IG5ld05hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfS5tZGA7XG5cdFx0Y29uc3QgbmV3UGF0aCA9IGAke2ZpbGUucGFyZW50LnBhdGh9LyR7bmV3TmFtZX1gO1xuXG5cdFx0Y29uc3QgZXhpc3RpbmdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdGlmIChleGlzdGluZ0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBleGlzdGluZ0ZpbGUgIT09IGZpbGUpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEZpbGUgYWxyZWFkeSBleGlzdHMgYXQgJHtuZXdQYXRofS5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlbmFtZShmaWxlLCBuZXdQYXRoKTtcblx0XHRjb25zdCBuZXdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdGlmICghKG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdG5ldyBOb3RpY2UoXCJGYWlsZWQgdG8gbG9jYXRlIHJlbmFtZWQgZmlsZS5cIik7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdFx0cmV0dXJuIG5ld0ZpbGU7XG5cdH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIFRGaWxlLCBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzLCBQb3N0VHlwZSwgUGFyc2VkRnJvbnRtYXR0ZXIsIFRlbXBsYXRlVmFsdWVzLCBLTk9XTl9BUlJBWV9LRVlTLCBDdXN0b21Db250ZW50VHlwZSB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFRlbXBsYXRlUGFyc2VyIHtcclxuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcDogQXBwLCBwcml2YXRlIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpIHt9XHJcblxyXG5cdGFzeW5jIHBhcnNlRnJvbnRtYXR0ZXIoY29udGVudDogc3RyaW5nKTogUHJvbWlzZTxQYXJzZWRGcm9udG1hdHRlcj4ge1xyXG5cdFx0bGV0IHByb3BlcnRpZXNFbmQgPSAwO1xyXG5cdFx0bGV0IHByb3BlcnRpZXNUZXh0ID0gXCJcIjtcclxuXHRcdGNvbnN0IGV4aXN0aW5nUHJvcGVydGllczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0ge307XHJcblxyXG5cdFx0Ly8gUGFyc2UgZXhpc3RpbmcgcHJvcGVydGllcyB3aXRoIGZhbGxiYWNrIGZvciBtaXNzaW5nIHNlY29uZCAtLS1cclxuXHRcdGlmIChjb250ZW50LnN0YXJ0c1dpdGgoXCItLS1cIikpIHtcclxuXHRcdFx0cHJvcGVydGllc0VuZCA9IGNvbnRlbnQuaW5kZXhPZihcIlxcbi0tLVwiLCAzKTtcclxuXHRcdFx0aWYgKHByb3BlcnRpZXNFbmQgPT09IC0xKSB7XHJcblx0XHRcdFx0cHJvcGVydGllc0VuZCA9IGNvbnRlbnQubGVuZ3RoOyAvLyBUcmVhdCBlbnRpcmUgY29udGVudCBhcyBmcm9udG1hdHRlciBpZiBubyBzZWNvbmQgLS0tXHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cHJvcGVydGllc0VuZCArPSA0OyAvLyBNb3ZlIHBhc3QgdGhlIHNlY29uZCAtLS1cclxuXHRcdFx0fVxyXG5cdFx0XHRwcm9wZXJ0aWVzVGV4dCA9IGNvbnRlbnQuc2xpY2UoNCwgcHJvcGVydGllc0VuZCAtIDQpLnRyaW0oKTtcclxuXHRcdFx0XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0bGV0IGN1cnJlbnRLZXk6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG5cdFx0XHRcdGNvbnN0IGFycmF5S2V5cyA9IG5ldyBTZXQ8c3RyaW5nPigpOyAvLyBUcmFjayB3aGljaCBrZXlzIGFyZSBhcnJheXNcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRwcm9wZXJ0aWVzVGV4dC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lKSA9PiB7XHJcblx0XHRcdFx0XHRjb25zdCB0cmltbWVkTGluZSA9IGxpbmUudHJpbSgpO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHQvLyBNYXRjaCBwcm9wZXJ0eSBsaW5lcyAtIG1vcmUgZmxleGlibGUgcmVnZXggdG8gaGFuZGxlIHZhcmlvdXMgcHJvcGVydHkgbmFtZXNcclxuXHRcdFx0XHRcdGNvbnN0IG1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL14oW2EtekEtWl9dW2EtekEtWjAtOV8tXSopOlxccyooLiopJC8pO1xyXG5cdFx0XHRcdFx0aWYgKG1hdGNoKSB7XHJcblx0XHRcdFx0XHRcdGNvbnN0IFssIGtleSwgdmFsdWVdID0gbWF0Y2g7XHJcblx0XHRcdFx0XHRcdGN1cnJlbnRLZXkgPSBrZXk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGlzS25vd25BcnJheUtleSA9IEtOT1dOX0FSUkFZX0tFWVMuaW5jbHVkZXMoa2V5IGFzIHR5cGVvZiBLTk9XTl9BUlJBWV9LRVlTW251bWJlcl0pO1xyXG5cdFx0XHRcdFx0XHRjb25zdCBpc0VtcHR5QXJyYXkgPSAhdmFsdWUgfHwgdmFsdWUudHJpbSgpID09PSBcIlwiIHx8IHZhbHVlLnRyaW0oKSA9PT0gXCJbXVwiO1xyXG5cdFx0XHRcdFx0XHRjb25zdCBpc0FycmF5UHJvcGVydHkgPSBpc0tub3duQXJyYXlLZXkgfHwgaXNFbXB0eUFycmF5O1xyXG5cdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0aWYgKGlzQXJyYXlQcm9wZXJ0eSkge1xyXG5cdFx0XHRcdFx0XHRcdGV4aXN0aW5nUHJvcGVydGllc1trZXldID0gW107XHJcblx0XHRcdFx0XHRcdFx0YXJyYXlLZXlzLmFkZChrZXkpOyAvLyBNYXJrIHRoaXMga2V5IGFzIGFuIGFycmF5XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0ZXhpc3RpbmdQcm9wZXJ0aWVzW2tleV0gPSBbdmFsdWUgPyB2YWx1ZS50cmltKCkgOiBcIlwiXTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIGlmIChjdXJyZW50S2V5ICYmIHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSkge1xyXG5cdFx0XHRcdFx0XHQvLyBDaGVjayBpZiBjdXJyZW50IGtleSBpcyBhbiBhcnJheSBwcm9wZXJ0eVxyXG5cdFx0XHRcdFx0XHRjb25zdCBpc0FycmF5UHJvcGVydHkgPSBhcnJheUtleXMuaGFzKGN1cnJlbnRLZXkpO1xyXG5cdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0aWYgKGlzQXJyYXlQcm9wZXJ0eSkge1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGl0ZW0gPSB0cmltbWVkTGluZS5yZXBsYWNlKC9eLVxccyovLCBcIlwiKTtcclxuXHRcdFx0XHRcdFx0XHRpZiAoaXRlbSkgZXhpc3RpbmdQcm9wZXJ0aWVzW2N1cnJlbnRLZXldLnB1c2goaXRlbSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAodHJpbW1lZExpbmUgJiYgIXRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSAmJiAhdHJpbW1lZExpbmUuc3RhcnRzV2l0aChcIiNcIikpIHtcclxuXHRcdFx0XHRcdFx0Ly8gSGFuZGxlIHVucmVjb2duaXplZCBwcm9wZXJ0aWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIHN0YW5kYXJkIGZvcm1hdFxyXG5cdFx0XHRcdFx0XHQvLyBUaGlzIGlzIGEgZmFsbGJhY2sgdG8gcHJlc2VydmUgcHJvcGVydGllcyB0aGF0IG1pZ2h0IGhhdmUgc3BlY2lhbCBmb3JtYXR0aW5nXHJcblx0XHRcdFx0XHRcdGNvbnN0IGtleU1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL14oW146XSspOlxccyooLiopJC8pO1xyXG5cdFx0XHRcdFx0XHRpZiAoa2V5TWF0Y2gpIHtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBbLCBrZXksIHZhbHVlXSA9IGtleU1hdGNoO1xyXG5cdFx0XHRcdFx0XHRcdGlmICghZXhpc3RpbmdQcm9wZXJ0aWVzW2tleV0pIHtcclxuXHRcdFx0XHRcdFx0XHRcdGV4aXN0aW5nUHJvcGVydGllc1trZXldID0gW3ZhbHVlID8gdmFsdWUudHJpbSgpIDogXCJcIl07XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0Ly8gUHJlc2VydmUgYXJyYXkga2V5cyBpZiB0aGV5IGV4aXN0IHdpdGhvdXQgdmFsdWVzXHJcblx0XHRcdFx0S05PV05fQVJSQVlfS0VZUy5mb3JFYWNoKGtleSA9PiB7XHJcblx0XHRcdFx0XHRpZiAocHJvcGVydGllc1RleHQuaW5jbHVkZXMoa2V5ICsgJzonKSAmJiAhZXhpc3RpbmdQcm9wZXJ0aWVzW2tleV0pIHtcclxuXHRcdFx0XHRcdFx0ZXhpc3RpbmdQcm9wZXJ0aWVzW2tleV0gPSBbXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdFx0XHQvLyBGYWxsYmFjayB0byB0ZW1wbGF0ZSBpZiBwYXJzaW5nIGZhaWxzXHJcblx0XHRcdFx0bmV3IE5vdGljZShcIkZhbGxpbmcgYmFjayB0byB0ZW1wbGF0ZSBkdWUgdG8gcGFyc2luZyBlcnJvci5cIik7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBib2R5Q29udGVudCA9IGNvbnRlbnQuc2xpY2UocHJvcGVydGllc0VuZCk7XHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRwcm9wZXJ0aWVzOiBleGlzdGluZ1Byb3BlcnRpZXMsXHJcblx0XHRcdHByb3BlcnRpZXNUZXh0LFxyXG5cdFx0XHRwcm9wZXJ0aWVzRW5kLFxyXG5cdFx0XHRib2R5Q29udGVudFxyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdHBhcnNlVGVtcGxhdGUodGVtcGxhdGVTdHJpbmc6IHN0cmluZywgdGl0bGU6IHN0cmluZyk6IHsgdGVtcGxhdGVQcm9wczogc3RyaW5nW107IHRlbXBsYXRlVmFsdWVzOiBUZW1wbGF0ZVZhbHVlcyB9IHtcclxuXHRcdGNvbnN0IHRlbXBsYXRlTGluZXMgPSB0ZW1wbGF0ZVN0cmluZy5zcGxpdChcIlxcblwiKTtcclxuXHRcdGNvbnN0IHRlbXBsYXRlUHJvcHM6IHN0cmluZ1tdID0gW107XHJcblx0XHRjb25zdCB0ZW1wbGF0ZVZhbHVlczogVGVtcGxhdGVWYWx1ZXMgPSB7fTtcclxuXHRcdGxldCBpblByb3BlcnRpZXMgPSBmYWxzZTtcclxuXHJcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRlbXBsYXRlTGluZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0Y29uc3QgbGluZSA9IHRlbXBsYXRlTGluZXNbaV0udHJpbSgpO1xyXG5cdFx0XHRpZiAobGluZSA9PT0gXCItLS1cIikge1xyXG5cdFx0XHRcdGluUHJvcGVydGllcyA9ICFpblByb3BlcnRpZXM7XHJcblx0XHRcdFx0aWYgKCFpblByb3BlcnRpZXMpIHtcclxuXHRcdFx0XHRcdGJyZWFrOyAvLyBTdG9wIGF0IHNlY29uZCAtLS0gdG8gZXhjbHVkZSBwb3N0LXByb3BlcnR5IGNvbnRlbnRcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKGluUHJvcGVydGllcykge1xyXG5cdFx0XHRcdGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaCgvXihcXHcrKTpcXHMqKC4qKSQvKTtcclxuXHRcdFx0XHRpZiAobWF0Y2gpIHtcclxuXHRcdFx0XHRcdGNvbnN0IFssIGtleSwgdmFsdWVdID0gbWF0Y2g7XHJcblx0XHRcdFx0XHR0ZW1wbGF0ZVByb3BzLnB1c2goa2V5KTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhbiBhcnJheSBwcm9wZXJ0eSAoa25vd24gYXJyYXkga2V5cyBvciBZQU1MIGxpc3QgZm9ybWF0KVxyXG5cdFx0XHRcdFx0Y29uc3QgaXNLbm93bkFycmF5S2V5ID0gS05PV05fQVJSQVlfS0VZUy5pbmNsdWRlcyhrZXkgYXMgYW55KTtcclxuXHRcdFx0XHRcdC8vIENoZWNrIGlmIGl0J3MgYSBZQU1MIGxpc3QgZm9ybWF0IChubyB2YWx1ZSBhZnRlciBjb2xvbiwgZW1wdHkgYnJhY2tldHMsIG9yIGVtcHR5IHZhbHVlIG1lYW5zIGl0J3MgYW4gYXJyYXkpXHJcblx0XHRcdFx0XHRjb25zdCBpc0VtcHR5QXJyYXkgPSAhdmFsdWUgfHwgdmFsdWUudHJpbSgpID09PSBcIlwiIHx8IHZhbHVlLnRyaW0oKSA9PT0gXCJbXVwiO1xyXG5cdFx0XHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gaXNLbm93bkFycmF5S2V5IHx8IGlzRW1wdHlBcnJheTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0aWYgKGlzQXJyYXlQcm9wZXJ0eSkge1xyXG5cdFx0XHRcdFx0XHQvLyBIYW5kbGUgYXJyYXkgcHJvcGVydGllc1xyXG5cdFx0XHRcdFx0XHRpZiAodmFsdWUgJiYgdmFsdWUuc3RhcnRzV2l0aChcIltcIikpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBIYW5kbGUgYnJhY2tldCBmb3JtYXQ6IFtcIml0ZW0xXCIsIFwiaXRlbTJcIl1cclxuXHRcdFx0XHRcdFx0XHRjb25zdCBpdGVtcyA9IHZhbHVlXHJcblx0XHRcdFx0XHRcdFx0XHQucmVwbGFjZSgvW1tcXF1dL2csIFwiXCIpXHJcblx0XHRcdFx0XHRcdFx0XHQuc3BsaXQoXCIsXCIpXHJcblx0XHRcdFx0XHRcdFx0XHQubWFwKHQgPT4gdC50cmltKCkpXHJcblx0XHRcdFx0XHRcdFx0XHQuZmlsdGVyKHQgPT4gdCk7XHJcblx0XHRcdFx0XHRcdFx0dGVtcGxhdGVWYWx1ZXNba2V5XSA9IGl0ZW1zO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdC8vIEhhbmRsZSBZQU1MIGxpc3QgZm9ybWF0OiBlbXB0eSBvciB3aXRoIC0gaXRlbXNcclxuXHRcdFx0XHRcdFx0XHR0ZW1wbGF0ZVZhbHVlc1trZXldID0gW107XHJcblx0XHRcdFx0XHRcdFx0Ly8gTG9vayBhaGVhZCBmb3IgaXRlbSBsaXN0XHJcblx0XHRcdFx0XHRcdFx0Zm9yIChsZXQgaiA9IGkgKyAxOyBqIDwgdGVtcGxhdGVMaW5lcy5sZW5ndGg7IGorKykge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgbmV4dExpbmUgPSB0ZW1wbGF0ZUxpbmVzW2pdLnRyaW0oKTtcclxuXHRcdFx0XHRcdFx0XHRcdGlmIChuZXh0TGluZS5zdGFydHNXaXRoKFwiLSBcIikpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgaXRlbSA9IG5leHRMaW5lLnJlcGxhY2UoL14tXFxzKi8sIFwiXCIpLnRyaW0oKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGl0ZW0pICh0ZW1wbGF0ZVZhbHVlc1trZXldIGFzIHN0cmluZ1tdKS5wdXNoKGl0ZW0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChuZXh0TGluZSA9PT0gXCItLS1cIiB8fCAobmV4dExpbmUgJiYgIW5leHRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSAmJiBuZXh0TGluZS5pbmNsdWRlcyhcIjpcIikpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIFN0b3AgYXQgbmV4dCBwcm9wZXJ0eSBvciBlbmQgb2YgZnJvbnRtYXR0ZXJcclxuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvLyBUaGlzIGlzIGEgc3RyaW5nIHByb3BlcnR5LCBub3QgYW4gYXJyYXlcclxuXHRcdFx0XHRcdFx0Y29uc3Qgc3RyaW5nVmFsdWUgPSAodmFsdWUgfHwgXCJcIikucmVwbGFjZSgvXFx7XFx7dGl0bGVcXH1cXH0vZywgdGl0bGUpLnJlcGxhY2UoL1xce1xce2RhdGVcXH1cXH0vZywgd2luZG93Lm1vbWVudChuZXcgRGF0ZSgpKS5mb3JtYXQodGhpcy5zZXR0aW5ncy5kYXRlRm9ybWF0KSk7XHJcblx0XHRcdFx0XHRcdC8vIFN0b3JlIGFzIGEgc2luZ2xlIHN0cmluZyB2YWx1ZSwgbm90IGluIGFuIGFycmF5XHJcblx0XHRcdFx0XHRcdHRlbXBsYXRlVmFsdWVzW2tleV0gPSBzdHJpbmdWYWx1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4geyB0ZW1wbGF0ZVByb3BzLCB0ZW1wbGF0ZVZhbHVlcyB9O1xyXG5cdH1cclxuXHJcblx0YnVpbGRGcm9udG1hdHRlckNvbnRlbnQoZmluYWxQcm9wczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+LCBhcnJheUtleXM/OiBTZXQ8c3RyaW5nPik6IHN0cmluZyB7XHJcblx0XHRsZXQgbmV3Q29udGVudCA9IFwiLS0tXFxuXCI7XHJcblx0XHRmb3IgKGNvbnN0IGtleSBpbiBmaW5hbFByb3BzKSB7XHJcblx0XHRcdC8vIENoZWNrIGlmIHRoaXMgaXMgYW4gYXJyYXkgcHJvcGVydHlcclxuXHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gS05PV05fQVJSQVlfS0VZUy5pbmNsdWRlcyhrZXkgYXMgdHlwZW9mIEtOT1dOX0FSUkFZX0tFWVNbbnVtYmVyXSkgfHwgXHJcblx0XHRcdFx0KGFycmF5S2V5cyAmJiBhcnJheUtleXMuaGFzKGtleSkpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYgKGlzQXJyYXlQcm9wZXJ0eSkge1xyXG5cdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCR7a2V5fTpcXG5gO1xyXG5cdFx0XHRcdGlmIChmaW5hbFByb3BzW2tleV0ubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0ZmluYWxQcm9wc1trZXldLmZvckVhY2goaXRlbSA9PiB7XHJcblx0XHRcdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCAgLSAke2l0ZW19XFxuYDtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRuZXdDb250ZW50ICs9IGAke2tleX06ICR7ZmluYWxQcm9wc1trZXldWzBdIHx8IFwiXCJ9XFxuYDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0bmV3Q29udGVudCArPSBcIi0tLVwiO1xyXG5cdFx0cmV0dXJuIG5ld0NvbnRlbnQ7XHJcblx0fVxyXG5cclxuXHRhc3luYyB1cGRhdGVUaXRsZUluRnJvbnRtYXR0ZXIoZmlsZTogVEZpbGUsIG5ld1RpdGxlOiBzdHJpbmcsIHR5cGU6IFBvc3RUeXBlIHwgc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHRjb25zdCB0aXRsZUtleSA9IHRoaXMuZ2V0VGl0bGVLZXkodHlwZSk7XHJcblx0XHRjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcclxuXHRcdGxldCBwcm9wZXJ0aWVzRW5kID0gMDtcclxuXHRcdGxldCBwcm9wZXJ0aWVzVGV4dCA9IFwiXCI7XHJcblxyXG5cdFx0aWYgKGNvbnRlbnQuc3RhcnRzV2l0aChcIi0tLVwiKSkge1xyXG5cdFx0XHRwcm9wZXJ0aWVzRW5kID0gY29udGVudC5pbmRleE9mKFwiXFxuLS0tXCIsIDMpO1xyXG5cdFx0XHRpZiAocHJvcGVydGllc0VuZCA9PT0gLTEpIHtcclxuXHRcdFx0XHRwcm9wZXJ0aWVzRW5kID0gY29udGVudC5sZW5ndGg7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cHJvcGVydGllc0VuZCArPSA0O1xyXG5cdFx0XHR9XHJcblx0XHRcdHByb3BlcnRpZXNUZXh0ID0gY29udGVudC5zbGljZSg0LCBwcm9wZXJ0aWVzRW5kIC0gNCkudHJpbSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IHByb3BPcmRlcjogc3RyaW5nW10gPSBbXTtcclxuXHRcdGNvbnN0IGV4aXN0aW5nOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XHJcblx0XHRsZXQgY3VycmVudEtleTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcblx0XHRsZXQgdGl0bGVLZXlQb3NpdGlvbiA9IC0xOyAvLyBUcmFjayB0aGUgb3JpZ2luYWwgcG9zaXRpb24gb2YgdGhlIHRpdGxlIGtleVxyXG5cclxuXHRcdGNvbnN0IGFycmF5S2V5cyA9IG5ldyBTZXQ8c3RyaW5nPigpOyAvLyBUcmFjayB3aGljaCBrZXlzIGFyZSBhcnJheXNcclxuXHRcdFxyXG5cdFx0cHJvcGVydGllc1RleHQuc3BsaXQoXCJcXG5cIikuZm9yRWFjaCgobGluZSwgaW5kZXgpID0+IHtcclxuXHRcdFx0Y29uc3QgdHJpbW1lZExpbmUgPSBsaW5lLnRyaW0oKTtcclxuXHRcdFx0XHJcblx0XHRcdC8vIE1hdGNoIHByb3BlcnR5IGxpbmVzIC0gbW9yZSBmbGV4aWJsZSByZWdleCB0byBoYW5kbGUgdmFyaW91cyBwcm9wZXJ0eSBuYW1lc1xyXG5cdFx0XHRjb25zdCBtYXRjaCA9IHRyaW1tZWRMaW5lLm1hdGNoKC9eKFthLXpBLVpfXVthLXpBLVowLTlfLV0qKTpcXHMqKC4qKSQvKTtcclxuXHRcdFx0aWYgKG1hdGNoKSB7XHJcblx0XHRcdFx0Y29uc3QgWywga2V5LCB2YWx1ZV0gPSBtYXRjaDtcclxuXHRcdFx0XHRwcm9wT3JkZXIucHVzaChrZXkpO1xyXG5cdFx0XHRcdGN1cnJlbnRLZXkgPSBrZXk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0Ly8gVHJhY2sgdGhlIG9yaWdpbmFsIHBvc2l0aW9uIG9mIHRoZSB0aXRsZSBrZXlcclxuXHRcdFx0XHRpZiAoa2V5ID09PSB0aXRsZUtleSkge1xyXG5cdFx0XHRcdFx0dGl0bGVLZXlQb3NpdGlvbiA9IGluZGV4O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRcclxuXHRcdFx0XHRjb25zdCBpc0tub3duQXJyYXlLZXkgPSBLTk9XTl9BUlJBWV9LRVlTLmluY2x1ZGVzKGtleSBhcyBhbnkpO1xyXG5cdFx0XHRcdGNvbnN0IGlzRW1wdHlBcnJheSA9ICF2YWx1ZSB8fCB2YWx1ZS50cmltKCkgPT09IFwiXCIgfHwgdmFsdWUudHJpbSgpID09PSBcIltdXCI7XHJcblx0XHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gaXNLbm93bkFycmF5S2V5IHx8IGlzRW1wdHlBcnJheTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRpZiAoaXNBcnJheVByb3BlcnR5KSB7XHJcblx0XHRcdFx0XHRleGlzdGluZ1trZXldID0gW107XHJcblx0XHRcdFx0XHRhcnJheUtleXMuYWRkKGtleSk7IC8vIE1hcmsgdGhpcyBrZXkgYXMgYW4gYXJyYXlcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0ZXhpc3Rpbmdba2V5XSA9IHZhbHVlID8gdmFsdWUudHJpbSgpIDogXCJcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSBpZiAoY3VycmVudEtleSAmJiBhcnJheUtleXMuaGFzKGN1cnJlbnRLZXkpICYmIHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSkge1xyXG5cdFx0XHRcdC8vIEhhbmRsZSBhcnJheSBpdGVtc1xyXG5cdFx0XHRcdGNvbnN0IGl0ZW0gPSB0cmltbWVkTGluZS5yZXBsYWNlKC9eLVxccyovLCBcIlwiKTtcclxuXHRcdFx0XHRpZiAoaXRlbSkgKGV4aXN0aW5nW2N1cnJlbnRLZXldIGFzIHN0cmluZ1tdKS5wdXNoKGl0ZW0pO1xyXG5cdFx0XHR9IGVsc2UgaWYgKHRyaW1tZWRMaW5lICYmICF0cmltbWVkTGluZS5zdGFydHNXaXRoKFwiLSBcIikgJiYgIXRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCIjXCIpKSB7XHJcblx0XHRcdFx0Ly8gSGFuZGxlIHVucmVjb2duaXplZCBwcm9wZXJ0aWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIHN0YW5kYXJkIGZvcm1hdFxyXG5cdFx0XHRcdC8vIFRoaXMgaXMgYSBmYWxsYmFjayB0byBwcmVzZXJ2ZSBwcm9wZXJ0aWVzIHRoYXQgbWlnaHQgaGF2ZSBzcGVjaWFsIGZvcm1hdHRpbmdcclxuXHRcdFx0XHRjb25zdCBrZXlNYXRjaCA9IHRyaW1tZWRMaW5lLm1hdGNoKC9eKFteOl0rKTpcXHMqKC4qKSQvKTtcclxuXHRcdFx0XHRpZiAoa2V5TWF0Y2gpIHtcclxuXHRcdFx0XHRcdGNvbnN0IFssIGtleSwgdmFsdWVdID0ga2V5TWF0Y2g7XHJcblx0XHRcdFx0XHRpZiAoIXByb3BPcmRlci5pbmNsdWRlcyhrZXkpKSB7XHJcblx0XHRcdFx0XHRcdHByb3BPcmRlci5wdXNoKGtleSk7XHJcblx0XHRcdFx0XHRcdGV4aXN0aW5nW2tleV0gPSB2YWx1ZSA/IHZhbHVlLnRyaW0oKSA6IFwiXCI7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHRjb25zdCBlc2NhcGVkVGl0bGUgPSBuZXdUaXRsZS5yZXBsYWNlKC9cIi9nLCAnXFxcXFwiJyk7XHJcblx0XHRjb25zdCB0aXRsZVZhbCA9IG5ld1RpdGxlLmluY2x1ZGVzKFwiIFwiKSB8fCBuZXdUaXRsZS5pbmNsdWRlcygnXCInKSA/IGBcIiR7ZXNjYXBlZFRpdGxlfVwiYCA6IG5ld1RpdGxlO1xyXG5cdFx0ZXhpc3RpbmdbdGl0bGVLZXldID0gdGl0bGVWYWw7XHJcblxyXG5cdFx0Ly8gSWYgdGl0bGUga2V5IHdhcyBmb3VuZCBpbiBvcmlnaW5hbCBmcm9udG1hdHRlciwgcHJlc2VydmUgaXRzIHBvc2l0aW9uXHJcblx0XHQvLyBPdGhlcndpc2UsIGFkZCBpdCBhdCB0aGUgZW5kXHJcblx0XHRpZiAodGl0bGVLZXlQb3NpdGlvbiA9PT0gLTEpIHtcclxuXHRcdFx0Ly8gVGl0bGUga2V5IG5vdCBmb3VuZCBpbiBvcmlnaW5hbCBmcm9udG1hdHRlciwgYWRkIGl0IGF0IHRoZSBlbmRcclxuXHRcdFx0cHJvcE9yZGVyLnB1c2godGl0bGVLZXkpO1xyXG5cdFx0fVxyXG5cdFx0Ly8gSWYgdGl0bGVLZXlQb3NpdGlvbiA+PSAwLCB0aGUgdGl0bGUga2V5IGlzIGFscmVhZHkgaW4gcHJvcE9yZGVyIGF0IHRoZSBjb3JyZWN0IHBvc2l0aW9uXHJcblxyXG5cdFx0bGV0IG5ld0NvbnRlbnQgPSBcIi0tLVxcblwiO1xyXG5cdFx0Zm9yIChjb25zdCBrZXkgb2YgcHJvcE9yZGVyKSB7XHJcblx0XHRcdGNvbnN0IHZhbCA9IGV4aXN0aW5nW2tleV07XHJcblx0XHRcdGlmIChBcnJheS5pc0FycmF5KHZhbCkpIHtcclxuXHRcdFx0XHRuZXdDb250ZW50ICs9IGAke2tleX06XFxuYDtcclxuXHRcdFx0XHRpZiAodmFsLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdHZhbC5mb3JFYWNoKChpdGVtOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0bmV3Q29udGVudCArPSBgICAtICR7aXRlbX1cXG5gO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCR7a2V5fTogJHt2YWwgfHwgXCJcIn1cXG5gO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRuZXdDb250ZW50ICs9IFwiLS0tXCI7XHJcblxyXG5cdFx0Y29uc3QgYm9keUNvbnRlbnQgPSBjb250ZW50LnNsaWNlKHByb3BlcnRpZXNFbmQpO1xyXG5cdFx0bmV3Q29udGVudCArPSBib2R5Q29udGVudDtcclxuXHJcblx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGdldFRpdGxlS2V5KHR5cGU6IFBvc3RUeXBlIHwgc3RyaW5nKTogc3RyaW5nIHtcclxuXHRcdGxldCB0ZW1wbGF0ZTogc3RyaW5nO1xyXG5cdFx0XHJcblx0XHRpZiAodGhpcy5pc0N1c3RvbUNvbnRlbnRUeXBlKHR5cGUpKSB7XHJcblx0XHRcdGNvbnN0IGN1c3RvbVR5cGUgPSB0aGlzLmdldEN1c3RvbUNvbnRlbnRUeXBlKHR5cGUpO1xyXG5cdFx0XHRpZiAoIWN1c3RvbVR5cGUpIHJldHVybiBcInRpdGxlXCI7XHJcblx0XHRcdHRlbXBsYXRlID0gY3VzdG9tVHlwZS50ZW1wbGF0ZTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRlbXBsYXRlID0gdHlwZSA9PT0gXCJwb3N0XCIgPyB0aGlzLnNldHRpbmdzLmRlZmF1bHRUZW1wbGF0ZSA6IHRoaXMuc2V0dGluZ3MucGFnZVRlbXBsYXRlO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRjb25zdCBsaW5lcyA9IHRlbXBsYXRlLnNwbGl0KFwiXFxuXCIpO1xyXG5cdFx0bGV0IGluUHJvcGVydGllcyA9IGZhbHNlO1xyXG5cdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XHJcblx0XHRcdGNvbnN0IHRyaW1tZWQgPSBsaW5lLnRyaW0oKTtcclxuXHRcdFx0aWYgKHRyaW1tZWQgPT09IFwiLS0tXCIpIHtcclxuXHRcdFx0XHRpblByb3BlcnRpZXMgPSAhaW5Qcm9wZXJ0aWVzO1xyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChpblByb3BlcnRpZXMpIHtcclxuXHRcdFx0XHRjb25zdCBtYXRjaCA9IHRyaW1tZWQubWF0Y2goL14oXFx3Kyk6XFxzKiguKykkLyk7XHJcblx0XHRcdFx0aWYgKG1hdGNoKSB7XHJcblx0XHRcdFx0XHRjb25zdCBrZXkgPSBtYXRjaFsxXTtcclxuXHRcdFx0XHRcdGNvbnN0IHZhbHVlID0gbWF0Y2hbMl07XHJcblx0XHRcdFx0XHRpZiAodmFsdWUuaW5jbHVkZXMoXCJ7e3RpdGxlfX1cIikpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGtleTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdHJldHVybiBcInRpdGxlXCI7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGlzQ3VzdG9tQ29udGVudFR5cGUodHlwZTogUG9zdFR5cGUgfCBzdHJpbmcpOiBib29sZWFuIHtcclxuXHRcdHJldHVybiB0eXBlICE9PSBcInBvc3RcIiAmJiB0eXBlICE9PSBcInBhZ2VcIjtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgZ2V0Q3VzdG9tQ29udGVudFR5cGUodHlwZUlkOiBzdHJpbmcpOiBDdXN0b21Db250ZW50VHlwZSB8IG51bGwge1xyXG5cdFx0cmV0dXJuIHRoaXMuc2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzLmZpbmQoY3QgPT4gY3QuaWQgPT09IHR5cGVJZCkgfHwgbnVsbDtcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7IEVkaXRvciwgVEZpbGUsIE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5cbmV4cG9ydCBjbGFzcyBMaW5rQ29udmVydGVyIHtcblx0Y29uc3RydWN0b3IocHJpdmF0ZSBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKSB7fVxuXG5cdHRvS2ViYWJDYXNlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gc3RyXG5cdFx0XHQudG9Mb3dlckNhc2UoKVxuXHRcdFx0LnJlcGxhY2UoL1teYS16MC05XFxzLV0vZywgXCJcIilcblx0XHRcdC50cmltKClcblx0XHRcdC5yZXBsYWNlKC9cXHMrL2csIFwiLVwiKVxuXHRcdFx0LnJlcGxhY2UoLy0rL2csIFwiLVwiKVxuXHRcdFx0LnJlcGxhY2UoL14tfC0kL2csIFwiXCIpO1xuXHR9XG5cblx0Z2V0QXN0cm9VcmxGcm9tSW50ZXJuYWxMaW5rKGxpbms6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaGFzaEluZGV4ID0gbGluay5pbmRleE9mKCcjJyk7XG5cdFx0bGV0IHBhdGggPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoMCwgaGFzaEluZGV4KSA6IGxpbms7XG5cdFx0Y29uc3QgYW5jaG9yID0gaGFzaEluZGV4ID49IDAgPyBsaW5rLnNsaWNlKGhhc2hJbmRleCkgOiAnJztcblxuXHRcdC8vIFVSTCBkZWNvZGUgdGhlIHBhdGggdG8gaGFuZGxlIGVuY29kZWQgY2hhcmFjdGVycyBsaWtlICUyMFxuXHRcdHBhdGggPSBkZWNvZGVVUklDb21wb25lbnQocGF0aCk7XG5cdFx0cGF0aCA9IHBhdGgucmVwbGFjZSgvXFwubWQkLywgXCJcIik7XG5cblx0XHQvLyBEZXRlcm1pbmUgY29udGVudCB0eXBlIGFuZCBhcHByb3ByaWF0ZSBiYXNlIHBhdGhcblx0XHRsZXQgYmFzZVBhdGggPSBcIlwiO1xuXHRcdGxldCBjb250ZW50Rm9sZGVyID0gXCJcIjtcblx0XHRsZXQgY3JlYXRpb25Nb2RlOiBcImZpbGVcIiB8IFwiZm9sZGVyXCIgPSBcImZpbGVcIjtcblx0XHRsZXQgaW5kZXhGaWxlTmFtZSA9IFwiXCI7XG5cblx0XHQvLyBDaGVjayBjdXN0b20gY29udGVudCB0eXBlcyBmaXJzdCAoaGlnaGVzdCBwcmlvcml0eSlcblx0XHRsZXQgZm91bmRDdXN0b21UeXBlID0gZmFsc2U7XG5cdFx0Zm9yIChjb25zdCBjdXN0b21UeXBlIG9mIHRoaXMuc2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzKSB7XG5cdFx0XHRpZiAoY3VzdG9tVHlwZS5lbmFibGVkICYmIGN1c3RvbVR5cGUuZm9sZGVyICYmIHBhdGguc3RhcnRzV2l0aChjdXN0b21UeXBlLmZvbGRlciArICcvJykpIHtcblx0XHRcdFx0Y29udGVudEZvbGRlciA9IGN1c3RvbVR5cGUuZm9sZGVyO1xuXHRcdFx0XHRiYXNlUGF0aCA9IGN1c3RvbVR5cGUubGlua0Jhc2VQYXRoIHx8IFwiXCI7XG5cdFx0XHRcdGNyZWF0aW9uTW9kZSA9IGN1c3RvbVR5cGUuY3JlYXRpb25Nb2RlO1xuXHRcdFx0XHRpbmRleEZpbGVOYW1lID0gY3VzdG9tVHlwZS5pbmRleEZpbGVOYW1lO1xuXHRcdFx0XHRmb3VuZEN1c3RvbVR5cGUgPSB0cnVlO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgcGFnZXMgZm9sZGVyIChzZWNvbmQgcHJpb3JpdHkpXG5cdFx0aWYgKCFmb3VuZEN1c3RvbVR5cGUgJiYgdGhpcy5zZXR0aW5ncy5lbmFibGVQYWdlcyAmJiB0aGlzLnNldHRpbmdzLnBhZ2VzRm9sZGVyICYmIHBhdGguc3RhcnRzV2l0aCh0aGlzLnNldHRpbmdzLnBhZ2VzRm9sZGVyICsgJy8nKSkge1xuXHRcdFx0Y29udGVudEZvbGRlciA9IHRoaXMuc2V0dGluZ3MucGFnZXNGb2xkZXI7XG5cdFx0XHRiYXNlUGF0aCA9IHRoaXMuc2V0dGluZ3MucGFnZXNMaW5rQmFzZVBhdGg7XG5cdFx0XHRjcmVhdGlvbk1vZGUgPSB0aGlzLnNldHRpbmdzLnBhZ2VzQ3JlYXRpb25Nb2RlIHx8IFwiZmlsZVwiO1xuXHRcdFx0aW5kZXhGaWxlTmFtZSA9IHRoaXMuc2V0dGluZ3MucGFnZXNJbmRleEZpbGVOYW1lIHx8IFwiXCI7XG5cdFx0fVxuXHRcdC8vIENoZWNrIHBvc3RzIGZvbGRlciAodGhpcmQgcHJpb3JpdHkpXG5cdFx0ZWxzZSBpZiAoIWZvdW5kQ3VzdG9tVHlwZSAmJiB0aGlzLnNldHRpbmdzLnBvc3RzRm9sZGVyICYmIHBhdGguc3RhcnRzV2l0aCh0aGlzLnNldHRpbmdzLnBvc3RzRm9sZGVyICsgJy8nKSkge1xuXHRcdFx0Y29udGVudEZvbGRlciA9IHRoaXMuc2V0dGluZ3MucG9zdHNGb2xkZXI7XG5cdFx0XHRiYXNlUGF0aCA9IHRoaXMuc2V0dGluZ3MucG9zdHNMaW5rQmFzZVBhdGg7XG5cdFx0XHRjcmVhdGlvbk1vZGUgPSB0aGlzLnNldHRpbmdzLmNyZWF0aW9uTW9kZTtcblx0XHRcdGluZGV4RmlsZU5hbWUgPSB0aGlzLnNldHRpbmdzLmluZGV4RmlsZU5hbWUgfHwgXCJpbmRleFwiO1xuXHRcdH1cblx0XHQvLyBJZiBwb3N0cyBmb2xkZXIgaXMgYmxhbmsgYW5kIFwiSWdub3JlIHN1YmZvbGRlcnNcIiBpcyBOT1QgY2hlY2tlZCwgdHJlYXQgYXMgcG9zdCB1bmxlc3MgZXhjbHVkZWRcblx0XHRlbHNlIGlmICghZm91bmRDdXN0b21UeXBlICYmICF0aGlzLnNldHRpbmdzLnBvc3RzRm9sZGVyICYmICF0aGlzLnNldHRpbmdzLm9ubHlBdXRvbWF0ZUluUG9zdHNGb2xkZXIpIHtcblx0XHRcdC8vIE9ubHkgdHJlYXQgZmlsZXMgaW4gdmF1bHQgcm9vdCBhcyBwb3N0cyB3aGVuIHBvc3RzIGZvbGRlciBpcyBibGFua1xuXHRcdFx0Ly8gVGhpcyBpbmNsdWRlcyBib3RoIGRpcmVjdCBmaWxlcyBhbmQgZm9sZGVyLWJhc2VkIHBvc3RzIGluIHZhdWx0IHJvb3Rcblx0XHRcdGlmICghcGF0aC5pbmNsdWRlcygnLycpIHx8IChwYXRoLmluY2x1ZGVzKCcvJykgJiYgIXBhdGguc3RhcnRzV2l0aCgnLycpICYmIHBhdGguc3BsaXQoJy8nKS5sZW5ndGggPT09IDIpKSB7XG5cdFx0XHRcdC8vIENoZWNrIGlmIGZpbGUgc2hvdWxkIGJlIGV4Y2x1ZGVkIGZyb20gcG9zdCBwcm9jZXNzaW5nXG5cdFx0XHRcdGxldCBzaG91bGRFeGNsdWRlRnJvbVBvc3RzID0gZmFsc2U7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBFeGNsdWRlIGlmIGluIHBhZ2VzIGZvbGRlclxuXHRcdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVQYWdlcyAmJiB0aGlzLnNldHRpbmdzLnBhZ2VzRm9sZGVyICYmIHBhdGguc3RhcnRzV2l0aCh0aGlzLnNldHRpbmdzLnBhZ2VzRm9sZGVyICsgJy8nKSkge1xuXHRcdFx0XHRcdHNob3VsZEV4Y2x1ZGVGcm9tUG9zdHMgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBFeGNsdWRlIGlmIGluIGV4Y2x1ZGVkIGRpcmVjdG9yaWVzXG5cdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmV4Y2x1ZGVkRGlyZWN0b3JpZXMpIHtcblx0XHRcdFx0XHRjb25zdCBleGNsdWRlZERpcnMgPSB0aGlzLnNldHRpbmdzLmV4Y2x1ZGVkRGlyZWN0b3JpZXMuc3BsaXQoXCJ8XCIpLm1hcChkaXIgPT4gZGlyLnRyaW0oKSkuZmlsdGVyKGRpciA9PiBkaXIpO1xuXHRcdFx0XHRcdGZvciAoY29uc3QgZXhjbHVkZWREaXIgb2YgZXhjbHVkZWREaXJzKSB7XG5cdFx0XHRcdFx0XHRpZiAocGF0aC5zdGFydHNXaXRoKGV4Y2x1ZGVkRGlyICsgJy8nKSB8fCBwYXRoID09PSBleGNsdWRlZERpcikge1xuXHRcdFx0XHRcdFx0XHRzaG91bGRFeGNsdWRlRnJvbVBvc3RzID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBJZiBub3QgZXhjbHVkZWQsIHRyZWF0IGFzIHBvc3Rcblx0XHRcdFx0aWYgKCFzaG91bGRFeGNsdWRlRnJvbVBvc3RzKSB7XG5cdFx0XHRcdFx0YmFzZVBhdGggPSB0aGlzLnNldHRpbmdzLnBvc3RzTGlua0Jhc2VQYXRoO1xuXHRcdFx0XHRcdGNyZWF0aW9uTW9kZSA9IHRoaXMuc2V0dGluZ3MuY3JlYXRpb25Nb2RlO1xuXHRcdFx0XHRcdGluZGV4RmlsZU5hbWUgPSB0aGlzLnNldHRpbmdzLmluZGV4RmlsZU5hbWUgfHwgXCJpbmRleFwiO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHQvLyBTdHJpcCBjb250ZW50IGZvbGRlciBpZiBwcmVzZW50XG5cdFx0aWYgKGNvbnRlbnRGb2xkZXIpIHtcblx0XHRcdHBhdGggPSBwYXRoLnNsaWNlKGNvbnRlbnRGb2xkZXIubGVuZ3RoICsgMSk7XG5cdFx0fVxuXG5cdFx0bGV0IGFkZFRyYWlsaW5nU2xhc2ggPSBmYWxzZTtcblx0XHRcblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IGlmIHRoZSBmaWxlbmFtZSBtYXRjaGVzIHRoZSBpbmRleCBmaWxlIG5hbWUgKHJlZ2FyZGxlc3Mgb2YgY3JlYXRpb24gbW9kZSksXG5cdFx0Ly8gdHJlYXQgaXQgYXMgZm9sZGVyLWJhc2VkIGxvZ2ljXG5cdFx0Y29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XG5cdFx0Y29uc3QgbGFzdFBhcnQgPSBwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXTtcblx0XHRcblx0XHQvLyBDaGVjayBpZiB0aGUgbGFzdCBwYXJ0IG1hdGNoZXMgdGhlIHNwZWNpZmllZCBpbmRleCBmaWxlIG5hbWVcblx0XHRpZiAoaW5kZXhGaWxlTmFtZSAmJiBpbmRleEZpbGVOYW1lLnRyaW0oKSAhPT0gXCJcIiAmJiBsYXN0UGFydCA9PT0gaW5kZXhGaWxlTmFtZSkge1xuXHRcdFx0cGFydHMucG9wKCk7XG5cdFx0XHRwYXRoID0gcGFydHMuam9pbignLycpO1xuXHRcdFx0YWRkVHJhaWxpbmdTbGFzaCA9IHRydWU7XG5cdFx0fVxuXHRcdC8vIENoZWNrIGlmIHRoZSBsYXN0IHBhcnQgbWF0Y2hlcyB0aGUgZGVmYXVsdCBcImluZGV4XCIgKHdoZW4gbm8gaW5kZXhGaWxlTmFtZSBpcyBzcGVjaWZpZWQpXG5cdFx0ZWxzZSBpZiAoKCFpbmRleEZpbGVOYW1lIHx8IGluZGV4RmlsZU5hbWUudHJpbSgpID09PSBcIlwiKSAmJiBsYXN0UGFydCA9PT0gXCJpbmRleFwiKSB7XG5cdFx0XHRwYXJ0cy5wb3AoKTtcblx0XHRcdHBhdGggPSBwYXJ0cy5qb2luKCcvJyk7XG5cdFx0XHRhZGRUcmFpbGluZ1NsYXNoID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRjb25zdCBzbHVnUGFydHMgPSBwYXRoLnNwbGl0KCcvJykubWFwKHBhcnQgPT4gdGhpcy50b0tlYmFiQ2FzZShwYXJ0KSk7XG5cdFx0Y29uc3Qgc2x1ZyA9IHNsdWdQYXJ0cy5qb2luKCcvJyk7XG5cblx0XHQvLyBGb3JtYXQgYmFzZSBwYXRoXG5cdFx0aWYgKGJhc2VQYXRoKSB7XG5cdFx0XHQvLyBBZGQgbGVhZGluZyBzbGFzaCBpZiBub3QgcHJlc2VudCB0byBtYWtlIGl0IGFic29sdXRlIGZyb20gcm9vdFxuXHRcdFx0aWYgKCFiYXNlUGF0aC5zdGFydHNXaXRoKFwiL1wiKSkge1xuXHRcdFx0XHRiYXNlUGF0aCA9IFwiL1wiICsgYmFzZVBhdGg7XG5cdFx0XHR9XG5cdFx0XHQvLyBBZGQgdHJhaWxpbmcgc2xhc2ggaWYgbm90IHByZXNlbnRcblx0XHRcdGlmICghYmFzZVBhdGguZW5kc1dpdGgoXCIvXCIpKSB7XG5cdFx0XHRcdGJhc2VQYXRoICs9IFwiL1wiO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBXaGVuIG5vIGJhc2UgcGF0aCBpcyBzcGVjaWZpZWQsIGFkZCBsZWFkaW5nIHNsYXNoIHRvIG1ha2UgaXQgYWJzb2x1dGUgZnJvbSByb290XG5cdFx0XHRiYXNlUGF0aCA9IFwiL1wiO1xuXHRcdH1cblxuXHRcdC8vIERldGVybWluZSBpZiB3ZSBzaG91bGQgYWRkIHRyYWlsaW5nIHNsYXNoXG5cdFx0Y29uc3Qgc2hvdWxkQWRkVHJhaWxpbmdTbGFzaCA9IHRoaXMuc2V0dGluZ3MuYWRkVHJhaWxpbmdTbGFzaFRvTGlua3MgfHwgYWRkVHJhaWxpbmdTbGFzaDtcblxuXHRcdHJldHVybiBgJHtiYXNlUGF0aH0ke3NsdWd9JHtzaG91bGRBZGRUcmFpbGluZ1NsYXNoID8gJy8nIDogJyd9JHthbmNob3J9YDtcblx0fVxuXG5cdHByaXZhdGUgZ2V0QXN0cm9VcmxGcm9tSW50ZXJuYWxMaW5rV2l0aENvbnRleHQobGluazogc3RyaW5nLCBjdXJyZW50RmlsZVBhdGg6IHN0cmluZywgY3VycmVudEZpbGVDb250ZW50VHlwZTogeyBiYXNlUGF0aDogc3RyaW5nOyBjcmVhdGlvbk1vZGU6IFwiZmlsZVwiIHwgXCJmb2xkZXJcIjsgaW5kZXhGaWxlTmFtZTogc3RyaW5nIH0pOiBzdHJpbmcge1xuXHRcdFxuXHRcdGNvbnN0IGhhc2hJbmRleCA9IGxpbmsuaW5kZXhPZignIycpO1xuXHRcdGxldCBwYXRoID0gaGFzaEluZGV4ID49IDAgPyBsaW5rLnNsaWNlKDAsIGhhc2hJbmRleCkgOiBsaW5rO1xuXHRcdGNvbnN0IGFuY2hvciA9IGhhc2hJbmRleCA+PSAwID8gbGluay5zbGljZShoYXNoSW5kZXgpIDogJyc7XG5cblx0XHQvLyBVUkwgZGVjb2RlIHRoZSBwYXRoIHRvIGhhbmRsZSBlbmNvZGVkIGNoYXJhY3RlcnMgbGlrZSAlMjBcblx0XHRwYXRoID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhdGgpO1xuXHRcdHBhdGggPSBwYXRoLnJlcGxhY2UoL1xcLm1kJC8sIFwiXCIpO1xuXHRcdFxuXG5cdFx0Ly8gRGV0ZXJtaW5lIGNvbnRlbnQgdHlwZSBhbmQgYXBwcm9wcmlhdGUgYmFzZSBwYXRoXG5cdFx0bGV0IGJhc2VQYXRoID0gXCJcIjtcblx0XHRsZXQgY29udGVudEZvbGRlciA9IFwiXCI7XG5cdFx0bGV0IGNyZWF0aW9uTW9kZTogXCJmaWxlXCIgfCBcImZvbGRlclwiID0gXCJmaWxlXCI7XG5cdFx0bGV0IGluZGV4RmlsZU5hbWUgPSBcIlwiO1xuXG5cdFx0Ly8gVXNlIHRoZSBzYW1lIGxvZ2ljIGFzIGdldENvbnRlbnRUeXBlRm9yUGF0aCBidXQgZm9yIHRoZSB0YXJnZXQgbGlua1xuXHRcdGNvbnN0IHRhcmdldENvbnRlbnRUeXBlID0gdGhpcy5nZXRDb250ZW50VHlwZUZvclBhdGgocGF0aCArICcubWQnKTtcblx0XHRcblx0XHQvLyBJZiB0YXJnZXQgbGluayBkb2Vzbid0IGhhdmUgYSBjbGVhciBjb250ZW50IHR5cGUgKG5vIGZvbGRlciBwYXRoKSwgdXNlIGN1cnJlbnQgZmlsZSdzIGNvbnRlbnQgdHlwZVxuXHRcdGlmICghdGFyZ2V0Q29udGVudFR5cGUuYmFzZVBhdGggJiYgY3VycmVudEZpbGVDb250ZW50VHlwZS5iYXNlUGF0aCkge1xuXHRcdFx0YmFzZVBhdGggPSBjdXJyZW50RmlsZUNvbnRlbnRUeXBlLmJhc2VQYXRoO1xuXHRcdFx0Y3JlYXRpb25Nb2RlID0gY3VycmVudEZpbGVDb250ZW50VHlwZS5jcmVhdGlvbk1vZGU7XG5cdFx0XHRpbmRleEZpbGVOYW1lID0gY3VycmVudEZpbGVDb250ZW50VHlwZS5pbmRleEZpbGVOYW1lO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRiYXNlUGF0aCA9IHRhcmdldENvbnRlbnRUeXBlLmJhc2VQYXRoO1xuXHRcdFx0Y3JlYXRpb25Nb2RlID0gdGFyZ2V0Q29udGVudFR5cGUuY3JlYXRpb25Nb2RlO1xuXHRcdFx0aW5kZXhGaWxlTmFtZSA9IHRhcmdldENvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWU7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIERldGVybWluZSBjb250ZW50IGZvbGRlciBmcm9tIHRoZSB0YXJnZXQgcGF0aFxuXHRcdGNvbnN0IHRhcmdldFBhdGggPSBwYXRoICsgJy5tZCc7XG5cdFx0Zm9yIChjb25zdCBjdXN0b21UeXBlIG9mIHRoaXMuc2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzKSB7XG5cdFx0XHRpZiAoY3VzdG9tVHlwZS5lbmFibGVkICYmIGN1c3RvbVR5cGUuZm9sZGVyICYmIHRhcmdldFBhdGguc3RhcnRzV2l0aChjdXN0b21UeXBlLmZvbGRlciArICcvJykpIHtcblx0XHRcdFx0Y29udGVudEZvbGRlciA9IGN1c3RvbVR5cGUuZm9sZGVyO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKCFjb250ZW50Rm9sZGVyICYmIHRoaXMuc2V0dGluZ3MuZW5hYmxlUGFnZXMgJiYgdGhpcy5zZXR0aW5ncy5wYWdlc0ZvbGRlciAmJiB0YXJnZXRQYXRoLnN0YXJ0c1dpdGgodGhpcy5zZXR0aW5ncy5wYWdlc0ZvbGRlciArICcvJykpIHtcblx0XHRcdGNvbnRlbnRGb2xkZXIgPSB0aGlzLnNldHRpbmdzLnBhZ2VzRm9sZGVyO1xuXHRcdH1cblx0XHRpZiAoIWNvbnRlbnRGb2xkZXIgJiYgdGhpcy5zZXR0aW5ncy5wb3N0c0ZvbGRlciAmJiB0YXJnZXRQYXRoLnN0YXJ0c1dpdGgodGhpcy5zZXR0aW5ncy5wb3N0c0ZvbGRlciArICcvJykpIHtcblx0XHRcdGNvbnRlbnRGb2xkZXIgPSB0aGlzLnNldHRpbmdzLnBvc3RzRm9sZGVyO1xuXHRcdH1cblxuXHRcdC8vIFN0cmlwIGNvbnRlbnQgZm9sZGVyIGlmIHByZXNlbnRcblx0XHRpZiAoY29udGVudEZvbGRlcikge1xuXHRcdFx0cGF0aCA9IHBhdGguc2xpY2UoY29udGVudEZvbGRlci5sZW5ndGggKyAxKTtcblx0XHR9XG5cblx0XHRsZXQgYWRkVHJhaWxpbmdTbGFzaCA9IGZhbHNlO1xuXHRcdFxuXHRcdC8vIFNtYXJ0IGRldGVjdGlvbjogaWYgdGhlIGZpbGVuYW1lIG1hdGNoZXMgdGhlIGluZGV4IGZpbGUgbmFtZSAocmVnYXJkbGVzcyBvZiBjcmVhdGlvbiBtb2RlKSxcblx0XHQvLyB0cmVhdCBpdCBhcyBmb2xkZXItYmFzZWQgbG9naWNcblx0XHRjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcblx0XHRjb25zdCBsYXN0UGFydCA9IHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdO1xuXHRcdFxuXHRcdC8vIENoZWNrIGlmIHRoZSBsYXN0IHBhcnQgbWF0Y2hlcyB0aGUgc3BlY2lmaWVkIGluZGV4IGZpbGUgbmFtZVxuXHRcdGlmIChpbmRleEZpbGVOYW1lICYmIGluZGV4RmlsZU5hbWUudHJpbSgpICE9PSBcIlwiICYmIGxhc3RQYXJ0ID09PSBpbmRleEZpbGVOYW1lKSB7XG5cdFx0XHRwYXJ0cy5wb3AoKTtcblx0XHRcdHBhdGggPSBwYXJ0cy5qb2luKCcvJyk7XG5cdFx0XHRhZGRUcmFpbGluZ1NsYXNoID0gdHJ1ZTtcblx0XHR9XG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIGxhc3QgcGFydCBtYXRjaGVzIHRoZSBkZWZhdWx0IFwiaW5kZXhcIiAod2hlbiBubyBpbmRleEZpbGVOYW1lIGlzIHNwZWNpZmllZClcblx0XHRlbHNlIGlmICgoIWluZGV4RmlsZU5hbWUgfHwgaW5kZXhGaWxlTmFtZS50cmltKCkgPT09IFwiXCIpICYmIGxhc3RQYXJ0ID09PSBcImluZGV4XCIpIHtcblx0XHRcdHBhcnRzLnBvcCgpO1xuXHRcdFx0cGF0aCA9IHBhcnRzLmpvaW4oJy8nKTtcblx0XHRcdGFkZFRyYWlsaW5nU2xhc2ggPSB0cnVlO1xuXHRcdH1cblxuXHRcdGNvbnN0IHNsdWdQYXJ0cyA9IHBhdGguc3BsaXQoJy8nKS5tYXAocGFydCA9PiB0aGlzLnRvS2ViYWJDYXNlKHBhcnQpKTtcblx0XHRjb25zdCBzbHVnID0gc2x1Z1BhcnRzLmpvaW4oJy8nKTtcblxuXHRcdC8vIEZvcm1hdCBiYXNlIHBhdGhcblx0XHRpZiAoYmFzZVBhdGgpIHtcblx0XHRcdC8vIEFkZCBsZWFkaW5nIHNsYXNoIGlmIG5vdCBwcmVzZW50IHRvIG1ha2UgaXQgYWJzb2x1dGUgZnJvbSByb290XG5cdFx0XHRpZiAoIWJhc2VQYXRoLnN0YXJ0c1dpdGgoXCIvXCIpKSB7XG5cdFx0XHRcdGJhc2VQYXRoID0gXCIvXCIgKyBiYXNlUGF0aDtcblx0XHRcdH1cblx0XHRcdC8vIEFkZCB0cmFpbGluZyBzbGFzaCBpZiBub3QgcHJlc2VudFxuXHRcdFx0aWYgKCFiYXNlUGF0aC5lbmRzV2l0aChcIi9cIikpIHtcblx0XHRcdFx0YmFzZVBhdGggKz0gXCIvXCI7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFdoZW4gbm8gYmFzZSBwYXRoIGlzIHNwZWNpZmllZCwgYWRkIGxlYWRpbmcgc2xhc2ggdG8gbWFrZSBpdCBhYnNvbHV0ZSBmcm9tIHJvb3Rcblx0XHRcdGJhc2VQYXRoID0gXCIvXCI7XG5cdFx0fVxuXG5cdFx0Ly8gRGV0ZXJtaW5lIGlmIHdlIHNob3VsZCBhZGQgdHJhaWxpbmcgc2xhc2hcblx0XHRjb25zdCBzaG91bGRBZGRUcmFpbGluZ1NsYXNoID0gdGhpcy5zZXR0aW5ncy5hZGRUcmFpbGluZ1NsYXNoVG9MaW5rcyB8fCBhZGRUcmFpbGluZ1NsYXNoO1xuXG5cdFx0cmV0dXJuIGAke2Jhc2VQYXRofSR7c2x1Z30ke3Nob3VsZEFkZFRyYWlsaW5nU2xhc2ggPyAnLycgOiAnJ30ke2FuY2hvcn1gO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRDb250ZW50VHlwZUZvclBhdGgoZmlsZVBhdGg6IHN0cmluZyk6IHsgYmFzZVBhdGg6IHN0cmluZzsgY3JlYXRpb25Nb2RlOiBcImZpbGVcIiB8IFwiZm9sZGVyXCI7IGluZGV4RmlsZU5hbWU6IHN0cmluZyB9IHtcblx0XHRcblx0XHQvLyBDaGVjayBjdXN0b20gY29udGVudCB0eXBlcyBGSVJTVCAoaGlnaGVzdCBwcmlvcml0eSlcblx0XHRmb3IgKGNvbnN0IGN1c3RvbVR5cGUgb2YgdGhpcy5zZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXMpIHtcblx0XHRcdGlmIChjdXN0b21UeXBlLmVuYWJsZWQgJiYgY3VzdG9tVHlwZS5mb2xkZXIgJiYgZmlsZVBhdGguc3RhcnRzV2l0aChjdXN0b21UeXBlLmZvbGRlciArICcvJykpIHtcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRiYXNlUGF0aDogY3VzdG9tVHlwZS5saW5rQmFzZVBhdGggfHwgXCJcIixcblx0XHRcdFx0XHRjcmVhdGlvbk1vZGU6IGN1c3RvbVR5cGUuY3JlYXRpb25Nb2RlLFxuXHRcdFx0XHRcdGluZGV4RmlsZU5hbWU6IGN1c3RvbVR5cGUuaW5kZXhGaWxlTmFtZVxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBDaGVjayBwYWdlcyBmb2xkZXJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVQYWdlcykge1xuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MucGFnZXNGb2xkZXIgJiYgZmlsZVBhdGguc3RhcnRzV2l0aCh0aGlzLnNldHRpbmdzLnBhZ2VzRm9sZGVyICsgJy8nKSkge1xuXHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdGJhc2VQYXRoOiB0aGlzLnNldHRpbmdzLnBhZ2VzTGlua0Jhc2VQYXRoLFxuXHRcdFx0XHRcdGNyZWF0aW9uTW9kZTogdGhpcy5zZXR0aW5ncy5wYWdlc0NyZWF0aW9uTW9kZSB8fCBcImZpbGVcIixcblx0XHRcdFx0XHRpbmRleEZpbGVOYW1lOiB0aGlzLnNldHRpbmdzLnBhZ2VzSW5kZXhGaWxlTmFtZSB8fCBcIlwiXG5cdFx0XHRcdH07XG5cdFx0XHR9IGVsc2UgaWYgKCF0aGlzLnNldHRpbmdzLnBhZ2VzRm9sZGVyICYmICFmaWxlUGF0aC5pbmNsdWRlcygnLycpKSB7XG5cdFx0XHRcdC8vIElmIHBhZ2VzRm9sZGVyIGlzIGJsYW5rLCBvbmx5IHRyZWF0IGZpbGVzIGluIHZhdWx0IHJvb3QgYXMgcGFnZXNcblx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRiYXNlUGF0aDogdGhpcy5zZXR0aW5ncy5wYWdlc0xpbmtCYXNlUGF0aCxcblx0XHRcdFx0XHRjcmVhdGlvbk1vZGU6IHRoaXMuc2V0dGluZ3MucGFnZXNDcmVhdGlvbk1vZGUgfHwgXCJmaWxlXCIsXG5cdFx0XHRcdFx0aW5kZXhGaWxlTmFtZTogdGhpcy5zZXR0aW5ncy5wYWdlc0luZGV4RmlsZU5hbWUgfHwgXCJcIlxuXHRcdFx0XHR9O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHQvLyBDaGVjayBwb3N0cyBmb2xkZXJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5wb3N0c0ZvbGRlciAmJiBmaWxlUGF0aC5zdGFydHNXaXRoKHRoaXMuc2V0dGluZ3MucG9zdHNGb2xkZXIgKyAnLycpKSB7XG5cdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRiYXNlUGF0aDogdGhpcy5zZXR0aW5ncy5wb3N0c0xpbmtCYXNlUGF0aCxcblx0XHRcdFx0Y3JlYXRpb25Nb2RlOiB0aGlzLnNldHRpbmdzLmNyZWF0aW9uTW9kZSxcblx0XHRcdFx0aW5kZXhGaWxlTmFtZTogdGhpcy5zZXR0aW5ncy5pbmRleEZpbGVOYW1lIHx8IFwiaW5kZXhcIlxuXHRcdFx0fTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgcG9zdHMgZm9sZGVyIGlzIGJsYW5rIC0gdHJlYXQgQUxMIGZpbGVzIGFzIHBvc3RzXG5cdFx0aWYgKCF0aGlzLnNldHRpbmdzLnBvc3RzRm9sZGVyICYmIHRoaXMuc2V0dGluZ3MuYXV0b21hdGVQb3N0Q3JlYXRpb24pIHtcblx0XHRcdHJldHVybiB7XG5cdFx0XHRcdGJhc2VQYXRoOiB0aGlzLnNldHRpbmdzLnBvc3RzTGlua0Jhc2VQYXRoLFxuXHRcdFx0XHRjcmVhdGlvbk1vZGU6IHRoaXMuc2V0dGluZ3MuY3JlYXRpb25Nb2RlLFxuXHRcdFx0XHRpbmRleEZpbGVOYW1lOiB0aGlzLnNldHRpbmdzLmluZGV4RmlsZU5hbWUgfHwgXCJpbmRleFwiXG5cdFx0XHR9O1xuXHRcdH1cblx0XHRcblx0XHQvLyBEZWZhdWx0IGZhbGxiYWNrXG5cdFx0cmV0dXJuIHtcblx0XHRcdGJhc2VQYXRoOiBcIlwiLFxuXHRcdFx0Y3JlYXRpb25Nb2RlOiBcImZpbGVcIixcblx0XHRcdGluZGV4RmlsZU5hbWU6IFwiXCJcblx0XHR9O1xuXHR9XG5cblx0YXN5bmMgY29udmVydFdpa2lsaW5rc0ZvckFzdHJvKGVkaXRvcjogRWRpdG9yLCBmaWxlOiBURmlsZSB8IG51bGwpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRuZXcgTm90aWNlKFwiTm8gYWN0aXZlIGZpbGUuXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcblx0XHRsZXQgbmV3Q29udGVudCA9IGNvbnRlbnQ7XG5cblx0XHQvLyBEZXRlcm1pbmUgdGhlIGN1cnJlbnQgZmlsZSdzIGNvbnRlbnQgdHlwZSBmb3IgcmVsYXRpdmUgbGlua3Ncblx0XHRjb25zdCBjdXJyZW50RmlsZUNvbnRlbnRUeXBlID0gdGhpcy5nZXRDb250ZW50VHlwZUZvclBhdGgoZmlsZS5wYXRoKTtcblxuXHRcdC8vIERlZmluZSBjb21tb24gaW1hZ2UgZXh0ZW5zaW9uc1xuXHRcdGNvbnN0IGltYWdlRXh0ZW5zaW9ucyA9IC9cXC4ocG5nfGpwZ3xqcGVnfGdpZnxzdmcpJC9pO1xuXG5cdFx0Ly8gSGFuZGxlIHJlZ3VsYXIgV2lraWxpbmtzIChub24taW1hZ2UpXG5cdFx0bmV3Q29udGVudCA9IG5ld0NvbnRlbnQucmVwbGFjZShcblx0XHRcdC9cXFtcXFsoW15cXF18XSspKFxcfChbXlxcXV0rKSk/XFxdXFxdL2csXG5cdFx0XHQobWF0Y2gsIGxpbmtUZXh0LCBfcGlwZSwgZGlzcGxheVRleHQpID0+IHtcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBhbiBpbWFnZSBXaWtpbGlua1xuXHRcdFx0XHRpZiAoaW1hZ2VFeHRlbnNpb25zLnRlc3QobGlua1RleHQpKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG1hdGNoOyAvLyBJZ25vcmUgYW5kIHJldHVybiBvcmlnaW5hbCBpbWFnZSBXaWtpbGlua1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgZGlzcGxheSA9IGRpc3BsYXlUZXh0IHx8IGxpbmtUZXh0LnJlcGxhY2UoL1xcLm1kJC8sIFwiXCIpO1xuXG5cdFx0XHRcdC8vIEZvciByZWxhdGl2ZSBsaW5rcyAobm8gZm9sZGVyIHBhdGgpLCB1c2UgY3VycmVudCBmaWxlJ3MgY29udGVudCB0eXBlXG5cdFx0XHRcdGNvbnN0IHVybCA9IHRoaXMuZ2V0QXN0cm9VcmxGcm9tSW50ZXJuYWxMaW5rV2l0aENvbnRleHQobGlua1RleHQsIGZpbGUucGF0aCwgY3VycmVudEZpbGVDb250ZW50VHlwZSk7XG5cblx0XHRcdFx0cmV0dXJuIGBbJHtkaXNwbGF5fV0oJHt1cmx9KWA7XG5cdFx0XHR9XG5cdFx0KTtcblxuXHRcdC8vIEhhbmRsZSBzdGFuZGFyZCBNYXJrZG93biBsaW5rcyAobm9uLWltYWdlLCBub24tZXh0ZXJuYWwpXG5cdFx0bmV3Q29udGVudCA9IG5ld0NvbnRlbnQucmVwbGFjZShcblx0XHRcdC9cXFsoW15cXF1dKylcXF1cXCgoW14pXSspXFwpL2csXG5cdFx0XHQobWF0Y2gsIGRpc3BsYXlUZXh0LCBsaW5rKSA9PiB7XG5cdFx0XHRcdC8vIENoZWNrIGlmIGl0J3MgYW4gaW1hZ2UgbGluayBvciBleHRlcm5hbCBsaW5rXG5cdFx0XHRcdGlmIChsaW5rLm1hdGNoKC9eaHR0cHM/OlxcL1xcLy8pIHx8IGltYWdlRXh0ZW5zaW9ucy50ZXN0KGxpbmspKSB7XG5cdFx0XHRcdFx0cmV0dXJuIG1hdGNoOyAvLyBJZ25vcmUgZXh0ZXJuYWwgb3IgaW1hZ2UgbGlua3Ncblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENoZWNrIGlmIGl0J3MgaW50ZXJuYWwgLm1kIGxpbmtcblx0XHRcdFx0aWYgKCFsaW5rLmluY2x1ZGVzKCcubWQnKSkge1xuXHRcdFx0XHRcdHJldHVybiBtYXRjaDsgLy8gSWdub3JlIGlmIG5vdCAubWRcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IHVybCA9IHRoaXMuZ2V0QXN0cm9VcmxGcm9tSW50ZXJuYWxMaW5rV2l0aENvbnRleHQobGluaywgZmlsZS5wYXRoLCBjdXJyZW50RmlsZUNvbnRlbnRUeXBlKTtcblxuXHRcdFx0XHRyZXR1cm4gYFske2Rpc3BsYXlUZXh0fV0oJHt1cmx9KWA7XG5cdFx0XHR9XG5cdFx0KTtcblxuXHRcdC8vIEhhbmRsZSBpbWFnZSBsaW5rcyBpbiBNYXJrZG93biBmb3JtYXQgKGUuZy4sICFbSW1hZ2VdKG1vdW50YWlucy5wbmcpKVxuXHRcdG5ld0NvbnRlbnQgPSBuZXdDb250ZW50LnJlcGxhY2UoXG5cdFx0XHQvIVxcWyguKj8pXFxdXFwoKFteKV0rKVxcKS9nLFxuXHRcdFx0KG1hdGNoKSA9PiB7XG5cdFx0XHRcdHJldHVybiBtYXRjaDsgLy8gSWdub3JlIGFsbCBpbWFnZSBsaW5rc1xuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHQvLyBIYW5kbGUge3tlbWJlZH19IHN5bnRheFxuXHRcdG5ld0NvbnRlbnQgPSBuZXdDb250ZW50LnJlcGxhY2UoL1xce1xceyhbXn1dKylcXH1cXH0vZywgKG1hdGNoLCBmaWxlTmFtZSkgPT4ge1xuXHRcdFx0aWYgKGltYWdlRXh0ZW5zaW9ucy50ZXN0KGZpbGVOYW1lKSkge1xuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7IC8vIElnbm9yZSBlbWJlZGRlZCBpbWFnZXNcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgdXJsID0gdGhpcy5nZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmtXaXRoQ29udGV4dChmaWxlTmFtZSwgZmlsZS5wYXRoLCBjdXJyZW50RmlsZUNvbnRlbnRUeXBlKTtcblxuXHRcdFx0cmV0dXJuIGBbRW1iZWRkZWQ6ICR7ZmlsZU5hbWV9XSgke3VybH0pYDtcblx0XHR9KTtcblxuXHRcdGVkaXRvci5zZXRWYWx1ZShuZXdDb250ZW50KTtcblx0XHRuZXcgTm90aWNlKFwiQWxsIGludGVybmFsIGxpbmtzIGNvbnZlcnRlZCBmb3IgQXN0cm8uXCIpO1xuXHR9XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgVEZpbGUsIE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBQb3N0VHlwZSwgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBGaWxlT3BlcmF0aW9ucyB9IGZyb20gXCIuLi91dGlscy9maWxlLW9wZXJhdGlvbnNcIjtcclxuaW1wb3J0IHsgVGVtcGxhdGVQYXJzZXIgfSBmcm9tIFwiLi4vdXRpbHMvdGVtcGxhdGUtcGFyc2luZ1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFRpdGxlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcblx0ZmlsZTogVEZpbGUgfCBudWxsO1xyXG5cdHBsdWdpbjogQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZTtcclxuXHR0eXBlOiBQb3N0VHlwZSB8IHN0cmluZztcclxuXHRpc1JlbmFtZTogYm9vbGVhbjtcclxuXHRpc05ld05vdGU6IGJvb2xlYW47XHJcblx0dGl0bGVJbnB1dCE6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcblx0cHJpdmF0ZSBmaWxlT3BzOiBGaWxlT3BlcmF0aW9ucztcclxuXHRwcml2YXRlIHRlbXBsYXRlUGFyc2VyOiBUZW1wbGF0ZVBhcnNlcjtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlIHwgbnVsbCwgcGx1Z2luOiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCB0eXBlOiBQb3N0VHlwZSB8IHN0cmluZyA9IFwicG9zdFwiLCBpc1JlbmFtZSA9IGZhbHNlLCBpc05ld05vdGUgPSBmYWxzZSkge1xyXG5cdFx0c3VwZXIoYXBwKTtcclxuXHRcdHRoaXMuZmlsZSA9IGZpbGU7XHJcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuXHRcdHRoaXMudHlwZSA9IHR5cGU7XHJcblx0XHR0aGlzLmlzUmVuYW1lID0gaXNSZW5hbWU7XHJcblx0XHR0aGlzLmlzTmV3Tm90ZSA9IGlzTmV3Tm90ZTtcclxuXHRcdFxyXG5cdFx0Ly8gSW5pdGlhbGl6ZSB1dGlsaXRpZXMgd2l0aCBjdXJyZW50IHNldHRpbmdzXHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHBsdWdpbi5zZXR0aW5ncztcclxuXHRcdHRoaXMuZmlsZU9wcyA9IG5ldyBGaWxlT3BlcmF0aW9ucyhhcHAsIHNldHRpbmdzKTtcclxuXHRcdHRoaXMudGVtcGxhdGVQYXJzZXIgPSBuZXcgVGVtcGxhdGVQYXJzZXIoYXBwLCBzZXR0aW5ncyk7XHJcblx0fVxyXG5cclxuXHRnZXRDdXJyZW50VGl0bGUoKTogc3RyaW5nIHtcclxuXHRcdGlmICghdGhpcy5maWxlKSB7XHJcblx0XHRcdHJldHVybiBcIlwiO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRjb25zdCB0aXRsZUtleSA9IHRoaXMuZmlsZU9wcy5nZXRUaXRsZUtleSh0aGlzLnR5cGUpO1xyXG5cdFx0Y29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh0aGlzLmZpbGUpO1xyXG5cdFx0bGV0IGJhc2VuYW1lID0gdGhpcy5maWxlLmJhc2VuYW1lO1xyXG5cdFx0aWYgKHRoaXMuZmlsZS5wYXJlbnQgJiYgXHJcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmluZGV4RmlsZU5hbWUgJiYgXHJcblx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmluZGV4RmlsZU5hbWUudHJpbSgpICE9PSBcIlwiICYmIFxyXG5cdFx0XHRiYXNlbmFtZSA9PT0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5kZXhGaWxlTmFtZSkge1xyXG5cdFx0XHRiYXNlbmFtZSA9IHRoaXMuZmlsZS5wYXJlbnQubmFtZTtcclxuXHRcdH1cclxuXHRcdGlmIChiYXNlbmFtZS5zdGFydHNXaXRoKFwiX1wiKSkge1xyXG5cdFx0XHRiYXNlbmFtZSA9IGJhc2VuYW1lLnNsaWNlKDEpO1xyXG5cdFx0fVxyXG5cdFx0Y29uc3QgZmFsbGJhY2tUaXRsZSA9IGJhc2VuYW1lLnJlcGxhY2UoLy0vZywgXCIgXCIpLnNwbGl0KFwiIFwiKS5tYXAod29yZCA9PiB3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKSkuam9pbihcIiBcIik7XHJcblxyXG5cdFx0aWYgKGNhY2hlPy5mcm9udG1hdHRlciAmJiBjYWNoZS5mcm9udG1hdHRlclt0aXRsZUtleV0pIHtcclxuXHRcdFx0cmV0dXJuIGNhY2hlLmZyb250bWF0dGVyW3RpdGxlS2V5XTtcclxuXHRcdH1cclxuXHRcdHJldHVybiBmYWxsYmFja1RpdGxlO1xyXG5cdH1cclxuXHJcblx0b25PcGVuKCkge1xyXG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcclxuXHRcdFxyXG5cdFx0Ly8gQWRkIG1vYmlsZS1mcmllbmRseSBwb3NpdGlvbmluZyBjbGFzcyAtIGNoZWNrIGJvdGggd2lkdGggYW5kIHVzZXIgYWdlbnRcclxuXHRcdGNvbnN0IGlzTW9iaWxlID0gd2luZG93LmlubmVyV2lkdGggPD0gNzY4IHx8IC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcclxuXHRcdGlmIChpc01vYmlsZSkge1xyXG5cdFx0XHR0aGlzLm1vZGFsRWwuYWRkQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLW1vYmlsZS1tb2RhbCcpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLmlzUmVuYW1lKSB7XHJcblx0XHRcdGNvbnN0IHR5cGVOYW1lID0gdGhpcy5nZXRUeXBlRGlzcGxheU5hbWUoKTtcclxuXHRcdFx0Y29uc3QgaXNDdXN0b21UeXBlID0gdGhpcy5maWxlT3BzLmlzQ3VzdG9tQ29udGVudFR5cGUodGhpcy50eXBlKTtcclxuXHRcdFx0XHJcblx0XHRcdGlmIChpc0N1c3RvbVR5cGUpIHtcclxuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IGBSZW5hbWUgQ3VzdG9tIFR5cGU6ICR7dHlwZU5hbWV9YCB9KTtcclxuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJFbnRlciBhIG5ldyB0aXRsZSBmb3IgdGhpcyBjb250ZW50IHR5cGU6XCIgfSk7XHJcblx0XHRcdH0gZWxzZSBpZiAodGhpcy50eXBlID09PSBcIm5vdGVcIikge1xyXG5cdFx0XHRcdC8vIEZvciBnZW5lcmljIG5vdGVzIG91dHNpZGUgb2YgYW55IGtub3duIGNvbnRlbnQgdHlwZVxyXG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJSZW5hbWUgQ3VzdG9tIENvbnRlbnQgVHlwZVwiIH0pO1xyXG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBcIkVudGVyIGEgdGl0bGUgZm9yIHRoaXMgY29udGVudCB0eXBlOlwiIH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogYFJlbmFtZSAke3R5cGVOYW1lfWAgfSk7XHJcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IGBFbnRlciBuZXcgdGl0bGUgZm9yIHlvdXIgJHt0eXBlTmFtZS50b0xvd2VyQ2FzZSgpfTpgIH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLnRpdGxlSW5wdXQgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XHJcblx0XHRcdFx0dHlwZTogXCJ0ZXh0XCIsXHJcblx0XHRcdFx0cGxhY2Vob2xkZXI6IGBNeSBSZW5hbWVkICR7dHlwZU5hbWV9YCxcclxuXHRcdFx0XHRjbHM6IFwiYXN0cm8tY29tcG9zZXItdGl0bGUtaW5wdXRcIlxyXG5cdFx0XHR9KTtcclxuXHRcdFx0dGhpcy50aXRsZUlucHV0LnZhbHVlID0gdGhpcy5nZXRDdXJyZW50VGl0bGUoKTtcclxuXHRcdH0gZWxzZSBpZiAodGhpcy5pc05ld05vdGUpIHtcclxuXHRcdFx0Y29uc3QgdHlwZU5hbWUgPSB0aGlzLmdldFR5cGVEaXNwbGF5TmFtZSgpO1xyXG5cdFx0XHRjb25zdCBpc0N1c3RvbVR5cGUgPSB0aGlzLmZpbGVPcHMuaXNDdXN0b21Db250ZW50VHlwZSh0aGlzLnR5cGUpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYgKGlzQ3VzdG9tVHlwZSkge1xyXG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogYE5ldyBDdXN0b20gVHlwZTogJHt0eXBlTmFtZX1gIH0pO1xyXG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBcIkVudGVyIGEgdGl0bGUgZm9yIHRoaXMgY29udGVudCB0eXBlOlwiIH0pO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogYENyZWF0ZSBOZXcgJHt0eXBlTmFtZX1gIH0pO1xyXG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBgRW50ZXIgYSB0aXRsZSBmb3IgeW91ciBuZXcgJHt0eXBlTmFtZS50b0xvd2VyQ2FzZSgpfTpgIH0pO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLnRpdGxlSW5wdXQgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XHJcblx0XHRcdFx0dHlwZTogXCJ0ZXh0XCIsXHJcblx0XHRcdFx0cGxhY2Vob2xkZXI6IGBNeSBBd2Vzb21lICR7dHlwZU5hbWV9YCxcclxuXHRcdFx0XHRjbHM6IFwiYXN0cm8tY29tcG9zZXItdGl0bGUtaW5wdXRcIlxyXG5cdFx0XHR9KTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGNvbnN0IHR5cGVOYW1lID0gdGhpcy5nZXRUeXBlRGlzcGxheU5hbWUoKTtcclxuXHRcdFx0Y29uc3QgaXNDdXN0b21UeXBlID0gdGhpcy5maWxlT3BzLmlzQ3VzdG9tQ29udGVudFR5cGUodGhpcy50eXBlKTtcclxuXHRcdFx0XHJcblx0XHRcdGlmIChpc0N1c3RvbVR5cGUpIHtcclxuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IGBOZXcgQ3VzdG9tIFR5cGU6ICR7dHlwZU5hbWV9YCB9KTtcclxuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJFbnRlciBhIHRpdGxlIGZvciB0aGlzIGNvbnRlbnQgdHlwZTpcIiB9KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IGBOZXcgJHt0eXBlTmFtZX1gIH0pO1xyXG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBgRW50ZXIgYSB0aXRsZSBmb3IgeW91ciAke3R5cGVOYW1lLnRvTG93ZXJDYXNlKCl9OmAgfSk7XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdHRoaXMudGl0bGVJbnB1dCA9IGNvbnRlbnRFbC5jcmVhdGVFbChcImlucHV0XCIsIHtcclxuXHRcdFx0XHR0eXBlOiBcInRleHRcIixcclxuXHRcdFx0XHRwbGFjZWhvbGRlcjogYE15IEF3ZXNvbWUgJHt0eXBlTmFtZX1gLFxyXG5cdFx0XHRcdGNsczogXCJhc3Ryby1jb21wb3Nlci10aXRsZS1pbnB1dFwiXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdFx0dGhpcy50aXRsZUlucHV0LmZvY3VzKCk7XHJcblxyXG5cdFx0Y29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJhc3Ryby1jb21wb3Nlci1idXR0b24tY29udGFpbmVyXCIgfSk7XHJcblxyXG5cdFx0Y29uc3QgY2FuY2VsQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogXCJDYW5jZWxcIiwgY2xzOiBcImFzdHJvLWNvbXBvc2VyLWNhbmNlbC1idXR0b25cIiB9KTtcclxuXHRcdGNhbmNlbEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gdGhpcy5jbG9zZSgpO1xyXG5cclxuXHRcdGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IHRoaXMuaXNSZW5hbWUgPyBcIlJlbmFtZVwiIDogXCJDcmVhdGVcIiwgY2xzOiBbXCJhc3Ryby1jb21wb3Nlci1jcmVhdGUtYnV0dG9uXCIsIFwibW9kLWN0YVwiXSB9KTtcclxuXHRcdHN1Ym1pdEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gdGhpcy5zdWJtaXQoKTtcclxuXHJcblx0XHR0aGlzLnRpdGxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXByZXNzXCIsIChlKSA9PiB7XHJcblx0XHRcdGlmIChlLmtleSA9PT0gXCJFbnRlclwiKSB0aGlzLnN1Ym1pdCgpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHRhc3luYyBzdWJtaXQoKSB7XHJcblx0XHRjb25zdCB0aXRsZSA9IHRoaXMudGl0bGVJbnB1dC52YWx1ZS50cmltKCk7XHJcblx0XHRpZiAoIXRpdGxlKSB7XHJcblx0XHRcdG5ldyBOb3RpY2UoXCJQbGVhc2UgZW50ZXIgYSB0aXRsZS5cIik7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHRsZXQgbmV3RmlsZTogVEZpbGUgfCBudWxsID0gbnVsbDtcclxuXHRcdFx0aWYgKHRoaXMuaXNSZW5hbWUpIHtcclxuXHRcdFx0XHRuZXdGaWxlID0gYXdhaXQgdGhpcy5maWxlT3BzLnJlbmFtZUZpbGUoeyBmaWxlOiB0aGlzLmZpbGUhLCB0aXRsZSwgdHlwZTogdGhpcy50eXBlIH0pO1xyXG5cdFx0XHRcdGlmIChuZXdGaWxlKSB7XHJcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnRlbXBsYXRlUGFyc2VyLnVwZGF0ZVRpdGxlSW5Gcm9udG1hdHRlcihuZXdGaWxlLCB0aXRsZSwgdGhpcy50eXBlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSBpZiAodGhpcy5pc05ld05vdGUpIHtcclxuXHRcdFx0XHQvLyBDcmVhdGUgYSBuZXcgZmlsZSBmcm9tIHNjcmF0Y2hcclxuXHRcdFx0XHRuZXdGaWxlID0gYXdhaXQgdGhpcy5jcmVhdGVOZXdGaWxlKHRpdGxlKTtcclxuXHRcdFx0fSBlbHNlIGlmICh0aGlzLmZpbGUpIHtcclxuXHRcdFx0XHQvLyBXZSBoYXZlIGFuIGV4aXN0aW5nIGZpbGUsIHByb2Nlc3MgaXRcclxuXHRcdFx0XHRuZXdGaWxlID0gYXdhaXQgdGhpcy5maWxlT3BzLmNyZWF0ZUZpbGUoeyBmaWxlOiB0aGlzLmZpbGUsIHRpdGxlLCB0eXBlOiB0aGlzLnR5cGUgfSk7XHJcblx0XHRcdFx0aWYgKG5ld0ZpbGUgJiYgdGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b0luc2VydFByb3BlcnRpZXMpIHtcclxuXHRcdFx0XHRcdGF3YWl0IHRoaXMuYWRkUHJvcGVydGllc1RvRmlsZShuZXdGaWxlLCB0aXRsZSwgdGhpcy50eXBlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Ly8gRmFsbGJhY2sgLSBjcmVhdGUgbmV3IGZpbGVcclxuXHRcdFx0XHRuZXdGaWxlID0gYXdhaXQgdGhpcy5jcmVhdGVOZXdGaWxlKHRpdGxlKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoIW5ld0ZpbGUpIHtcclxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcHJvY2VzcyB0aGUgY29udGVudC5cIik7XHJcblx0XHRcdH1cclxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XHJcblx0XHRcdG5ldyBOb3RpY2UoYEVycm9yICR7dGhpcy5pc1JlbmFtZSA/IFwicmVuYW1pbmdcIiA6IFwiY3JlYXRpbmdcIn0gJHt0aGlzLnR5cGV9OiAkeyhlcnJvciBhcyBFcnJvcikubWVzc2FnZX0uYCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5jbG9zZSgpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBnZXRUeXBlRGlzcGxheU5hbWUoKTogc3RyaW5nIHtcclxuXHRcdGlmICh0aGlzLmZpbGVPcHMuaXNDdXN0b21Db250ZW50VHlwZSh0aGlzLnR5cGUpKSB7XHJcblx0XHRcdGNvbnN0IGN1c3RvbVR5cGUgPSB0aGlzLmZpbGVPcHMuZ2V0Q3VzdG9tQ29udGVudFR5cGUodGhpcy50eXBlKTtcclxuXHRcdFx0cmV0dXJuIGN1c3RvbVR5cGUgPyBjdXN0b21UeXBlLm5hbWUgOiBcIkNvbnRlbnRcIjtcclxuXHRcdH1cclxuXHRcdHJldHVybiB0aGlzLnR5cGUgPT09IFwicG9zdFwiID8gXCJCbG9nIFBvc3RcIiA6IFwiUGFnZVwiO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBhc3luYyBjcmVhdGVOZXdGaWxlKHRpdGxlOiBzdHJpbmcpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xyXG5cdFx0Ly8gRGV0ZXJtaW5lIHRoZSBhcHByb3ByaWF0ZSBmb2xkZXIgYmFzZWQgb24gd2hlcmUgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZVxyXG5cdFx0bGV0IHRhcmdldEZvbGRlcjogc3RyaW5nO1xyXG5cdFx0XHJcblx0XHQvLyBHZXQgdGhlIGRpcmVjdG9yeSB3aGVyZSB0aGUgdXNlciBjcmVhdGVkIHRoZSBmaWxlXHJcblx0XHRjb25zdCBvcmlnaW5hbERpciA9IHRoaXMuZmlsZT8ucGFyZW50Py5wYXRoIHx8IFwiXCI7XHJcblx0XHRcclxuXHRcdGlmICh0aGlzLmZpbGVPcHMuaXNDdXN0b21Db250ZW50VHlwZSh0aGlzLnR5cGUpKSB7XHJcblx0XHRcdGNvbnN0IGN1c3RvbVR5cGUgPSB0aGlzLmZpbGVPcHMuZ2V0Q3VzdG9tQ29udGVudFR5cGUodGhpcy50eXBlKTtcclxuXHRcdFx0Ly8gRm9yIGN1c3RvbSBjb250ZW50IHR5cGVzLCByZXNwZWN0IHRoZSB1c2VyJ3MgY2hvc2VuIGxvY2F0aW9uIChzdWJmb2xkZXIpXHJcblx0XHRcdC8vIE9ubHkgdXNlIHRoZSBjb25maWd1cmVkIGZvbGRlciBpZiB0aGUgdXNlciBjcmVhdGVkIHRoZSBmaWxlIGluIHRoZSB2YXVsdCByb290XHJcblx0XHRcdGlmIChvcmlnaW5hbERpciA9PT0gXCJcIiB8fCBvcmlnaW5hbERpciA9PT0gXCIvXCIpIHtcclxuXHRcdFx0XHR0YXJnZXRGb2xkZXIgPSBjdXN0b21UeXBlPy5mb2xkZXIgfHwgXCJcIjtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHR0YXJnZXRGb2xkZXIgPSBvcmlnaW5hbERpcjtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIGlmICh0aGlzLnR5cGUgPT09IFwicGFnZVwiKSB7XHJcblx0XHRcdC8vIEZvciBwYWdlcywgdXNlIHRoZSBjb25maWd1cmVkIHBhZ2VzIGZvbGRlciBpZiBpdCBleGlzdHMsIG90aGVyd2lzZSByZXNwZWN0IHVzZXIncyBjaG9pY2VcclxuXHRcdFx0dGFyZ2V0Rm9sZGVyID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucGFnZXNGb2xkZXIgfHwgb3JpZ2luYWxEaXI7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBGb3IgcG9zdHMsIHVzZSB0aGUgY29uZmlndXJlZCBwb3N0cyBmb2xkZXIgaWYgaXQgZXhpc3RzLCBvdGhlcndpc2UgcmVzcGVjdCB1c2VyJ3MgY2hvaWNlXHJcblx0XHRcdHRhcmdldEZvbGRlciA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnBvc3RzRm9sZGVyIHx8IG9yaWdpbmFsRGlyO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIENyZWF0ZSB0aGUgZmlsZW5hbWUgZnJvbSB0aGUgdGl0bGVcclxuXHRcdGNvbnN0IGZpbGVuYW1lID0gdGhpcy5maWxlT3BzLmdlbmVyYXRlRmlsZW5hbWUodGl0bGUpO1xyXG5cdFx0Y29uc3QgZmlsZVBhdGggPSB0YXJnZXRGb2xkZXIgPyBgJHt0YXJnZXRGb2xkZXJ9LyR7ZmlsZW5hbWV9Lm1kYCA6IGAke2ZpbGVuYW1lfS5tZGA7XHJcblxyXG5cdFx0Ly8gQ3JlYXRlIHRoZSBmaWxlIHdpdGggaW5pdGlhbCBjb250ZW50XHJcblx0XHRsZXQgaW5pdGlhbENvbnRlbnQgPSBcIlwiO1xyXG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9JbnNlcnRQcm9wZXJ0aWVzKSB7XHJcblx0XHRcdGluaXRpYWxDb250ZW50ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUluaXRpYWxDb250ZW50KHRpdGxlKTtcclxuXHRcdH1cclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCBuZXdGaWxlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGZpbGVQYXRoLCBpbml0aWFsQ29udGVudCk7XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBUcmFjayB0aGF0IHRoaXMgZmlsZSB3YXMgY3JlYXRlZCBieSB0aGUgcGx1Z2luIHRvIGF2b2lkIHRyaWdnZXJpbmcgdGhlIGNyZWF0ZSBldmVudFxyXG5cdFx0XHRpZiAodGhpcy5wbHVnaW4gJiYgJ3BsdWdpbkNyZWF0ZWRGaWxlcycgaW4gdGhpcy5wbHVnaW4pIHtcclxuXHRcdFx0XHQodGhpcy5wbHVnaW4gYXMgYW55KS5wbHVnaW5DcmVhdGVkRmlsZXMuYWRkKGZpbGVQYXRoKTtcclxuXHRcdFx0fVxyXG5cdFx0XHRcclxuXHRcdFx0Ly8gT3BlbiB0aGUgbmV3IGZpbGVcclxuXHRcdFx0YXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKS5vcGVuRmlsZShuZXdGaWxlKTtcclxuXHRcdFx0XHJcblx0XHRcdHJldHVybiBuZXdGaWxlO1xyXG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY3JlYXRlIGZpbGU6ICR7KGVycm9yIGFzIEVycm9yKS5tZXNzYWdlfWApO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBhc3luYyBnZW5lcmF0ZUluaXRpYWxDb250ZW50KHRpdGxlOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG5cdFx0Y29uc3Qgbm93ID0gbmV3IERhdGUoKTtcclxuXHRcdGNvbnN0IGRhdGVTdHJpbmcgPSB3aW5kb3cubW9tZW50KG5vdykuZm9ybWF0KHRoaXMucGx1Z2luLnNldHRpbmdzLmRhdGVGb3JtYXQpO1xyXG5cclxuXHRcdGxldCB0ZW1wbGF0ZTogc3RyaW5nO1xyXG5cdFx0aWYgKHRoaXMudHlwZSA9PT0gXCJub3RlXCIpIHtcclxuXHRcdFx0Ly8gRm9yIGdlbmVyaWMgbm90ZXMsIHVzZSBhIHNpbXBsZSB0ZW1wbGF0ZVxyXG5cdFx0XHR0ZW1wbGF0ZSA9IGAtLS1cXG50aXRsZTogXCIke3RpdGxlfVwiXFxuZGF0ZTogJHtkYXRlU3RyaW5nfVxcbi0tLVxcbmA7XHJcblx0XHR9IGVsc2UgaWYgKHRoaXMuZmlsZU9wcy5pc0N1c3RvbUNvbnRlbnRUeXBlKHRoaXMudHlwZSkpIHtcclxuXHRcdFx0Y29uc3QgY3VzdG9tVHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDdXN0b21Db250ZW50VHlwZSh0aGlzLnR5cGUpO1xyXG5cdFx0XHR0ZW1wbGF0ZSA9IGN1c3RvbVR5cGUgPyBjdXN0b21UeXBlLnRlbXBsYXRlIDogdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVmYXVsdFRlbXBsYXRlO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0dGVtcGxhdGUgPSB0aGlzLnR5cGUgPT09IFwicG9zdFwiID8gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVmYXVsdFRlbXBsYXRlIDogdGhpcy5wbHVnaW4uc2V0dGluZ3MucGFnZVRlbXBsYXRlO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xce1xce3RpdGxlXFx9XFx9L2csIHRpdGxlKTtcclxuXHRcdHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgvXFx7XFx7ZGF0ZVxcfVxcfS9nLCBkYXRlU3RyaW5nKTtcclxuXHJcblx0XHRyZXR1cm4gdGVtcGxhdGU7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGFzeW5jIGFkZFByb3BlcnRpZXNUb0ZpbGUoZmlsZTogVEZpbGUsIHRpdGxlOiBzdHJpbmcsIHR5cGU6IFBvc3RUeXBlIHwgc3RyaW5nID0gXCJwb3N0XCIpIHtcclxuXHRcdGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XHJcblx0XHRjb25zdCBkYXRlU3RyaW5nID0gd2luZG93Lm1vbWVudChub3cpLmZvcm1hdCh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kYXRlRm9ybWF0KTtcclxuXHJcblx0XHRsZXQgdGVtcGxhdGU6IHN0cmluZztcclxuXHRcdGlmICh0eXBlID09PSBcIm5vdGVcIikge1xyXG5cdFx0XHQvLyBGb3IgZ2VuZXJpYyBub3RlcywgdXNlIGEgc2ltcGxlIHRlbXBsYXRlXHJcblx0XHRcdHRlbXBsYXRlID0gYC0tLVxcbnRpdGxlOiBcIiR7dGl0bGV9XCJcXG5kYXRlOiAke2RhdGVTdHJpbmd9XFxuLS0tXFxuYDtcclxuXHRcdH0gZWxzZSBpZiAodGhpcy5maWxlT3BzLmlzQ3VzdG9tQ29udGVudFR5cGUodHlwZSkpIHtcclxuXHRcdFx0Y29uc3QgY3VzdG9tVHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDdXN0b21Db250ZW50VHlwZSh0eXBlKTtcclxuXHRcdFx0dGVtcGxhdGUgPSBjdXN0b21UeXBlID8gY3VzdG9tVHlwZS50ZW1wbGF0ZSA6IHRoaXMucGx1Z2luLnNldHRpbmdzLmRlZmF1bHRUZW1wbGF0ZTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRlbXBsYXRlID0gdHlwZSA9PT0gXCJwb3N0XCIgPyB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWZhdWx0VGVtcGxhdGUgOiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wYWdlVGVtcGxhdGU7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHRlbXBsYXRlID0gdGVtcGxhdGUucmVwbGFjZSgvXFx7XFx7dGl0bGVcXH1cXH0vZywgdGl0bGUpO1xyXG5cdFx0dGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKC9cXHtcXHtkYXRlXFx9XFx9L2csIGRhdGVTdHJpbmcpO1xyXG5cclxuXHRcdC8vIEVuc3VyZSBubyBleHRyYSBuZXdsaW5lcyBvciAtLS0gYXJlIGFkZGVkIGJleW9uZCB0aGUgdGVtcGxhdGVcclxuXHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCB0ZW1wbGF0ZSk7XHJcblx0fVxyXG5cclxuXHRvbkNsb3NlKCkge1xyXG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBQbHVnaW4gfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgQ3VzdG9tQ29udGVudFR5cGUsIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBBc3Ryb0NvbXBvc2VyU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG5cdHBsdWdpbjogQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZTtcclxuXHRhdXRvUmVuYW1lQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdHBvc3RzRm9sZGVyQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdG9ubHlBdXRvbWF0ZUNvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHRjcmVhdGlvbk1vZGVDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0aW5kZXhGaWxlQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdGV4Y2x1ZGVkRGlyc0NvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHR1bmRlcnNjb3JlUHJlZml4Q29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdGF1dG9JbnNlcnRDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0cGFnZXNGaWVsZHNDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0cGFnZXNJbmRleEZpbGVDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0Y29weUhlYWRpbmdDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0Y3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBQbHVnaW4pIHtcclxuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZTtcclxuXHR9XHJcblxyXG5cdGRpc3BsYXkoKTogdm9pZCB7XHJcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cclxuXHRcdC8vIEdsb2JhbCBzZXR0aW5nc1xyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKFwiRGF0ZSBmb3JtYXRcIilcclxuXHRcdFx0LnNldERlc2MoXCJGb3JtYXQgZm9yIHRoZSBkYXRlIGluIHByb3BlcnRpZXMgKGUuZy4sIFlZWVktTU0tREQsIE1NTU0gRCwgWVlZWSwgWVlZWS1NTS1ERCBISDptbSkuXCIpXHJcblx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIllZWVktTU0tRERcIilcclxuXHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5kYXRlRm9ybWF0KVxyXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdHNldHRpbmdzLmRhdGVGb3JtYXQgPSB2YWx1ZSB8fCBcIllZWVktTU0tRERcIjtcclxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZShcIkVuYWJsZSBjb3B5IGhlYWRpbmcgbGlua3NcIilcclxuXHRcdFx0LnNldERlc2MoXCJBZGQgcmlnaHQtY2xpY2sgY29udGV4dCBtZW51IG9wdGlvbiB0byBjb3B5IGhlYWRpbmcgbGlua3MgaW4gdmFyaW91cyBmb3JtYXRzLlwiKVxyXG5cdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZW5hYmxlQ29weUhlYWRpbmdMaW5rKVxyXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRzZXR0aW5ncy5lbmFibGVDb3B5SGVhZGluZ0xpbmsgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdHRoaXMudXBkYXRlQ29weUhlYWRpbmdGaWVsZHMoKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0dGhpcy5jb3B5SGVhZGluZ0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJjb3B5LWhlYWRpbmctZmllbGRzXCIgfSk7XHJcblx0XHR0aGlzLmNvcHlIZWFkaW5nQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBzZXR0aW5ncy5lbmFibGVDb3B5SGVhZGluZ0xpbmsgPyBcImJsb2NrXCIgOiBcIm5vbmVcIjtcclxuXHJcblx0XHRuZXcgU2V0dGluZyh0aGlzLmNvcHlIZWFkaW5nQ29udGFpbmVyKVxyXG5cdFx0XHQuc2V0TmFtZShcIkRlZmF1bHQgaGVhZGluZyBsaW5rIGZvcm1hdFwiKVxyXG5cdFx0XHQuc2V0RGVzYyhcIkNob29zZSB0aGUgZGVmYXVsdCBmb3JtYXQgZm9yIGNvcGllZCBoZWFkaW5nIGxpbmtzLiBPYnNpZGlhbiBmb3JtYXQgcmVzcGVjdHMgeW91ciBPYnNpZGlhbiBzZXR0aW5ncyBmb3Igd2lraWxpbmsgdnMgbWFya2Rvd24gcHJlZmVyZW5jZS4gQXN0cm8gbGluayB1c2VzIHlvdXIgTGluayBiYXNlIHBhdGggZnJvbSBhYm92ZSBhbmQgY29udmVydHMgdGhlIGhlYWRpbmcgaW50byBrZWJhYi1jYXNlIGZvcm1hdCBhcyBhbiBhbmNob3IgbGluay5cIilcclxuXHRcdFx0LmFkZERyb3Bkb3duKChkcm9wZG93bikgPT5cclxuXHRcdFx0XHRkcm9wZG93blxyXG5cdFx0XHRcdFx0LmFkZE9wdGlvbihcIm9ic2lkaWFuXCIsIFwiT2JzaWRpYW4gbGlua1wiKVxyXG5cdFx0XHRcdFx0LmFkZE9wdGlvbihcImFzdHJvXCIsIFwiQXN0cm8gbGlua1wiKVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmNvcHlIZWFkaW5nTGlua0Zvcm1hdClcclxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRzZXR0aW5ncy5jb3B5SGVhZGluZ0xpbmtGb3JtYXQgPSB2YWx1ZSBhcyBcIm9ic2lkaWFuXCIgfCBcImFzdHJvXCI7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuXHRcdFx0LnNldE5hbWUoXCJBZGQgdHJhaWxpbmcgc2xhc2ggdG8gbGlua3NcIilcclxuXHRcdFx0LnNldERlc2MoXCJBZGQgdHJhaWxpbmcgc2xhc2hlcyB0byBhbGwgY29udmVydGVkIGludGVybmFsIGxpbmtzIChlLmcuLCAvYWJvdXQvIGluc3RlYWQgb2YgL2Fib3V0KS5cIilcclxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmFkZFRyYWlsaW5nU2xhc2hUb0xpbmtzKVxyXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRzZXR0aW5ncy5hZGRUcmFpbGluZ1NsYXNoVG9MaW5rcyA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0Ly8gUG9zdCBzZXR0aW5nc1xyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKFwiUG9zdCBzZXR0aW5nc1wiKVxyXG5cdFx0XHQuc2V0RGVzYyhcIlwiKVxyXG5cdFx0XHQuc2V0SGVhZGluZygpO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZShcIkF1dG9tYXRlIHBvc3QgY3JlYXRpb25cIilcclxuXHRcdFx0LnNldERlc2MoXCJBdXRvbWF0aWNhbGx5IHNob3cgdGl0bGUgZGlhbG9nIGZvciBuZXcgLm1kIGZpbGVzLCByZW5hbWUgdGhlbSBiYXNlZCBvbiB0aGUgdGl0bGUsIGFuZCBpbnNlcnQgcHJvcGVydGllcyBpZiBlbmFibGVkLlwiKVxyXG5cdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuYXV0b21hdGVQb3N0Q3JlYXRpb24pXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0XHRcdHNldHRpbmdzLmF1dG9tYXRlUG9zdENyZWF0aW9uID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdHNldHRpbmdzLmF1dG9JbnNlcnRQcm9wZXJ0aWVzID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckNyZWF0ZUV2ZW50KCk7XHJcblx0XHRcdFx0XHRcdHRoaXMudXBkYXRlQ29uZGl0aW9uYWxGaWVsZHMoKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0dGhpcy5hdXRvUmVuYW1lQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KHsgY2xzOiBcImF1dG8tcmVuYW1lLWZpZWxkc1wiIH0pO1xyXG5cdFx0dGhpcy5hdXRvUmVuYW1lQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBzZXR0aW5ncy5hdXRvbWF0ZVBvc3RDcmVhdGlvbiA/IFwiYmxvY2tcIiA6IFwibm9uZVwiO1xyXG5cclxuXHRcdHRoaXMuYXV0b0luc2VydENvbnRhaW5lciA9IHRoaXMuYXV0b1JlbmFtZUNvbnRhaW5lci5jcmVhdGVEaXYoKTtcclxuXHRcdG5ldyBTZXR0aW5nKHRoaXMuYXV0b0luc2VydENvbnRhaW5lcilcclxuXHRcdFx0LnNldE5hbWUoXCJBdXRvLWluc2VydCBwcm9wZXJ0aWVzXCIpXHJcblx0XHRcdC5zZXREZXNjKFwiQXV0b21hdGljYWxseSBpbnNlcnQgdGhlIHByb3BlcnRpZXMgdGVtcGxhdGUgd2hlbiBjcmVhdGluZyBuZXcgZmlsZXMgKHJlcXVpcmVzICdBdXRvbWF0ZSBwb3N0IGNyZWF0aW9uJyB0byBiZSBlbmFibGVkKS5cIilcclxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmF1dG9JbnNlcnRQcm9wZXJ0aWVzKVxyXG5cdFx0XHRcdFx0LnNldERpc2FibGVkKCFzZXR0aW5ncy5hdXRvbWF0ZVBvc3RDcmVhdGlvbilcclxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0c2V0dGluZ3MuYXV0b0luc2VydFByb3BlcnRpZXMgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdHRoaXMucG9zdHNGb2xkZXJDb250YWluZXIgPSB0aGlzLmF1dG9SZW5hbWVDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRuZXcgU2V0dGluZyh0aGlzLnBvc3RzRm9sZGVyQ29udGFpbmVyKVxyXG5cdFx0XHQuc2V0TmFtZShcIlBvc3RzIGZvbGRlclwiKVxyXG5cdFx0XHQuc2V0RGVzYyhcIkZvbGRlciBuYW1lIGZvciBibG9nIHBvc3RzIChsZWF2ZSBibGFuayB0byB1c2UgdGhlIHZhdWx0IGZvbGRlcikuIFlvdSBjYW4gc3BlY2lmeSB0aGUgZGVmYXVsdCBsb2NhdGlvbiBmb3IgbmV3IG5vdGVzIGluIE9ic2lkaWFuJ3MgJ0ZpbGVzIGFuZCBsaW5rcycgc2V0dGluZ3MuXCIpXHJcblx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIkVudGVyIGZvbGRlciBwYXRoXCIpXHJcblx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MucG9zdHNGb2xkZXIpXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0c2V0dGluZ3MucG9zdHNGb2xkZXIgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdHRoaXMudXBkYXRlT25seUF1dG9tYXRlRmllbGQoKTtcclxuXHRcdFx0XHRcdFx0dGhpcy51cGRhdGVFeGNsdWRlZERpcnNGaWVsZCgpO1xyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0KTtcclxuXHJcblxyXG5cdFx0dGhpcy5vbmx5QXV0b21hdGVDb250YWluZXIgPSB0aGlzLmF1dG9SZW5hbWVDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRuZXcgU2V0dGluZyh0aGlzLm9ubHlBdXRvbWF0ZUNvbnRhaW5lcilcclxuXHRcdFx0LnNldE5hbWUoXCJJZ25vcmUgc3ViZm9sZGVyc1wiKVxyXG5cdFx0XHQuc2V0RGVzYyhcIldoZW4gZW5hYmxlZCwgYXV0b21hdGlvbiB3aWxsIG9ubHkgdHJpZ2dlciBmb3IgbmV3IC5tZCBmaWxlcyB3aXRoaW4gdGhlIFBvc3RzIGZvbGRlciBhbmQgb25lIGxldmVsIGRvd24gKGZvciBmb2xkZXItYmFzZWQgcG9zdHMpLiBGaWxlcyBpbiBkZWVwZXIgc3ViZm9sZGVycyB3aWxsIGJlIGlnbm9yZWQuXCIpXHJcblx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuXHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5vbmx5QXV0b21hdGVJblBvc3RzRm9sZGVyKVxyXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRzZXR0aW5ncy5vbmx5QXV0b21hdGVJblBvc3RzRm9sZGVyID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUV4Y2x1ZGVkRGlyc0ZpZWxkKCk7XHJcblx0XHRcdFx0XHR9KVxyXG5cdFx0XHQpO1xyXG5cclxuXHRcdHRoaXMuZXhjbHVkZWREaXJzQ29udGFpbmVyID0gdGhpcy5hdXRvUmVuYW1lQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJleGNsdWRlZC1kaXJzLWZpZWxkXCIgfSk7XHJcblx0XHR0aGlzLmV4Y2x1ZGVkRGlyc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gIXNldHRpbmdzLm9ubHlBdXRvbWF0ZUluUG9zdHNGb2xkZXIgPyBcImJsb2NrXCIgOiBcIm5vbmVcIjtcclxuXHJcblx0XHRuZXcgU2V0dGluZyh0aGlzLmV4Y2x1ZGVkRGlyc0NvbnRhaW5lcilcclxuXHRcdFx0LnNldE5hbWUoXCJFeGNsdWRlZCBkaXJlY3Rvcmllc1wiKVxyXG5cdFx0XHQuc2V0RGVzYyhcIkRpcmVjdG9yaWVzIHRvIGV4Y2x1ZGUgZnJvbSBhdXRvbWF0aWMgcG9zdCBjcmVhdGlvbiAoZS5nLiwgcGFnZXN8cG9zdHMvZXhhbXBsZSkuIEV4Y2x1ZGVkIGRpcmVjdG9yaWVzIGFuZCB0aGVpciBjaGlsZCBmb2xkZXJzIHdpbGwgYmUgaWdub3JlZC4gVXNlICd8JyB0byBzZXBhcmF0ZSBtdWx0aXBsZSBkaXJlY3Rvcmllcy5cIilcclxuXHRcdFx0LmFkZFRleHQoKHRleHQpID0+XHJcblx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwicGFnZXN8cG9zdHMvZXhhbXBsZVwiKVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmV4Y2x1ZGVkRGlyZWN0b3JpZXMpXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0c2V0dGluZ3MuZXhjbHVkZWREaXJlY3RvcmllcyA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcodGhpcy5hdXRvUmVuYW1lQ29udGFpbmVyKVxyXG5cdFx0XHQuc2V0TmFtZShcIlBvc3RzIGxpbmsgYmFzZSBwYXRoXCIpXHJcblx0XHRcdC5zZXREZXNjKFwiQmFzZSBwYXRoIGZvciBjb252ZXJ0ZWQgbGlua3MgaW4gcG9zdHMgKGUuZy4sIC9ibG9nLywgbGVhdmUgYmxhbmsgZm9yIHJvb3QgLykuXCIpXHJcblx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIi9ibG9nL1wiKVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLnBvc3RzTGlua0Jhc2VQYXRoKVxyXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdHNldHRpbmdzLnBvc3RzTGlua0Jhc2VQYXRoID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0KTtcclxuXHJcblx0XHR0aGlzLmNyZWF0aW9uTW9kZUNvbnRhaW5lciA9IHRoaXMuYXV0b1JlbmFtZUNvbnRhaW5lci5jcmVhdGVEaXYoKTtcclxuXHRcdG5ldyBTZXR0aW5nKHRoaXMuY3JlYXRpb25Nb2RlQ29udGFpbmVyKVxyXG5cdFx0XHQuc2V0TmFtZShcIkNyZWF0aW9uIG1vZGVcIilcclxuXHRcdFx0LnNldERlc2MoXCJIb3cgdG8gY3JlYXRlIG5ldyBlbnRyaWVzOiBmaWxlLWJhc2VkIG9yIGZvbGRlci1iYXNlZCB3aXRoIGFuIGluZGV4IGZpbGUuXCIpXHJcblx0XHRcdC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+XHJcblx0XHRcdFx0ZHJvcGRvd25cclxuXHRcdFx0XHRcdC5hZGRPcHRpb24oXCJmaWxlXCIsIFwiRmlsZS1iYXNlZCAocG9zdC10aXRsZS5tZClcIilcclxuXHRcdFx0XHRcdC5hZGRPcHRpb24oXCJmb2xkZXJcIiwgXCJGb2xkZXItYmFzZWQgKHBvc3QtdGl0bGUvaW5kZXgubWQpXCIpXHJcblx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuY3JlYXRpb25Nb2RlKVxyXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdHNldHRpbmdzLmNyZWF0aW9uTW9kZSA9IHZhbHVlIGFzIFwiZmlsZVwiIHwgXCJmb2xkZXJcIjtcclxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdHRoaXMudXBkYXRlSW5kZXhGaWxlRmllbGQoKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0dGhpcy5pbmRleEZpbGVDb250YWluZXIgPSB0aGlzLmF1dG9SZW5hbWVDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImluZGV4LWZpbGUtZmllbGRcIiB9KTtcclxuXHRcdHRoaXMuaW5kZXhGaWxlQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSBzZXR0aW5ncy5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIgPyBcImJsb2NrXCIgOiBcIm5vbmVcIjtcclxuXHJcblx0XHRuZXcgU2V0dGluZyh0aGlzLmluZGV4RmlsZUNvbnRhaW5lcilcclxuXHRcdFx0LnNldE5hbWUoXCJJbmRleCBmaWxlIG5hbWVcIilcclxuXHRcdFx0LnNldERlc2MoXCJOYW1lIGZvciBpbmRleCBmaWxlcyBpbiBmb2xkZXItYmFzZWQgY29udGVudCAod2l0aG91dCAubWQgZXh0ZW5zaW9uKS4gRGVmYXVsdHMgdG8gJ2luZGV4JyBpZiBsZWZ0IGJsYW5rLlwiKVxyXG5cdFx0XHQuYWRkVGV4dCgodGV4dCkgPT5cclxuXHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJpbmRleFwiKVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmluZGV4RmlsZU5hbWUpXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0c2V0dGluZ3MuaW5kZXhGaWxlTmFtZSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0dGhpcy51bmRlcnNjb3JlUHJlZml4Q29udGFpbmVyID0gdGhpcy5hdXRvUmVuYW1lQ29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG5cdFx0bmV3IFNldHRpbmcodGhpcy51bmRlcnNjb3JlUHJlZml4Q29udGFpbmVyKVxyXG5cdFx0XHQuc2V0TmFtZShcIlVzZSB1bmRlcnNjb3JlIHByZWZpeCBmb3IgZHJhZnRzXCIpXHJcblx0XHRcdC5zZXREZXNjKFwiQWRkIGFuIHVuZGVyc2NvcmUgcHJlZml4IChfcG9zdC10aXRsZSkgdG8gbmV3IG5vdGVzIGJ5IGRlZmF1bHQgd2hlbiBlbmFibGVkLiBUaGlzIGhpZGVzIHRoZW0gZnJvbSBBc3Rybywgd2hpY2ggY2FuIGJlIGhlbHBmdWwgZm9yIHBvc3QgZHJhZnRzLiBEaXNhYmxlIHRvIHNraXAgcHJlZml4aW5nLlwiKVxyXG5cdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZW5hYmxlVW5kZXJzY29yZVByZWZpeClcclxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0c2V0dGluZ3MuZW5hYmxlVW5kZXJzY29yZVByZWZpeCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZShcIlBvc3QgcHJvcGVydGllcyB0ZW1wbGF0ZVwiKVxyXG5cdFx0XHQuYWRkVGV4dEFyZWEoKHRleHQpID0+IHtcclxuXHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXHJcblx0XHRcdFx0XHRcdCctLS1cXG50aXRsZTogXCJ7e3RpdGxlfX1cIlxcbmRhdGU6IHt7ZGF0ZX19XFxudGFnczogW11cXG4tLS1cXG4nLFxyXG5cdFx0XHRcdFx0KVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmRlZmF1bHRUZW1wbGF0ZSlcclxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRzZXR0aW5ncy5kZWZhdWx0VGVtcGxhdGUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR0ZXh0LmlucHV0RWwuY2xhc3NMaXN0LmFkZChcImFzdHJvLWNvbXBvc2VyLXRlbXBsYXRlLXRleHRhcmVhXCIpO1xyXG5cdFx0XHRcdHJldHVybiB0ZXh0O1xyXG5cdFx0XHR9KVxyXG5cdFx0XHQudGhlbigoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdHNldHRpbmcuZGVzY0VsLmVtcHR5KCk7XHJcblx0XHRcdFx0Y29uc3QgZGVzY0RpdiA9IHNldHRpbmcuZGVzY0VsLmNyZWF0ZUVsKFwiZGl2XCIpO1xyXG5cdFx0XHRcdGRlc2NEaXYuaW5uZXJIVE1MID0gXHJcblx0XHRcdFx0XHRcIlVzZWQgZm9yIG5ldyBwb3N0cyBhbmQgd2hlbiBzdGFuZGFyZGl6aW5nIHByb3BlcnRpZXMuPGJyIC8+XCIgK1xyXG5cdFx0XHRcdFx0XCJWYXJpYWJsZXMgaW5jbHVkZSB7e3RpdGxlfX0gYW5kIHt7ZGF0ZX19LjxiciAvPlwiICtcclxuXHRcdFx0XHRcdFwiRG8gbm90IHdyYXAge3tkYXRlfX0gaW4gcXVvdGVzIGFzIGl0IHJlcHJlc2VudHMgYSBkYXRldGltZSB2YWx1ZSwgbm90IGEgc3RyaW5nLjxiciAvPlwiICtcclxuXHRcdFx0XHRcdFwiVGhlICdzdGFuZGFyZGl6ZSBwcm9wZXJ0aWVzJyBjb21tYW5kIGlnbm9yZXMgYW55dGhpbmcgYmVsb3cgdGhlIHNlY29uZCAnLS0tJyBsaW5lLlwiO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHQvLyBQYWdlcyBzZXR0aW5nc1xyXG5cdFx0bmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcblx0XHRcdC5zZXROYW1lKFwiUGFnZSBzZXR0aW5nc1wiKVxyXG5cdFx0XHQuc2V0RGVzYyhcIlwiKVxyXG5cdFx0XHQuc2V0SGVhZGluZygpO1xyXG5cclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZShcIkVuYWJsZSBwYWdlc1wiKVxyXG5cdFx0XHQuc2V0RGVzYyhcIkVuYWJsZSBwYWdlIGNvbnRlbnQgdHlwZSBmb3Igc3RhdGljIHBhZ2VzLlwiKVxyXG5cdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZW5hYmxlUGFnZXMpXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0XHRcdHNldHRpbmdzLmVuYWJsZVBhZ2VzID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckNyZWF0ZUV2ZW50KCk7XHJcblx0XHRcdFx0XHRcdHRoaXMudXBkYXRlUGFnZXNGaWVsZHMoKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0dGhpcy5wYWdlc0ZpZWxkc0NvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJwYWdlcy1maWVsZHNcIiB9KTtcclxuXHRcdHRoaXMucGFnZXNGaWVsZHNDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IHNldHRpbmdzLmVuYWJsZVBhZ2VzID8gXCJibG9ja1wiIDogXCJub25lXCI7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcodGhpcy5wYWdlc0ZpZWxkc0NvbnRhaW5lcilcclxuXHRcdFx0LnNldE5hbWUoXCJQYWdlcyBmb2xkZXJcIilcclxuXHRcdFx0LnNldERlc2MoXCJGb2xkZXIgbmFtZSBmb3IgcGFnZXMgKGxlYXZlIGJsYW5rIHRvIHVzZSB0aGUgdmF1bHQgZm9sZGVyKS5cIilcclxuXHRcdFx0LmFkZFRleHQoKHRleHQpID0+XHJcblx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiRW50ZXIgZm9sZGVyIHBhdGhcIilcclxuXHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5wYWdlc0ZvbGRlcilcclxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRzZXR0aW5ncy5wYWdlc0ZvbGRlciA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0bmV3IFNldHRpbmcodGhpcy5wYWdlc0ZpZWxkc0NvbnRhaW5lcilcclxuXHRcdFx0LnNldE5hbWUoXCJQYWdlcyBsaW5rIGJhc2UgcGF0aFwiKVxyXG5cdFx0XHQuc2V0RGVzYyhcIkJhc2UgcGF0aCBmb3IgY29udmVydGVkIGxpbmtzIGluIHBhZ2VzIChlLmcuLCAvYWJvdXQvLCBsZWF2ZSBibGFuayBmb3Igcm9vdCAvKS5cIilcclxuXHRcdFx0LmFkZFRleHQoKHRleHQpID0+XHJcblx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiL1wiKVxyXG5cdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLnBhZ2VzTGlua0Jhc2VQYXRoKVxyXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdHNldHRpbmdzLnBhZ2VzTGlua0Jhc2VQYXRoID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyh0aGlzLnBhZ2VzRmllbGRzQ29udGFpbmVyKVxyXG5cdFx0XHQuc2V0TmFtZShcIkNyZWF0aW9uIG1vZGVcIilcclxuXHRcdFx0LnNldERlc2MoXCJIb3cgdG8gY3JlYXRlIG5ldyBlbnRyaWVzOiBmaWxlLWJhc2VkIG9yIGZvbGRlci1iYXNlZCB3aXRoIGFuIGluZGV4IGZpbGUuXCIpXHJcblx0XHRcdC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+XHJcblx0XHRcdFx0ZHJvcGRvd25cclxuXHRcdFx0XHRcdC5hZGRPcHRpb24oXCJmaWxlXCIsIFwiRmlsZS1iYXNlZCAocGFnZS10aXRsZS5tZClcIilcclxuXHRcdFx0XHRcdC5hZGRPcHRpb24oXCJmb2xkZXJcIiwgXCJGb2xkZXItYmFzZWQgKHBhZ2UtdGl0bGUvaW5kZXgubWQpXCIpXHJcblx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MucGFnZXNDcmVhdGlvbk1vZGUgfHwgXCJmaWxlXCIpXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0c2V0dGluZ3MucGFnZXNDcmVhdGlvbk1vZGUgPSB2YWx1ZSBhcyBcImZpbGVcIiB8IFwiZm9sZGVyXCI7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZVBhZ2VzSW5kZXhGaWxlRmllbGQoKTtcclxuXHRcdFx0XHRcdH0pXHJcblx0XHRcdCk7XHJcblxyXG5cdFx0dGhpcy5wYWdlc0luZGV4RmlsZUNvbnRhaW5lciA9IHRoaXMucGFnZXNGaWVsZHNDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcInBhZ2VzLWluZGV4LWZpbGUtZmllbGRcIiB9KTtcclxuXHRcdHRoaXMucGFnZXNJbmRleEZpbGVDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IChzZXR0aW5ncy5wYWdlc0NyZWF0aW9uTW9kZSB8fCBcImZpbGVcIikgPT09IFwiZm9sZGVyXCIgPyBcImJsb2NrXCIgOiBcIm5vbmVcIjtcclxuXHJcblx0XHRuZXcgU2V0dGluZyh0aGlzLnBhZ2VzSW5kZXhGaWxlQ29udGFpbmVyKVxyXG5cdFx0XHQuc2V0TmFtZShcIkluZGV4IGZpbGUgbmFtZVwiKVxyXG5cdFx0XHQuc2V0RGVzYyhcIk5hbWUgZm9yIGluZGV4IGZpbGVzIGluIGZvbGRlci1iYXNlZCBjb250ZW50ICh3aXRob3V0IC5tZCBleHRlbnNpb24pLiBEZWZhdWx0cyB0byAnaW5kZXgnIGlmIGxlZnQgYmxhbmsuXCIpXHJcblx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcImluZGV4XCIpXHJcblx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MucGFnZXNJbmRleEZpbGVOYW1lIHx8IFwiXCIpXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0c2V0dGluZ3MucGFnZXNJbmRleEZpbGVOYW1lID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0fSlcclxuXHRcdFx0KTtcclxuXHJcblx0XHRuZXcgU2V0dGluZyh0aGlzLnBhZ2VzRmllbGRzQ29udGFpbmVyKVxyXG5cdFx0XHQuc2V0TmFtZShcIlBhZ2UgcHJvcGVydGllcyB0ZW1wbGF0ZVwiKVxyXG5cdFx0XHQuc2V0RGVzYyhcIlRlbXBsYXRlIGZvciBuZXcgcGFnZSBmaWxlcy4gVmFyaWFibGVzIGluY2x1ZGUge3t0aXRsZX19IGFuZCB7e2RhdGV9fS5cIilcclxuXHRcdFx0LmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB7XHJcblx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCctLS1cXG50aXRsZTogXCJ7e3RpdGxlfX1cIlxcbmRlc2NyaXB0aW9uOiBcIlwiXFxuLS0tXFxuJylcclxuXHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5wYWdlVGVtcGxhdGUpXHJcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0c2V0dGluZ3MucGFnZVRlbXBsYXRlID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0dGV4dC5pbnB1dEVsLmNsYXNzTGlzdC5hZGQoXCJhc3Ryby1jb21wb3Nlci10ZW1wbGF0ZS10ZXh0YXJlYVwiKTtcclxuXHRcdFx0XHRyZXR1cm4gdGV4dDtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0Ly8gQ3VzdG9tIGNvbnRlbnQgdHlwZXNcclxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG5cdFx0XHQuc2V0TmFtZShcIkN1c3RvbSBjb250ZW50IHR5cGVzXCIpXHJcblx0XHRcdC5zZXREZXNjKFwiXCIpXHJcblx0XHRcdC5zZXRIZWFkaW5nKCk7XHJcblxyXG5cdFx0dGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwiY3VzdG9tLWNvbnRlbnQtdHlwZXMtY29udGFpbmVyXCIgfSk7XHJcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xyXG5cclxuXHRcdHRoaXMudXBkYXRlQ29uZGl0aW9uYWxGaWVsZHMoKTtcclxuXHRcdHRoaXMudXBkYXRlSW5kZXhGaWxlRmllbGQoKTtcclxuXHRcdHRoaXMudXBkYXRlRXhjbHVkZWREaXJzRmllbGQoKTtcclxuXHRcdHRoaXMudXBkYXRlT25seUF1dG9tYXRlRmllbGQoKTtcclxuXHRcdHRoaXMudXBkYXRlUGFnZXNGaWVsZHMoKTtcclxuXHRcdHRoaXMudXBkYXRlQ29weUhlYWRpbmdGaWVsZHMoKTtcclxuXHR9XHJcblxyXG5cdHVwZGF0ZUNvbmRpdGlvbmFsRmllbGRzKCkge1xyXG5cdFx0aWYgKHRoaXMuYXV0b1JlbmFtZUNvbnRhaW5lcikge1xyXG5cdFx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0XHR0aGlzLmF1dG9SZW5hbWVDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IHNldHRpbmdzLmF1dG9tYXRlUG9zdENyZWF0aW9uID8gXCJibG9ja1wiIDogXCJub25lXCI7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHR1cGRhdGVJbmRleEZpbGVGaWVsZCgpIHtcclxuXHRcdGlmICh0aGlzLmluZGV4RmlsZUNvbnRhaW5lcikge1xyXG5cdFx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0XHR0aGlzLmluZGV4RmlsZUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gc2V0dGluZ3MuY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiID8gXCJibG9ja1wiIDogXCJub25lXCI7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHR1cGRhdGVPbmx5QXV0b21hdGVGaWVsZCgpIHtcclxuXHRcdGlmICh0aGlzLm9ubHlBdXRvbWF0ZUNvbnRhaW5lcikge1xyXG5cdFx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0XHQvLyBIaWRlIFwiSWdub3JlIHN1YmZvbGRlcnNcIiB3aGVuIFBvc3RzIGZvbGRlciBpcyBibGFua1xyXG5cdFx0XHR0aGlzLm9ubHlBdXRvbWF0ZUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gc2V0dGluZ3MucG9zdHNGb2xkZXIgPyBcImJsb2NrXCIgOiBcIm5vbmVcIjtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHVwZGF0ZUV4Y2x1ZGVkRGlyc0ZpZWxkKCkge1xyXG5cdFx0aWYgKHRoaXMuZXhjbHVkZWREaXJzQ29udGFpbmVyKSB7XHJcblx0XHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRcdC8vIEhpZGUgXCJFeGNsdWRlZCBkaXJlY3Rvcmllc1wiIHdoZW4gUG9zdHMgZm9sZGVyIGlzIGJsYW5rIE9SIHdoZW4gXCJJZ25vcmUgc3ViZm9sZGVyc1wiIGlzIGVuYWJsZWRcclxuXHRcdFx0dGhpcy5leGNsdWRlZERpcnNDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IHNldHRpbmdzLnBvc3RzRm9sZGVyICYmICFzZXR0aW5ncy5vbmx5QXV0b21hdGVJblBvc3RzRm9sZGVyID8gXCJibG9ja1wiIDogXCJub25lXCI7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHR1cGRhdGVQYWdlc0ZpZWxkcygpIHtcclxuXHRcdGlmICh0aGlzLnBhZ2VzRmllbGRzQ29udGFpbmVyKSB7XHJcblx0XHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRcdHRoaXMucGFnZXNGaWVsZHNDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IHNldHRpbmdzLmVuYWJsZVBhZ2VzID8gXCJibG9ja1wiIDogXCJub25lXCI7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHR1cGRhdGVDb3B5SGVhZGluZ0ZpZWxkcygpIHtcclxuXHRcdGlmICh0aGlzLmNvcHlIZWFkaW5nQ29udGFpbmVyKSB7XHJcblx0XHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRcdHRoaXMuY29weUhlYWRpbmdDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IHNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluayA/IFwiYmxvY2tcIiA6IFwibm9uZVwiO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Y2hlY2tGb3JGb2xkZXJDb25mbGljdHMoKSB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgYmxhbmtGb2xkZXJzOiBzdHJpbmdbXSA9IFtdO1xyXG5cdFx0Y29uc3QgZm9sZGVyQ29uZmxpY3RzOiB7IFtmb2xkZXI6IHN0cmluZ106IHN0cmluZ1tdIH0gPSB7fTtcclxuXHRcdFxyXG5cdFx0Ly8gQ2hlY2sgcG9zdHMgZm9sZGVyXHJcblx0XHRpZiAoIXNldHRpbmdzLnBvc3RzRm9sZGVyICYmIHNldHRpbmdzLmF1dG9tYXRlUG9zdENyZWF0aW9uKSB7XHJcblx0XHRcdGJsYW5rRm9sZGVycy5wdXNoKFwiUG9zdHNcIik7XHJcblx0XHR9IGVsc2UgaWYgKHNldHRpbmdzLnBvc3RzRm9sZGVyICYmIHNldHRpbmdzLmF1dG9tYXRlUG9zdENyZWF0aW9uKSB7XHJcblx0XHRcdGlmICghZm9sZGVyQ29uZmxpY3RzW3NldHRpbmdzLnBvc3RzRm9sZGVyXSkge1xyXG5cdFx0XHRcdGZvbGRlckNvbmZsaWN0c1tzZXR0aW5ncy5wb3N0c0ZvbGRlcl0gPSBbXTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmb2xkZXJDb25mbGljdHNbc2V0dGluZ3MucG9zdHNGb2xkZXJdLnB1c2goXCJQb3N0c1wiKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly8gQ2hlY2sgcGFnZXMgZm9sZGVyXHJcblx0XHRpZiAoIXNldHRpbmdzLnBhZ2VzRm9sZGVyICYmIHNldHRpbmdzLmVuYWJsZVBhZ2VzKSB7XHJcblx0XHRcdGJsYW5rRm9sZGVycy5wdXNoKFwiUGFnZXNcIik7XHJcblx0XHR9IGVsc2UgaWYgKHNldHRpbmdzLnBhZ2VzRm9sZGVyICYmIHNldHRpbmdzLmVuYWJsZVBhZ2VzKSB7XHJcblx0XHRcdGlmICghZm9sZGVyQ29uZmxpY3RzW3NldHRpbmdzLnBhZ2VzRm9sZGVyXSkge1xyXG5cdFx0XHRcdGZvbGRlckNvbmZsaWN0c1tzZXR0aW5ncy5wYWdlc0ZvbGRlcl0gPSBbXTtcclxuXHRcdFx0fVxyXG5cdFx0XHRmb2xkZXJDb25mbGljdHNbc2V0dGluZ3MucGFnZXNGb2xkZXJdLnB1c2goXCJQYWdlc1wiKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly8gQ2hlY2sgY3VzdG9tIGNvbnRlbnQgdHlwZXNcclxuXHRcdGZvciAoY29uc3QgY3VzdG9tVHlwZSBvZiBzZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXMpIHtcclxuXHRcdFx0aWYgKGN1c3RvbVR5cGUuZW5hYmxlZCkge1xyXG5cdFx0XHRcdGlmICghY3VzdG9tVHlwZS5mb2xkZXIpIHtcclxuXHRcdFx0XHRcdGJsYW5rRm9sZGVycy5wdXNoKGN1c3RvbVR5cGUubmFtZSB8fCBcIkN1c3RvbSBDb250ZW50XCIpO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRpZiAoIWZvbGRlckNvbmZsaWN0c1tjdXN0b21UeXBlLmZvbGRlcl0pIHtcclxuXHRcdFx0XHRcdFx0Zm9sZGVyQ29uZmxpY3RzW2N1c3RvbVR5cGUuZm9sZGVyXSA9IFtdO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Zm9sZGVyQ29uZmxpY3RzW2N1c3RvbVR5cGUuZm9sZGVyXS5wdXNoKGN1c3RvbVR5cGUubmFtZSB8fCBcIkN1c3RvbSBDb250ZW50XCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvLyBDaGVjayBmb3IgY29uZmxpY3RzXHJcblx0XHRsZXQgaGFzQ29uZmxpY3RzID0gZmFsc2U7XHJcblx0XHRsZXQgY29uZmxpY3RNZXNzYWdlID0gXCJcIjtcclxuXHRcdFxyXG5cdFx0Ly8gQ2hlY2sgYmxhbmsgZm9sZGVyIGNvbmZsaWN0c1xyXG5cdFx0aWYgKGJsYW5rRm9sZGVycy5sZW5ndGggPiAxKSB7XHJcblx0XHRcdGhhc0NvbmZsaWN0cyA9IHRydWU7XHJcblx0XHRcdGNvbmZsaWN0TWVzc2FnZSArPSBgTXVsdGlwbGUgY29udGVudCB0eXBlcyBhcmUgc2V0IHRvIHVzZSB0aGUgdmF1bHQgcm9vdDogPHN0cm9uZz4ke2JsYW5rRm9sZGVycy5qb2luKFwiLCBcIil9PC9zdHJvbmc+PGJyPjxicj5gO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHQvLyBDaGVjayBzYW1lIGZvbGRlciBjb25mbGljdHNcclxuXHRcdGZvciAoY29uc3QgW2ZvbGRlciwgY29udGVudFR5cGVzXSBvZiBPYmplY3QuZW50cmllcyhmb2xkZXJDb25mbGljdHMpKSB7XHJcblx0XHRcdGlmIChjb250ZW50VHlwZXMubGVuZ3RoID4gMSkge1xyXG5cdFx0XHRcdGhhc0NvbmZsaWN0cyA9IHRydWU7XHJcblx0XHRcdFx0Y29uZmxpY3RNZXNzYWdlICs9IGBNdWx0aXBsZSBjb250ZW50IHR5cGVzIGFyZSBzZXQgdG8gdXNlIHRoZSBzYW1lIGZvbGRlciBcIiR7Zm9sZGVyfVwiOiA8c3Ryb25nPiR7Y29udGVudFR5cGVzLmpvaW4oXCIsIFwiKX08L3N0cm9uZz48YnI+PGJyPmA7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly8gV2FybmluZyBib3ggcmVtb3ZlZCAtIGNvbmZsaWN0cyBhcmUgc3RpbGwgZGV0ZWN0ZWQgYXQgcnVudGltZVxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBhZGRDdXN0b21Db250ZW50VHlwZSgpIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRjb25zdCBuZXdUeXBlOiBDdXN0b21Db250ZW50VHlwZSA9IHtcclxuXHRcdFx0aWQ6IGBjdXN0b20tJHtEYXRlLm5vdygpfWAsXHJcblx0XHRcdG5hbWU6IGBDdXN0b20gJHtzZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXMubGVuZ3RoICsgMX1gLFxyXG5cdFx0XHRmb2xkZXI6IFwiXCIsXHJcblx0XHRcdGxpbmtCYXNlUGF0aDogXCJcIixcclxuXHRcdFx0dGVtcGxhdGU6ICctLS1cXG50aXRsZTogXCJ7e3RpdGxlfX1cIlxcbmRhdGU6IHt7ZGF0ZX19XFxuLS0tXFxuJyxcclxuXHRcdFx0ZW5hYmxlZDogdHJ1ZSxcclxuXHRcdFx0Y3JlYXRpb25Nb2RlOiBcImZpbGVcIixcclxuXHRcdFx0aW5kZXhGaWxlTmFtZTogXCJcIixcclxuXHRcdH07XHJcblx0XHRzZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXMucHVzaChuZXdUeXBlKTtcclxuXHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0dGhpcy5yZW5kZXJDdXN0b21Db250ZW50VHlwZXMoKTtcclxuXHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyQ3JlYXRlRXZlbnQoKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCkge1xyXG5cdFx0aWYgKCF0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcikgcmV0dXJuO1xyXG5cdFx0XHJcblx0XHR0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lci5lbXB0eSgpO1xyXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuXHJcblx0XHRzZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXMuZm9yRWFjaCgoY3VzdG9tVHlwZTogQ3VzdG9tQ29udGVudFR5cGUsIGluZGV4OiBudW1iZXIpID0+IHtcclxuXHRcdFx0aWYgKCF0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcikgcmV0dXJuO1xyXG5cdFx0XHRjb25zdCB0eXBlQ29udGFpbmVyID0gdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXIuY3JlYXRlRGl2KHsgXHJcblx0XHRcdFx0Y2xzOiBcImN1c3RvbS1jb250ZW50LXR5cGUtaXRlbVwiLFxyXG5cdFx0XHRcdGF0dHI6IHsgXCJkYXRhLXR5cGUtaWRcIjogY3VzdG9tVHlwZS5pZCB9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gSGVhZGVyIHdpdGggbmFtZSBhbmQgdG9nZ2xlIG9uIHRoZSBmYXIgcmlnaHRcclxuXHRcdFx0Y29uc3QgaGVhZGVyID0gdHlwZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiY3VzdG9tLWNvbnRlbnQtdHlwZS1oZWFkZXJcIiB9KTtcclxuXHRcdFx0aGVhZGVyLnN0eWxlLmRpc3BsYXkgPSBcImZsZXhcIjtcclxuXHRcdFx0aGVhZGVyLnN0eWxlLmp1c3RpZnlDb250ZW50ID0gXCJzcGFjZS1iZXR3ZWVuXCI7XHJcblx0XHRcdGhlYWRlci5zdHlsZS5hbGlnbkl0ZW1zID0gXCJjZW50ZXJcIjtcclxuXHRcdFx0aGVhZGVyLnN0eWxlLnBhZGRpbmcgPSBcIjhweCAwXCI7XHJcblx0XHRcdFxyXG5cdFx0XHQvLyBMZWZ0IHNpZGUgLSBqdXN0IHRoZSBuYW1lXHJcblx0XHRcdGNvbnN0IGhlYWRlck5hbWUgPSBoZWFkZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRcdGhlYWRlck5hbWUuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBgQ3VzdG9tICR7aW5kZXggKyAxfWAsIGNsczogXCJzZXR0aW5nLWl0ZW0tbmFtZVwiIH0pO1xyXG5cdFx0XHRcclxuXHRcdFx0Ly8gUmlnaHQgc2lkZSAtIHRvZ2dsZVxyXG5cdFx0XHRjb25zdCB0b2dnbGVDb250YWluZXIgPSBoZWFkZXIuY3JlYXRlRGl2KHsgY2xzOiBcImNoZWNrYm94LWNvbnRhaW5lclwiIH0pO1xyXG5cdFx0XHRpZiAoY3VzdG9tVHlwZS5lbmFibGVkKSB7XHJcblx0XHRcdFx0dG9nZ2xlQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJpcy1lbmFibGVkXCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHRjb25zdCB0b2dnbGUgPSB0b2dnbGVDb250YWluZXIuY3JlYXRlRWwoXCJpbnB1dFwiLCB7IHR5cGU6IFwiY2hlY2tib3hcIiwgY2xzOiBcImNoZWNrYm94LWlucHV0XCIgfSk7XHJcblx0XHRcdHRvZ2dsZS5jaGVja2VkID0gY3VzdG9tVHlwZS5lbmFibGVkO1xyXG5cdFx0XHRcclxuXHRcdFx0Ly8gQWRkIGNsaWNrIGV2ZW50IHRvIHRoZSBjb250YWluZXIgYXMgd2VsbFxyXG5cdFx0XHR0b2dnbGVDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGFzeW5jIChlKSA9PiB7XHJcblx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cdFx0XHRcdGNvbnN0IG5ld1ZhbHVlID0gIWN1c3RvbVR5cGUuZW5hYmxlZDtcclxuXHRcdFx0XHRjdXN0b21UeXBlLmVuYWJsZWQgPSBuZXdWYWx1ZTtcclxuXHRcdFx0XHR0b2dnbGUuY2hlY2tlZCA9IG5ld1ZhbHVlO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyQ3JlYXRlRXZlbnQoKTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHQvLyBVcGRhdGUgdGhlIGNvbnRhaW5lciBjbGFzcyBmb3IgdmlzdWFsIGZlZWRiYWNrXHJcblx0XHRcdFx0aWYgKG5ld1ZhbHVlKSB7XHJcblx0XHRcdFx0XHR0b2dnbGVDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImlzLWVuYWJsZWRcIik7XHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdHRvZ2dsZUNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiaXMtZW5hYmxlZFwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0Ly8gVXBkYXRlIHZpc2liaWxpdHlcclxuXHRcdFx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlVmlzaWJpbGl0eShjdXN0b21UeXBlLmlkLCBuZXdWYWx1ZSk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0Ly8gQ29uZmxpY3QgY2hlY2tpbmcgcmVtb3ZlZCBmcm9tIHNldHRpbmdzIFVJXHJcblx0XHRcdH0pO1xyXG5cdFx0XHRcclxuXHRcdFx0Ly8gQWxzbyBhZGQgY2hhbmdlIGV2ZW50IGFzIGJhY2t1cFxyXG5cdFx0XHR0b2dnbGUuYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBhc3luYyAoZSkgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IHZhbHVlID0gKGUudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLmNoZWNrZWQ7XHJcblx0XHRcdFx0Y3VzdG9tVHlwZS5lbmFibGVkID0gdmFsdWU7XHJcblx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJDcmVhdGVFdmVudCgpO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdC8vIFVwZGF0ZSB0aGUgY29udGFpbmVyIGNsYXNzIGZvciB2aXN1YWwgZmVlZGJhY2tcclxuXHRcdFx0XHRpZiAodmFsdWUpIHtcclxuXHRcdFx0XHRcdHRvZ2dsZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaXMtZW5hYmxlZFwiKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0dG9nZ2xlQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1lbmFibGVkXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRcclxuXHRcdFx0XHQvLyBVcGRhdGUgdmlzaWJpbGl0eVxyXG5cdFx0XHRcdHRoaXMudXBkYXRlQ3VzdG9tQ29udGVudFR5cGVWaXNpYmlsaXR5KGN1c3RvbVR5cGUuaWQsIHZhbHVlKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBTZXR0aW5ncyBjb250YWluZXIgdGhhdCBjYW4gYmUgY29sbGFwc2VkXHJcblx0XHRcdGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gdHlwZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBcclxuXHRcdFx0XHRjbHM6IFwiY3VzdG9tLWNvbnRlbnQtdHlwZS1zZXR0aW5nc1wiLFxyXG5cdFx0XHRcdGF0dHI6IHsgXCJkYXRhLXR5cGUtaWRcIjogY3VzdG9tVHlwZS5pZCB9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gQ29udGVudCB0eXBlIG5hbWVcclxuXHRcdFx0Y29uc3QgbmFtZUNvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG5cdFx0XHRuZXcgU2V0dGluZyhuYW1lQ29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiQ29udGVudCB0eXBlIG5hbWVcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIkRpc3BsYXkgbmFtZSBmb3IgdGhpcyBjb250ZW50IHR5cGUgKGUuZy4sICdQcm9qZWN0cycsICdOb3RlcycsICdUdXRvcmlhbHMnKVwiKVxyXG5cdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PiB7XHJcblx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIkVudGVyIGNvbnRlbnQgdHlwZSBuYW1lXCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShjdXN0b21UeXBlLm5hbWUpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUubmFtZSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIEZvbGRlciBsb2NhdGlvblxyXG5cdFx0XHRjb25zdCBmb2xkZXJDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcclxuXHRcdFx0bmV3IFNldHRpbmcoZm9sZGVyQ29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiRm9sZGVyIGxvY2F0aW9uXCIpXHJcblx0XHRcdFx0LnNldERlc2MoXCJGb2xkZXIgcGF0aCB3aGVyZSB0aGlzIGNvbnRlbnQgdHlwZSB3aWxsIGJlIGNyZWF0ZWQgKGUuZy4sICdwcm9qZWN0cycsICdub3Rlcy90dXRvcmlhbHMnKVwiKVxyXG5cdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PiB7XHJcblx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIkVudGVyIGZvbGRlciBwYXRoXCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShjdXN0b21UeXBlLmZvbGRlcilcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0Y3VzdG9tVHlwZS5mb2xkZXIgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckNyZWF0ZUV2ZW50KCk7XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gTGluayBiYXNlIHBhdGhcclxuXHRcdFx0Y29uc3QgbGlua0NvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG5cdFx0XHRuZXcgU2V0dGluZyhsaW5rQ29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiTGluayBiYXNlIHBhdGhcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIkJhc2UgcGF0aCBmb3IgY29udmVydGVkIGxpbmtzIChlLmcuLCAnL3Byb2plY3RzLycsICcvbm90ZXMvdHV0b3JpYWxzLycsIGxlYXZlIGJsYW5rIGZvciByb290IC8pLlwiKVxyXG5cdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PiB7XHJcblx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIkVudGVyIGxpbmsgYmFzZSBwYXRoXCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShjdXN0b21UeXBlLmxpbmtCYXNlUGF0aCB8fCBcIlwiKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLmxpbmtCYXNlUGF0aCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIENyZWF0aW9uIG1vZGVcclxuXHRcdFx0Y29uc3QgY3JlYXRpb25Nb2RlQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRcdG5ldyBTZXR0aW5nKGNyZWF0aW9uTW9kZUNvbnRhaW5lcilcclxuXHRcdFx0XHQuc2V0TmFtZShcIkNyZWF0aW9uIG1vZGVcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIkhvdyB0byBjcmVhdGUgbmV3IGVudHJpZXM6IGZpbGUtYmFzZWQgb3IgZm9sZGVyLWJhc2VkIHdpdGggYW4gaW5kZXggZmlsZS5cIilcclxuXHRcdFx0XHQuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PlxyXG5cdFx0XHRcdFx0ZHJvcGRvd25cclxuXHRcdFx0XHRcdFx0LmFkZE9wdGlvbihcImZpbGVcIiwgXCJGaWxlLWJhc2VkIChjb250ZW50LXRpdGxlLm1kKVwiKVxyXG5cdFx0XHRcdFx0XHQuYWRkT3B0aW9uKFwiZm9sZGVyXCIsIFwiRm9sZGVyLWJhc2VkIChjb250ZW50LXRpdGxlL2luZGV4Lm1kKVwiKVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUuY3JlYXRpb25Nb2RlID0gdmFsdWUgYXMgXCJmaWxlXCIgfCBcImZvbGRlclwiO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMudXBkYXRlQ3VzdG9tQ29udGVudFR5cGVJbmRleEZpbGVGaWVsZChjdXN0b21UeXBlLmlkKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cclxuXHRcdFx0Ly8gSW5kZXggZmlsZSBuYW1lIChvbmx5IHNob3cgZm9yIGZvbGRlci1iYXNlZClcclxuXHRcdFx0Y29uc3QgaW5kZXhGaWxlQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImN1c3RvbS1pbmRleC1maWxlLWZpZWxkXCIgfSk7XHJcblx0XHRcdGluZGV4RmlsZUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIgPyBcImJsb2NrXCIgOiBcIm5vbmVcIjtcclxuXHRcdFx0bmV3IFNldHRpbmcoaW5kZXhGaWxlQ29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiSW5kZXggZmlsZSBuYW1lXCIpXHJcblx0XHRcdFx0LnNldERlc2MoXCJOYW1lIGZvciBpbmRleCBmaWxlcyBpbiBmb2xkZXItYmFzZWQgY29udGVudCAod2l0aG91dCAubWQgZXh0ZW5zaW9uKS4gRGVmYXVsdHMgdG8gJ2luZGV4JyBpZiBsZWZ0IGJsYW5rLlwiKVxyXG5cdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJpbmRleFwiKVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY3VzdG9tVHlwZS5pbmRleEZpbGVOYW1lKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLmluZGV4RmlsZU5hbWUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cclxuXHRcdFx0Ly8gVGVtcGxhdGVcclxuXHRcdFx0Y29uc3QgdGVtcGxhdGVDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcclxuXHRcdFx0bmV3IFNldHRpbmcodGVtcGxhdGVDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJQcm9wZXJ0aWVzIHRlbXBsYXRlXCIpXHJcblx0XHRcdFx0LmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB7XHJcblx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcignLS0tXFxudGl0bGU6IFwie3t0aXRsZX19XCJcXG5kYXRlOiB7e2RhdGV9fVxcbi0tLVxcbicpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShjdXN0b21UeXBlLnRlbXBsYXRlKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLnRlbXBsYXRlID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0dGV4dC5pbnB1dEVsLmNsYXNzTGlzdC5hZGQoXCJhc3Ryby1jb21wb3Nlci10ZW1wbGF0ZS10ZXh0YXJlYVwiKTtcclxuXHRcdFx0XHRcdHJldHVybiB0ZXh0O1xyXG5cdFx0XHRcdH0pXHJcblx0XHRcdFx0LnRoZW4oKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRcdHNldHRpbmcuZGVzY0VsLmVtcHR5KCk7XHJcblx0XHRcdFx0XHRjb25zdCBkZXNjRGl2ID0gc2V0dGluZy5kZXNjRWwuY3JlYXRlRWwoXCJkaXZcIik7XHJcblx0XHRcdFx0XHRkZXNjRGl2LmlubmVySFRNTCA9IFxyXG5cdFx0XHRcdFx0XHRcIlRlbXBsYXRlIGZvciBuZXcgZmlsZXMgb2YgdGhpcyBjb250ZW50IHR5cGUuPGJyIC8+XCIgK1xyXG5cdFx0XHRcdFx0XHRcIlZhcmlhYmxlcyBpbmNsdWRlIHt7dGl0bGV9fSBhbmQge3tkYXRlfX0uPGJyIC8+XCIgK1xyXG5cdFx0XHRcdFx0XHRcIkRvIG5vdCB3cmFwIHt7ZGF0ZX19IGluIHF1b3RlcyBhcyBpdCByZXByZXNlbnRzIGEgZGF0ZXRpbWUgdmFsdWUsIG5vdCBhIHN0cmluZy5cIjtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIFJlbW92ZSBidXR0b24gYXQgdGhlIGJvdHRvbSAobm8gZGl2aWRlcilcclxuXHRcdFx0Y29uc3QgcmVtb3ZlQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRcdGNvbnN0IHJlbW92ZVNldHRpbmcgPSBuZXcgU2V0dGluZyhyZW1vdmVDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJcIilcclxuXHRcdFx0XHQuYWRkQnV0dG9uKChidXR0b24pID0+IHtcclxuXHRcdFx0XHRcdGJ1dHRvblxyXG5cdFx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dChcIlJlbW92ZVwiKVxyXG5cdFx0XHRcdFx0XHQuc2V0V2FybmluZygpXHJcblx0XHRcdFx0XHRcdC5vbkNsaWNrKCgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnJlbW92ZUN1c3RvbUNvbnRlbnRUeXBlKGN1c3RvbVR5cGUuaWQpO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHJcblx0XHRcdC8vIEhpZGUgdGhlIGRpdmlkZXIgbGluZSBmb3IgdGhlIHJlbW92ZSBidXR0b25cclxuXHRcdFx0cmVtb3ZlU2V0dGluZy5zZXR0aW5nRWwuc3R5bGUuYm9yZGVyVG9wID0gXCJub25lXCI7XHJcblxyXG5cdFx0XHQvLyBTZXQgaW5pdGlhbCB2aXNpYmlsaXR5XHJcblx0XHRcdHRoaXMudXBkYXRlQ3VzdG9tQ29udGVudFR5cGVWaXNpYmlsaXR5KGN1c3RvbVR5cGUuaWQsIGN1c3RvbVR5cGUuZW5hYmxlZCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBBZGQgYnV0dG9uIGZvciBjcmVhdGluZyBuZXcgY3VzdG9tIGNvbnRlbnQgdHlwZXNcclxuXHRcdGNvbnN0IGFkZEJ1dHRvbkNvbnRhaW5lciA9IHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG5cdFx0Y29uc3QgYWRkQnV0dG9uU2V0dGluZyA9IG5ldyBTZXR0aW5nKGFkZEJ1dHRvbkNvbnRhaW5lcilcclxuXHRcdFx0LnNldE5hbWUoXCJcIilcclxuXHRcdFx0LmFkZEJ1dHRvbigoYnV0dG9uKSA9PiB7XHJcblx0XHRcdFx0YnV0dG9uXHJcblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dChcIkFkZCBjdXN0b20gY29udGVudCB0eXBlXCIpXHJcblx0XHRcdFx0XHQuc2V0Q3RhKClcclxuXHRcdFx0XHRcdC5vbkNsaWNrKCgpID0+IHtcclxuXHRcdFx0XHRcdFx0dGhpcy5hZGRDdXN0b21Db250ZW50VHlwZSgpO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHJcblx0XHQvLyBIaWRlIHRoZSBkaXZpZGVyIGxpbmUgZm9yIHRoZSBhZGQgYnV0dG9uXHJcblx0XHRhZGRCdXR0b25TZXR0aW5nLnNldHRpbmdFbC5zdHlsZS5ib3JkZXJUb3AgPSBcIm5vbmVcIjtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgdXBkYXRlQ3VzdG9tQ29udGVudFR5cGVWaXNpYmlsaXR5KHR5cGVJZDogc3RyaW5nLCBlbmFibGVkOiBib29sZWFuKSB7XHJcblx0XHRjb25zdCBzZXR0aW5nc0NvbnRhaW5lciA9IHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyPy5xdWVyeVNlbGVjdG9yKGBbZGF0YS10eXBlLWlkPVwiJHt0eXBlSWR9XCJdLmN1c3RvbS1jb250ZW50LXR5cGUtc2V0dGluZ3NgKSBhcyBIVE1MRWxlbWVudDtcclxuXHRcdGlmIChzZXR0aW5nc0NvbnRhaW5lcikge1xyXG5cdFx0XHRzZXR0aW5nc0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gZW5hYmxlZCA/IFwiYmxvY2tcIiA6IFwibm9uZVwiO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSB1cGRhdGVDdXN0b21Db250ZW50VHlwZUluZGV4RmlsZUZpZWxkKHR5cGVJZDogc3RyaW5nKSB7XHJcblx0XHRjb25zdCBjdXN0b21UeXBlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzLmZpbmQodHlwZSA9PiB0eXBlLmlkID09PSB0eXBlSWQpO1xyXG5cdFx0aWYgKCFjdXN0b21UeXBlKSByZXR1cm47XHJcblxyXG5cdFx0Y29uc3QgaW5kZXhGaWxlQ29udGFpbmVyID0gdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXI/LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXR5cGUtaWQ9XCIke3R5cGVJZH1cIl0gLmN1c3RvbS1pbmRleC1maWxlLWZpZWxkYCkgYXMgSFRNTEVsZW1lbnQ7XHJcblx0XHRpZiAoaW5kZXhGaWxlQ29udGFpbmVyKSB7XHJcblx0XHRcdGluZGV4RmlsZUNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIgPyBcImJsb2NrXCIgOiBcIm5vbmVcIjtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHByaXZhdGUgdXBkYXRlUGFnZXNJbmRleEZpbGVGaWVsZCgpIHtcclxuXHRcdGlmICh0aGlzLnBhZ2VzSW5kZXhGaWxlQ29udGFpbmVyKSB7XHJcblx0XHRcdHRoaXMucGFnZXNJbmRleEZpbGVDb250YWluZXIuc3R5bGUuZGlzcGxheSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnBhZ2VzQ3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiID8gXCJibG9ja1wiIDogXCJub25lXCI7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHJlbW92ZUN1c3RvbUNvbnRlbnRUeXBlKHR5cGVJZDogc3RyaW5nKSB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0c2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzID0gc2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzLmZpbHRlcigoY3Q6IEN1c3RvbUNvbnRlbnRUeXBlKSA9PiBjdC5pZCAhPT0gdHlwZUlkKTtcclxuXHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0dGhpcy5yZW5kZXJDdXN0b21Db250ZW50VHlwZXMoKTtcclxuXHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyQ3JlYXRlRXZlbnQoKTtcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7IFRGaWxlLCBIZWFkaW5nQ2FjaGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgSGVhZGluZ0xpbmtHZW5lcmF0b3Ige1xyXG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncykge31cclxuXHJcblx0LyoqXHJcblx0ICogQ29udmVydHMgdGV4dCB0byBrZWJhYi1jYXNlIHNsdWcgZm9yIFVSTHNcclxuXHQgKi9cclxuXHRwcml2YXRlIHRvS2ViYWJDYXNlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRcdHJldHVybiBzdHJcclxuXHRcdFx0LnRvTG93ZXJDYXNlKClcclxuXHRcdFx0LnJlcGxhY2UoL1teYS16MC05XFxzLV0vZywgXCJcIilcclxuXHRcdFx0LnRyaW0oKVxyXG5cdFx0XHQucmVwbGFjZSgvXFxzKy9nLCBcIi1cIilcclxuXHRcdFx0LnJlcGxhY2UoLy0rL2csIFwiLVwiKVxyXG5cdFx0XHQucmVwbGFjZSgvXi18LSQvZywgXCJcIik7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBHZXRzIHRoZSBBc3Ryby1jb21wYXRpYmxlIFVSTCBmcm9tIGFuIGludGVybmFsIGxpbmsgKGNvcGllZCBmcm9tIExpbmtDb252ZXJ0ZXIpXHJcblx0ICovXHJcblx0cHJpdmF0ZSBnZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmsobGluazogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRcdGNvbnN0IGhhc2hJbmRleCA9IGxpbmsuaW5kZXhPZignIycpO1xyXG5cdFx0bGV0IHBhdGggPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoMCwgaGFzaEluZGV4KSA6IGxpbms7XHJcblx0XHRjb25zdCBhbmNob3IgPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoaGFzaEluZGV4KSA6ICcnO1xyXG5cclxuXHRcdHBhdGggPSBwYXRoLnJlcGxhY2UoL1xcLm1kJC8sIFwiXCIpO1xyXG5cclxuXHRcdC8vIERldGVybWluZSBjb250ZW50IHR5cGUgYW5kIGFwcHJvcHJpYXRlIGJhc2UgcGF0aFxyXG5cdFx0bGV0IGJhc2VQYXRoID0gXCJcIjtcclxuXHRcdGxldCBjb250ZW50Rm9sZGVyID0gXCJcIjtcclxuXHRcdGxldCBjcmVhdGlvbk1vZGU6IFwiZmlsZVwiIHwgXCJmb2xkZXJcIiA9IFwiZmlsZVwiO1xyXG5cdFx0bGV0IGluZGV4RmlsZU5hbWUgPSBcIlwiO1xyXG5cclxuXHRcdC8vIENoZWNrIGN1c3RvbSBjb250ZW50IHR5cGVzIGZpcnN0IChoaWdoZXN0IHByaW9yaXR5KVxyXG5cdFx0bGV0IGZvdW5kQ3VzdG9tVHlwZSA9IGZhbHNlO1xyXG5cdFx0Zm9yIChjb25zdCBjdXN0b21UeXBlIG9mIHRoaXMuc2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzKSB7XHJcblx0XHRcdGlmIChjdXN0b21UeXBlLmVuYWJsZWQgJiYgY3VzdG9tVHlwZS5mb2xkZXIgJiYgcGF0aC5zdGFydHNXaXRoKGN1c3RvbVR5cGUuZm9sZGVyICsgJy8nKSkge1xyXG5cdFx0XHRcdGNvbnRlbnRGb2xkZXIgPSBjdXN0b21UeXBlLmZvbGRlcjtcclxuXHRcdFx0XHRiYXNlUGF0aCA9IGN1c3RvbVR5cGUubGlua0Jhc2VQYXRoIHx8IFwiXCI7XHJcblx0XHRcdFx0Y3JlYXRpb25Nb2RlID0gY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGU7XHJcblx0XHRcdFx0aW5kZXhGaWxlTmFtZSA9IGN1c3RvbVR5cGUuaW5kZXhGaWxlTmFtZTtcclxuXHRcdFx0XHRmb3VuZEN1c3RvbVR5cGUgPSB0cnVlO1xyXG5cdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdC8vIENoZWNrIHBhZ2VzIGZvbGRlciAoc2Vjb25kIHByaW9yaXR5KVxyXG5cdFx0aWYgKCFmb3VuZEN1c3RvbVR5cGUgJiYgdGhpcy5zZXR0aW5ncy5lbmFibGVQYWdlcyAmJiB0aGlzLnNldHRpbmdzLnBhZ2VzRm9sZGVyICYmIHBhdGguc3RhcnRzV2l0aCh0aGlzLnNldHRpbmdzLnBhZ2VzRm9sZGVyICsgJy8nKSkge1xyXG5cdFx0XHRjb250ZW50Rm9sZGVyID0gdGhpcy5zZXR0aW5ncy5wYWdlc0ZvbGRlcjtcclxuXHRcdFx0YmFzZVBhdGggPSB0aGlzLnNldHRpbmdzLnBhZ2VzTGlua0Jhc2VQYXRoO1xyXG5cdFx0XHRjcmVhdGlvbk1vZGUgPSB0aGlzLnNldHRpbmdzLnBhZ2VzQ3JlYXRpb25Nb2RlIHx8IFwiZmlsZVwiO1xyXG5cdFx0XHRpbmRleEZpbGVOYW1lID0gdGhpcy5zZXR0aW5ncy5wYWdlc0luZGV4RmlsZU5hbWUgfHwgXCJcIjtcclxuXHRcdH1cclxuXHRcdC8vIENoZWNrIHBvc3RzIGZvbGRlciAodGhpcmQgcHJpb3JpdHkpXHJcblx0XHRlbHNlIGlmICghZm91bmRDdXN0b21UeXBlICYmIHRoaXMuc2V0dGluZ3MucG9zdHNGb2xkZXIgJiYgcGF0aC5zdGFydHNXaXRoKHRoaXMuc2V0dGluZ3MucG9zdHNGb2xkZXIgKyAnLycpKSB7XHJcblx0XHRcdGNvbnRlbnRGb2xkZXIgPSB0aGlzLnNldHRpbmdzLnBvc3RzRm9sZGVyO1xyXG5cdFx0XHRiYXNlUGF0aCA9IHRoaXMuc2V0dGluZ3MucG9zdHNMaW5rQmFzZVBhdGg7XHJcblx0XHRcdGNyZWF0aW9uTW9kZSA9IHRoaXMuc2V0dGluZ3MuY3JlYXRpb25Nb2RlO1xyXG5cdFx0XHRpbmRleEZpbGVOYW1lID0gdGhpcy5zZXR0aW5ncy5pbmRleEZpbGVOYW1lIHx8IFwiaW5kZXhcIjtcclxuXHRcdH1cclxuXHRcdC8vIENoZWNrIGlmIHBvc3RzIGZvbGRlciBpcyBibGFuayAtIHRyZWF0IEFMTCBmaWxlcyBhcyBwb3N0c1xyXG5cdFx0ZWxzZSBpZiAoIWZvdW5kQ3VzdG9tVHlwZSAmJiAhdGhpcy5zZXR0aW5ncy5wb3N0c0ZvbGRlciAmJiB0aGlzLnNldHRpbmdzLmF1dG9tYXRlUG9zdENyZWF0aW9uICYmICF0aGlzLnNldHRpbmdzLm9ubHlBdXRvbWF0ZUluUG9zdHNGb2xkZXIpIHtcclxuXHRcdFx0Ly8gV2hlbiBwb3N0cyBmb2xkZXIgaXMgYmxhbmssIHRyZWF0IEFMTCBmaWxlcyBhcyBwb3N0c1xyXG5cdFx0XHRiYXNlUGF0aCA9IHRoaXMuc2V0dGluZ3MucG9zdHNMaW5rQmFzZVBhdGg7XHJcblx0XHRcdGNyZWF0aW9uTW9kZSA9IHRoaXMuc2V0dGluZ3MuY3JlYXRpb25Nb2RlO1xyXG5cdFx0XHRpbmRleEZpbGVOYW1lID0gdGhpcy5zZXR0aW5ncy5pbmRleEZpbGVOYW1lIHx8IFwiaW5kZXhcIjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBTdHJpcCBjb250ZW50IGZvbGRlciBpZiBwcmVzZW50XHJcblx0XHRpZiAoY29udGVudEZvbGRlcikge1xyXG5cdFx0XHRwYXRoID0gcGF0aC5zbGljZShjb250ZW50Rm9sZGVyLmxlbmd0aCArIDEpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGxldCBhZGRUcmFpbGluZ1NsYXNoID0gZmFsc2U7XHJcblx0XHRcclxuXHRcdC8vIFNtYXJ0IGRldGVjdGlvbjogaWYgdGhlIGZpbGVuYW1lIG1hdGNoZXMgdGhlIGluZGV4IGZpbGUgbmFtZSAocmVnYXJkbGVzcyBvZiBjcmVhdGlvbiBtb2RlKSxcclxuXHRcdC8vIHRyZWF0IGl0IGFzIGZvbGRlci1iYXNlZCBsb2dpY1xyXG5cdFx0aWYgKGluZGV4RmlsZU5hbWUgJiYgaW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIpIHtcclxuXHRcdFx0Y29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XHJcblx0XHRcdGlmIChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSA9PT0gaW5kZXhGaWxlTmFtZSkge1xyXG5cdFx0XHRcdHBhcnRzLnBvcCgpO1xyXG5cdFx0XHRcdHBhdGggPSBwYXJ0cy5qb2luKCcvJyk7XHJcblx0XHRcdFx0YWRkVHJhaWxpbmdTbGFzaCA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdH0gZWxzZSBpZiAoY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XHJcblx0XHRcdC8vIEZhbGxiYWNrIHRvIG9yaWdpbmFsIGxvZ2ljIGlmIG5vIGluZGV4IGZpbGUgbmFtZSBpcyBzcGVjaWZpZWRcclxuXHRcdFx0Ly8gRGVmYXVsdCB0byBcImluZGV4XCIgd2hlbiBpbmRleEZpbGVOYW1lIGlzIGJsYW5rXHJcblx0XHRcdGNvbnN0IGRlZmF1bHRJbmRleE5hbWUgPSBcImluZGV4XCI7XHJcblx0XHRcdGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xyXG5cdFx0XHRpZiAocGFydHNbcGFydHMubGVuZ3RoIC0gMV0gPT09IGRlZmF1bHRJbmRleE5hbWUpIHtcclxuXHRcdFx0XHRwYXJ0cy5wb3AoKTtcclxuXHRcdFx0XHRwYXRoID0gcGFydHMuam9pbignLycpO1xyXG5cdFx0XHRcdGFkZFRyYWlsaW5nU2xhc2ggPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3Qgc2x1Z1BhcnRzID0gcGF0aC5zcGxpdCgnLycpLm1hcChwYXJ0ID0+IHRoaXMudG9LZWJhYkNhc2UocGFydCkpO1xyXG5cdFx0Y29uc3Qgc2x1ZyA9IHNsdWdQYXJ0cy5qb2luKCcvJyk7XHJcblxyXG5cdFx0Ly8gRm9ybWF0IGJhc2UgcGF0aFxyXG5cdFx0aWYgKGJhc2VQYXRoKSB7XHJcblx0XHRcdGlmICghYmFzZVBhdGguc3RhcnRzV2l0aChcIi9cIikpIGJhc2VQYXRoID0gXCIvXCIgKyBiYXNlUGF0aDtcclxuXHRcdFx0aWYgKCFiYXNlUGF0aC5lbmRzV2l0aChcIi9cIikpIGJhc2VQYXRoICs9IFwiL1wiO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIERldGVybWluZSBpZiB3ZSBzaG91bGQgYWRkIHRyYWlsaW5nIHNsYXNoXHJcblx0XHRjb25zdCBzaG91bGRBZGRUcmFpbGluZ1NsYXNoID0gdGhpcy5zZXR0aW5ncy5hZGRUcmFpbGluZ1NsYXNoVG9MaW5rcyB8fCBhZGRUcmFpbGluZ1NsYXNoO1xyXG5cclxuXHRcdHJldHVybiBgJHtiYXNlUGF0aH0ke3NsdWd9JHtzaG91bGRBZGRUcmFpbGluZ1NsYXNoID8gJy8nIDogJyd9JHthbmNob3J9YDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEdlbmVyYXRlcyBhIHN0YW5kYXJkIE9ic2lkaWFuIGxpbmsgdG8gYSBoZWFkaW5nLCByZXNwZWN0aW5nIHVzZXIncyBsaW5rIGZvcm1hdCBwcmVmZXJlbmNlXHJcblx0ICovXHJcblx0Z2VuZXJhdGVPYnNpZGlhbkxpbmsoYXBwOiBhbnksIGZpbGU6IFRGaWxlLCBoZWFkaW5nOiBIZWFkaW5nQ2FjaGUpOiBzdHJpbmcge1xyXG5cdFx0Y29uc3QgaGVhZGluZ1RleHQgPSBoZWFkaW5nLmhlYWRpbmc7XHJcblx0XHRcclxuXHRcdC8vIENoZWNrIGlmIHVzZXIgcHJlZmVycyB3aWtpbGlua3MgYnkgdGVzdGluZyBPYnNpZGlhbidzIGRlZmF1bHQgYmVoYXZpb3JcclxuXHRcdGNvbnN0IHRlc3RMaW5rID0gYXBwLmZpbGVNYW5hZ2VyLmdlbmVyYXRlTWFya2Rvd25MaW5rKGZpbGUsICcnLCAnJyk7XHJcblx0XHRpZiAodGVzdExpbmsuc3RhcnRzV2l0aCgnW1snKSkge1xyXG5cdFx0XHQvLyBVc2VyIHByZWZlcnMgd2lraWxpbmtzXHJcblx0XHRcdGNvbnN0IGZpbGVQYXRoID0gZmlsZS5wYXRoLnJlcGxhY2UoL1xcLm1kJC8sIFwiXCIpO1xyXG5cdFx0XHRyZXR1cm4gYFtbJHtmaWxlUGF0aH0jJHtoZWFkaW5nVGV4dH18JHtoZWFkaW5nVGV4dH1dXWA7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBVc2VyIHByZWZlcnMgbWFya2Rvd24gbGlua3MgLSB1c2UgT2JzaWRpYW4ncyBtZXRob2QgYnV0IGZpeCB0aGUgZGlzcGxheSB0ZXh0XHJcblx0XHRcdGNvbnN0IGFuY2hvciA9IHRoaXMudG9LZWJhYkNhc2UoaGVhZGluZ1RleHQpO1xyXG5cdFx0XHQvLyBHZXQgdGhlIGJhc2UgbGluayBmcm9tIE9ic2lkaWFuIChyZXNwZWN0cyB1c2VyJ3MgcGF0aCBzZXR0aW5ncylcclxuXHRcdFx0Y29uc3QgYmFzZUxpbmsgPSBhcHAuZmlsZU1hbmFnZXIuZ2VuZXJhdGVNYXJrZG93bkxpbmsoZmlsZSwgJycsICcnKTtcclxuXHRcdFx0Ly8gRXh0cmFjdCB0aGUgcGF0aCBwYXJ0IGFuZCBhZGQgb3VyIGFuY2hvciB3aXRoIHByb3BlciBkaXNwbGF5IHRleHRcclxuXHRcdFx0aWYgKGJhc2VMaW5rLnN0YXJ0c1dpdGgoJ1tbJykpIHtcclxuXHRcdFx0XHQvLyBUaGlzIHNob3VsZG4ndCBoYXBwZW4gc2luY2Ugd2UncmUgaW4gdGhlIG1hcmtkb3duIGJyYW5jaCwgYnV0IGp1c3QgaW4gY2FzZVxyXG5cdFx0XHRcdGNvbnN0IGZpbGVQYXRoID0gZmlsZS5wYXRoLnJlcGxhY2UoL1xcLm1kJC8sIFwiXCIpO1xyXG5cdFx0XHRcdHJldHVybiBgW1ske2ZpbGVQYXRofSMke2hlYWRpbmdUZXh0fXwke2hlYWRpbmdUZXh0fV1dYDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBFeHRyYWN0IHRoZSBwYXRoIGZyb20gdGhlIGdlbmVyYXRlZCBsaW5rIGFuZCByZWNvbnN0cnVjdCB3aXRoIHByb3BlciBkaXNwbGF5IHRleHRcclxuXHRcdFx0XHRjb25zdCBtYXRjaCA9IGJhc2VMaW5rLm1hdGNoKC9cXFsoW15cXF1dKylcXF1cXCgoW14pXSspXFwpLyk7XHJcblx0XHRcdFx0aWYgKG1hdGNoKSB7XHJcblx0XHRcdFx0XHRjb25zdCBbLCAsIHBhdGhdID0gbWF0Y2g7XHJcblx0XHRcdFx0XHRyZXR1cm4gYFske2hlYWRpbmdUZXh0fV0oJHtwYXRofSMke2VuY29kZVVSSUNvbXBvbmVudChhbmNob3IpfSlgO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQvLyBGYWxsYmFjayB0byBtYW51YWwgY29uc3RydWN0aW9uXHJcblx0XHRcdFx0XHRjb25zdCBlbmNvZGVkRmlsZW5hbWUgPSBlbmNvZGVVUklDb21wb25lbnQoZmlsZS5uYW1lKTtcclxuXHRcdFx0XHRcdHJldHVybiBgWyR7aGVhZGluZ1RleHR9XSgke2VuY29kZWRGaWxlbmFtZX0jJHtlbmNvZGVVUklDb21wb25lbnQoYW5jaG9yKX0pYDtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEdlbmVyYXRlcyBhIHN0YW5kYXJkIE9ic2lkaWFuIHdpa2lsaW5rIHRvIGEgaGVhZGluZ1xyXG5cdCAqL1xyXG5cdGdlbmVyYXRlT2JzaWRpYW5XaWtpbGluayhmaWxlOiBURmlsZSwgaGVhZGluZzogSGVhZGluZ0NhY2hlKTogc3RyaW5nIHtcclxuXHRcdGNvbnN0IGhlYWRpbmdUZXh0ID0gaGVhZGluZy5oZWFkaW5nO1xyXG5cdFx0Y29uc3QgZmlsZVBhdGggPSBmaWxlLnBhdGgucmVwbGFjZSgvXFwubWQkLywgXCJcIik7XHJcblx0XHRyZXR1cm4gYFtbJHtmaWxlUGF0aH0jJHtoZWFkaW5nVGV4dH18JHtoZWFkaW5nVGV4dH1dXWA7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBHZW5lcmF0ZXMgYW4gQXN0cm8tY29tcGF0aWJsZSBtYXJrZG93biBsaW5rIHRvIGEgaGVhZGluZ1xyXG5cdCAqL1xyXG5cdGdlbmVyYXRlQXN0cm9MaW5rKGZpbGU6IFRGaWxlLCBoZWFkaW5nOiBIZWFkaW5nQ2FjaGUpOiBzdHJpbmcge1xyXG5cdFx0Y29uc3QgaGVhZGluZ1RleHQgPSBoZWFkaW5nLmhlYWRpbmc7XHJcblx0XHRjb25zdCBhbmNob3IgPSB0aGlzLnRvS2ViYWJDYXNlKGhlYWRpbmdUZXh0KTtcclxuXHRcdC8vIFVzZSB0aGUgc2FtZSBsb2dpYyBhcyB0aGUgZXhpc3RpbmcgbGluayBjb252ZXJ0ZXJcclxuXHRcdGNvbnN0IGludGVybmFsTGluayA9IGAke2ZpbGUucGF0aH0jJHthbmNob3J9YDtcclxuXHRcdGNvbnN0IGFzdHJvVXJsID0gdGhpcy5nZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmsoaW50ZXJuYWxMaW5rKTtcclxuXHRcdHJldHVybiBgWyR7aGVhZGluZ1RleHR9XSgke2FzdHJvVXJsfSlgO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogR2VuZXJhdGVzIGFuIEFzdHJvLWNvbXBhdGlibGUgd2lraWxpbmsgdG8gYSBoZWFkaW5nXHJcblx0ICovXHJcblx0Z2VuZXJhdGVBc3Ryb1dpa2lsaW5rKGZpbGU6IFRGaWxlLCBoZWFkaW5nOiBIZWFkaW5nQ2FjaGUpOiBzdHJpbmcge1xyXG5cdFx0Y29uc3QgaGVhZGluZ1RleHQgPSBoZWFkaW5nLmhlYWRpbmc7XHJcblx0XHRjb25zdCBhbmNob3IgPSB0aGlzLnRvS2ViYWJDYXNlKGhlYWRpbmdUZXh0KTtcclxuXHRcdC8vIFVzZSB0aGUgc2FtZSBsb2dpYyBhcyB0aGUgZXhpc3RpbmcgbGluayBjb252ZXJ0ZXJcclxuXHRcdGNvbnN0IGludGVybmFsTGluayA9IGAke2ZpbGUucGF0aH0jJHthbmNob3J9YDtcclxuXHRcdGNvbnN0IGFzdHJvVXJsID0gdGhpcy5nZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmsoaW50ZXJuYWxMaW5rKTtcclxuXHRcdC8vIENyZWF0ZSBhIHdpa2lsaW5rIHdpdGggdGhlIEFzdHJvIFVSTCBhcyB0aGUgdGFyZ2V0XHJcblx0XHRyZXR1cm4gYFtbJHtoZWFkaW5nVGV4dH18JHthc3Ryb1VybH1dXWA7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBHZW5lcmF0ZXMgdGhlIGFwcHJvcHJpYXRlIGxpbmsgZm9ybWF0IGJhc2VkIG9uIHNldHRpbmdzXHJcblx0ICovXHJcblx0Z2VuZXJhdGVMaW5rKGFwcDogYW55LCBmaWxlOiBURmlsZSwgaGVhZGluZzogSGVhZGluZ0NhY2hlKTogc3RyaW5nIHtcclxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmNvcHlIZWFkaW5nTGlua0Zvcm1hdCA9PT0gXCJhc3Ryb1wiKSB7XHJcblx0XHRcdC8vIEFzdHJvIGZvcm1hdCBhbHdheXMgdXNlcyBtYXJrZG93biBsaW5rcyAod2lraWxpbmtzIHdpdGggQXN0cm8gVVJMcyBkb24ndCBtYWtlIHNlbnNlKVxyXG5cdFx0XHRyZXR1cm4gdGhpcy5nZW5lcmF0ZUFzdHJvTGluayhmaWxlLCBoZWFkaW5nKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIFVzZSBPYnNpZGlhbidzIGJ1aWx0LWluIG1ldGhvZCB3aGljaCByZXNwZWN0cyB1c2VyIHNldHRpbmdzXHJcblx0XHRcdHJldHVybiB0aGlzLmdlbmVyYXRlT2JzaWRpYW5MaW5rKGFwcCwgZmlsZSwgaGVhZGluZyk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBGaW5kcyB0aGUgaGVhZGluZyBhdCBhIHNwZWNpZmljIGxpbmUgaW4gYSBmaWxlXHJcblx0ICovXHJcblx0ZmluZEhlYWRpbmdBdExpbmUoYXBwOiBhbnksIGZpbGU6IFRGaWxlLCBsaW5lOiBudW1iZXIpOiBIZWFkaW5nQ2FjaGUgfCBudWxsIHtcclxuXHRcdGNvbnN0IGNhY2hlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG5cdFx0aWYgKCFjYWNoZSB8fCAhY2FjaGUuaGVhZGluZ3MpIHtcclxuXHRcdFx0cmV0dXJuIG51bGw7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gRmluZCB0aGUgaGVhZGluZyB0aGF0IGNvbnRhaW5zIHRoaXMgbGluZVxyXG5cdFx0Zm9yIChsZXQgaSA9IGNhY2hlLmhlYWRpbmdzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcblx0XHRcdGNvbnN0IGhlYWRpbmcgPSBjYWNoZS5oZWFkaW5nc1tpXTtcclxuXHRcdFx0aWYgKGhlYWRpbmcucG9zaXRpb24uc3RhcnQubGluZSA8PSBsaW5lKSB7XHJcblx0XHRcdFx0cmV0dXJuIGhlYWRpbmc7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gbnVsbDtcclxuXHR9XHJcbn1cclxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQUFBQSxtQkFJTzs7O0FDMERBLElBQU0sbUJBQW1CLENBQUMsUUFBUSxXQUFXLFlBQVk7QUFFekQsSUFBTSxZQUFZ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O0FBQzdCLFNBQUs7QUFBQSxNQUNKLEtBQUssSUFBSSxVQUFVLEdBQUcsZUFBZSxDQUFDLE1BQU0sUUFBUSxTQUFTO0FBRTVELFlBQUksQ0FBQyxLQUFLLFNBQVMsdUJBQXVCO0FBQ3pDO0FBQUEsUUFDRDtBQUVBLGNBQU0sU0FBUyxPQUFPLFVBQVU7QUFDaEMsY0FBTSxPQUFPLEtBQUs7QUFFbEIsWUFBSSxFQUFFLGdCQUFnQix5QkFBUTtBQUM3QjtBQUFBLFFBQ0Q7QUFHQSxjQUFNLFVBQVUsS0FBSyxxQkFBcUIsa0JBQWtCLEtBQUssS0FBSyxNQUFNLE9BQU8sSUFBSTtBQUV2RixZQUFJLFNBQVM7QUFFWixlQUFLLFFBQVEsQ0FBQyxTQUFTO0FBQ3RCLGlCQUNFLFNBQVMsbUJBQW1CLEVBQzVCLFFBQVEsUUFBUSxFQUNoQixRQUFRLFlBQVk7QUFDcEIsb0JBQU0sT0FBTyxLQUFLLHFCQUFxQixhQUFhLEtBQUssS0FBSyxNQUFNLE9BQU87QUFDM0Usb0JBQU0sVUFBVSxVQUFVLFVBQVUsSUFBSTtBQUN4QyxrQkFBSSx3QkFBTyxrQ0FBa0M7QUFBQSxZQUM5QyxDQUFDO0FBQUEsVUFDSCxDQUFDO0FBQUEsUUFDRjtBQUFBLE1BQ0QsQ0FBQztBQUFBLElBQ0Y7QUFBQSxFQUNEO0FBQ0Q7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAibmV3RmlsZSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJzZXR0aW5ncyIsICJpbXBvcnRfb2JzaWRpYW4iXQp9Cg==
